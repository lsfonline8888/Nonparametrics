<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 6 章 相关 | 非参数统计</title>
  <meta name="description" content="description" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="第 6 章 相关 | 非参数统计" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="description" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 6 章 相关 | 非参数统计" />
  
  <meta name="twitter:description" content="description" />
  

<meta name="author" content="Sifan Liu, TJUFE" />


<meta name="date" content="2022-08-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="尺度参数.html"/>
<link rel="next" href="分布检验.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Title</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="概述.html"><a href="概述.html"><i class="fa fa-check"></i><b>1</b> 概述</a>
<ul>
<li class="chapter" data-level="1.1" data-path="概述.html"><a href="概述.html#习题1-1.5-数据可视化查看对总体分布的假设是否合理"><i class="fa fa-check"></i><b>1.1</b> 习题1: (1.5 数据可视化，查看对总体分布的假设是否合理)</a></li>
<li class="chapter" data-level="1.2" data-path="概述.html"><a href="概述.html#数据变换box-cox变换"><i class="fa fa-check"></i><b>1.2</b> 数据变换（Box-Cox变换）</a></li>
<li class="chapter" data-level="1.3" data-path="概述.html"><a href="概述.html#section"><i class="fa fa-check"></i><b>1.3</b> 2.(1)</a></li>
<li class="chapter" data-level="1.4" data-path="概述.html"><a href="概述.html#section-1"><i class="fa fa-check"></i><b>1.4</b> 2.(2)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="单样本位置参数.html"><a href="单样本位置参数.html"><i class="fa fa-check"></i><b>2</b> 单样本位置参数</a>
<ul>
<li class="chapter" data-level="2.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#引入的例子楼盘均价"><i class="fa fa-check"></i><b>2.1</b> 引入的例子：楼盘均价</a></li>
<li class="chapter" data-level="2.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#符号检验-sign-test"><i class="fa fa-check"></i><b>2.2</b> 2.1 符号检验 Sign Test</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#广义符号检验"><i class="fa fa-check"></i><b>2.2.1</b> 2.1.1. 广义符号检验</a></li>
<li class="chapter" data-level="2.2.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#分位点的置信区间"><i class="fa fa-check"></i><b>2.2.2</b> 2.1.2 分位点的置信区间</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="单样本位置参数.html"><a href="单样本位置参数.html#wilcoxon符号秩检验wilcoxon-sign-rank"><i class="fa fa-check"></i><b>2.3</b> 2.2 Wilcoxon符号秩检验(Wilcoxon Sign Rank)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#检验"><i class="fa fa-check"></i><b>2.3.1</b> 2.2.1 检验</a></li>
<li class="chapter" data-level="2.3.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#置信区间"><i class="fa fa-check"></i><b>2.3.2</b> 2.2.2 置信区间</a></li>
<li class="chapter" data-level="2.3.3" data-path="单样本位置参数.html"><a href="单样本位置参数.html#simulation-study"><i class="fa fa-check"></i><b>2.3.3</b> simulation study</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="单样本位置参数.html"><a href="单样本位置参数.html#正态记分检验normal-score"><i class="fa fa-check"></i><b>2.4</b> 2.3 正态记分检验*(normal score)</a></li>
<li class="chapter" data-level="2.5" data-path="单样本位置参数.html"><a href="单样本位置参数.html#cox-stuart趋势检验"><i class="fa fa-check"></i><b>2.5</b> 2.4 Cox-Stuart趋势检验*</a></li>
<li class="chapter" data-level="2.6" data-path="单样本位置参数.html"><a href="单样本位置参数.html#随机性的游程检验"><i class="fa fa-check"></i><b>2.6</b> 2.5 随机性的游程检验*</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="双样本位置参数.html"><a href="双样本位置参数.html"><i class="fa fa-check"></i><b>3</b> 双样本位置参数</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子零件疲劳强度测试"><i class="fa fa-check"></i><b>3.0.1</b> 例子：零件疲劳强度测试</a></li>
<li class="chapter" data-level="3.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#brown-mood中位数检验"><i class="fa fa-check"></i><b>3.1</b> 3.1 Brown-Mood中位数检验</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#精确检验"><i class="fa fa-check"></i><b>3.1.1</b> 精确检验</a></li>
<li class="chapter" data-level="3.1.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#大样本近似"><i class="fa fa-check"></i><b>3.1.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#wilcoxon秩和检验"><i class="fa fa-check"></i><b>3.2</b> 3.2 Wilcoxon秩和检验</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例wilcoxon-test-for-stochastic-ordering-of-alternatives"><i class="fa fa-check"></i><b>3.2.1</b> *例：Wilcoxon Test for Stochastic Ordering of Alternatives</a></li>
<li class="chapter" data-level="3.2.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例-analyses-for-a-shift-in-location"><i class="fa fa-check"></i><b>3.2.2</b> *例： Analyses for a Shift in Location</a></li>
<li class="chapter" data-level="3.2.3" data-path="双样本位置参数.html"><a href="双样本位置参数.html#假设检验"><i class="fa fa-check"></i><b>3.2.3</b> 3.2.1 假设检验</a></li>
<li class="chapter" data-level="3.2.4" data-path="双样本位置参数.html"><a href="双样本位置参数.html#置信区间-1"><i class="fa fa-check"></i><b>3.2.4</b> 3.2.2 置信区间</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="双样本位置参数.html"><a href="双样本位置参数.html#正态记分normal-score检验"><i class="fa fa-check"></i><b>3.3</b> 3.3 正态记分（normal score）检验</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子salary"><i class="fa fa-check"></i><b>3.3.1</b> 例子：salary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="双样本位置参数.html"><a href="双样本位置参数.html#成对数据的检验"><i class="fa fa-check"></i><b>3.4</b> 3.4 成对数据的检验</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子实施管理前后"><i class="fa fa-check"></i><b>3.4.1</b> 例子：实施管理前后</a></li>
<li class="chapter" data-level="3.4.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子病人血压"><i class="fa fa-check"></i><b>3.4.2</b> 例子：病人血压</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="双样本位置参数.html"><a href="双样本位置参数.html#mcnemar检验"><i class="fa fa-check"></i><b>3.5</b> 3.5 McNemar检验</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#精确检验-1"><i class="fa fa-check"></i><b>3.5.1</b> 精确检验</a></li>
<li class="chapter" data-level="3.5.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#大样本近似-1"><i class="fa fa-check"></i><b>3.5.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="双样本位置参数.html"><a href="双样本位置参数.html#cohens-kappa系数"><i class="fa fa-check"></i><b>3.6</b> 3.6 Cohen’s Kappa系数</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="多样本位置参数.html"><a href="多样本位置参数.html"><i class="fa fa-check"></i><b>4</b> 多样本位置参数</a>
<ul>
<li class="chapter" data-level="4.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#kruskal-wallis秩和检验"><i class="fa fa-check"></i><b>4.1</b> 4.1 Kruskal-Wallis秩和检验</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#例训练方式"><i class="fa fa-check"></i><b>4.1.1</b> 例：训练方式</a></li>
<li class="chapter" data-level="4.1.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-2"><i class="fa fa-check"></i><b>4.1.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#正态记分检验"><i class="fa fa-check"></i><b>4.2</b> 4.2 正态记分检验</a></li>
<li class="chapter" data-level="4.3" data-path="多样本位置参数.html"><a href="多样本位置参数.html#jonckheere-terpstra检验"><i class="fa fa-check"></i><b>4.3</b> 4.3 Jonckheere-Terpstra检验</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-2"><i class="fa fa-check"></i><b>4.3.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.3.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-3"><i class="fa fa-check"></i><b>4.3.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="多样本位置参数.html"><a href="多样本位置参数.html#完全区组设计friedman秩和检验"><i class="fa fa-check"></i><b>4.4</b> 4.5 完全区组设计：Friedman秩和检验</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-3"><i class="fa fa-check"></i><b>4.4.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.4.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-4"><i class="fa fa-check"></i><b>4.4.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="多样本位置参数.html"><a href="多样本位置参数.html#kendall协同系数检验"><i class="fa fa-check"></i><b>4.5</b> 4.6 Kendall协同系数检验</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-5"><i class="fa fa-check"></i><b>4.5.1</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="多样本位置参数.html"><a href="多样本位置参数.html#cochran检验"><i class="fa fa-check"></i><b>4.6</b> 4.7 Cochran检验</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-4"><i class="fa fa-check"></i><b>4.6.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.6.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-6"><i class="fa fa-check"></i><b>4.6.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="多样本位置参数.html"><a href="多样本位置参数.html#page检验"><i class="fa fa-check"></i><b>4.7</b> 4.8 Page检验</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-5"><i class="fa fa-check"></i><b>4.7.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.7.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-7"><i class="fa fa-check"></i><b>4.7.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="多样本位置参数.html"><a href="多样本位置参数.html#durbin检验"><i class="fa fa-check"></i><b>4.8</b> 4.9 Durbin检验</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-6"><i class="fa fa-check"></i><b>4.8.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.8.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-8"><i class="fa fa-check"></i><b>4.8.2</b> 大样本近似</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="尺度参数.html"><a href="尺度参数.html"><i class="fa fa-check"></i><b>5</b> 尺度参数</a>
<ul>
<li class="chapter" data-level="5.1" data-path="尺度参数.html"><a href="尺度参数.html#两独立样本的siegel-tukey方差检验"><i class="fa fa-check"></i><b>5.1</b> 5.1 两独立样本的Siegel-Tukey方差检验</a></li>
<li class="chapter" data-level="5.2" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度参数的mood检验"><i class="fa fa-check"></i><b>5.2</b> 5.2 两样本尺度参数的Mood检验</a></li>
<li class="chapter" data-level="5.3" data-path="尺度参数.html"><a href="尺度参数.html#ansari-bradley检验"><i class="fa fa-check"></i><b>5.3</b> 5.3 Ansari-Bradley检验</a></li>
<li class="chapter" data-level="5.4" data-path="尺度参数.html"><a href="尺度参数.html#fligner-killeen检验"><i class="fa fa-check"></i><b>5.4</b> 5.4 Fligner-Killeen检验</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度的精确检验"><i class="fa fa-check"></i><b>5.4.1</b> 两样本尺度的精确检验</a></li>
<li class="chapter" data-level="5.4.2" data-path="尺度参数.html"><a href="尺度参数.html#多样本尺度的大样本近似"><i class="fa fa-check"></i><b>5.4.2</b> 多样本尺度的大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度的平方秩检验"><i class="fa fa-check"></i><b>5.5</b> 5.5 两样本尺度的平方秩检验</a></li>
<li class="chapter" data-level="5.6" data-path="尺度参数.html"><a href="尺度参数.html#多样本尺度的平方秩检验"><i class="fa fa-check"></i><b>5.6</b> 5.6 多样本尺度的平方秩检验</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="相关.html"><a href="相关.html"><i class="fa fa-check"></i><b>6</b> 相关</a>
<ul>
<li class="chapter" data-level="6.1" data-path="相关.html"><a href="相关.html#spearman秩相关检验"><i class="fa fa-check"></i><b>6.1</b> 6.1 Spearman秩相关检验</a></li>
<li class="chapter" data-level="6.2" data-path="相关.html"><a href="相关.html#kendall-tau-相关检验"><i class="fa fa-check"></i><b>6.2</b> 6.2 Kendall <span class="math inline">\(\tau\)</span> 相关检验</a></li>
<li class="chapter" data-level="6.3" data-path="相关.html"><a href="相关.html#goodman-kruskals-gamma-相关检验"><i class="fa fa-check"></i><b>6.3</b> 6.3 Goodman-Kruskal’s <span class="math inline">\(\gamma\)</span> 相关检验</a></li>
<li class="chapter" data-level="6.4" data-path="相关.html"><a href="相关.html#somersd-相关检验"><i class="fa fa-check"></i><b>6.4</b> 6.4 Somers’d 相关检验</a></li>
<li class="chapter" data-level="6.5" data-path="相关.html"><a href="相关.html#theil非参数回归"><i class="fa fa-check"></i><b>6.5</b> 6.5 Theil非参数回归</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="相关.html"><a href="相关.html#几种稳健回归"><i class="fa fa-check"></i><b>6.5.1</b> 几种稳健回归</a></li>
<li class="chapter" data-level="6.5.2" data-path="相关.html"><a href="相关.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.5.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="6.5.3" data-path="相关.html"><a href="相关.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.5.3</b> Multiple Linear Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="分布检验.html"><a href="分布检验.html"><i class="fa fa-check"></i><b>7</b> 分布检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="分布检验.html"><a href="分布检验.html#q-q图"><i class="fa fa-check"></i><b>7.1</b> Q-Q图</a></li>
<li class="chapter" data-level="7.2" data-path="分布检验.html"><a href="分布检验.html#kolmogorov-smirnov单样本检验"><i class="fa fa-check"></i><b>7.2</b> 7.1 Kolmogorov-Smirnov单样本检验</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="分布检验.html"><a href="分布检验.html#ks检验"><i class="fa fa-check"></i><b>7.2.1</b> KS检验</a></li>
<li class="chapter" data-level="7.2.2" data-path="分布检验.html"><a href="分布检验.html#正态性检验"><i class="fa fa-check"></i><b>7.2.2</b> 正态性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="分布检验.html"><a href="分布检验.html#kolmogorov-smirnov两样本分布检验"><i class="fa fa-check"></i><b>7.3</b> 7.2 Kolmogorov-Smirnov两样本分布检验</a></li>
<li class="chapter" data-level="7.4" data-path="分布检验.html"><a href="分布检验.html#pearson-chi2-拟合优度检验"><i class="fa fa-check"></i><b>7.4</b> 7.3 Pearson <span class="math inline">\(\chi^2\)</span> 拟合优度检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="分布检验.html"><a href="分布检验.html#goodness-of-fit-tests-for-a-single-discrete-random-variable"><i class="fa fa-check"></i><b>7.4.1</b> Goodness-of-Fit Tests for a Single Discrete Random Variable</a></li>
<li class="chapter" data-level="7.4.2" data-path="分布检验.html"><a href="分布检验.html#several-discrete-random-variables"><i class="fa fa-check"></i><b>7.4.2</b> Several Discrete Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="列联表.html"><a href="列联表.html"><i class="fa fa-check"></i><b>8</b> 列联表</a>
<ul>
<li class="chapter" data-level="8.1" data-path="列联表.html"><a href="列联表.html#二维列联表的齐性和独立性的chi2检验"><i class="fa fa-check"></i><b>8.1</b> 二维列联表的齐性和独立性的<span class="math inline">\(\chi^2\)</span>检验</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="列联表.html"><a href="列联表.html#齐性"><i class="fa fa-check"></i><b>8.1.1</b> 齐性</a></li>
<li class="chapter" data-level="8.1.2" data-path="列联表.html"><a href="列联表.html#独立性"><i class="fa fa-check"></i><b>8.1.2</b> 独立性</a></li>
<li class="chapter" data-level="8.1.3" data-path="列联表.html"><a href="列联表.html#independence-of-two-discrete-random-variables-例子吸烟与肺癌"><i class="fa fa-check"></i><b>8.1.3</b> Independence of Two Discrete Random Variables （例子：吸烟与肺癌）</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="列联表.html"><a href="列联表.html#低维列联表的fisher精确检验"><i class="fa fa-check"></i><b>8.2</b> 8.2 低维列联表的Fisher精确检验</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="列联表.html"><a href="列联表.html#数据为表格形式"><i class="fa fa-check"></i><b>8.2.1</b> 数据为表格形式</a></li>
<li class="chapter" data-level="8.2.2" data-path="列联表.html"><a href="列联表.html#数据为数据框格式"><i class="fa fa-check"></i><b>8.2.2</b> 数据为数据框格式</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="列联表.html"><a href="列联表.html#两个比例的比较"><i class="fa fa-check"></i><b>8.3</b> 8.3 两个比例的比较</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="列联表.html"><a href="列联表.html#例8.3-关于中风的研究"><i class="fa fa-check"></i><b>8.3.1</b> 例8.3 关于中风的研究</a></li>
<li class="chapter" data-level="8.3.2" data-path="列联表.html"><a href="列联表.html#one-sample-problems"><i class="fa fa-check"></i><b>8.3.2</b> One-Sample Problems*</a></li>
<li class="chapter" data-level="8.3.3" data-path="列联表.html"><a href="列联表.html#two-sample-problems"><i class="fa fa-check"></i><b>8.3.3</b> Two-Sample Problems*</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="列联表.html"><a href="列联表.html#cochran-mantel-haenszel估计"><i class="fa fa-check"></i><b>8.4</b> 8.4 Cochran-Mantel-Haenszel估计</a></li>
<li class="chapter" data-level="8.5" data-path="列联表.html"><a href="列联表.html#对数线性模型与高维列联表的独立性"><i class="fa fa-check"></i><b>8.5</b> 8.5 对数线性模型与高维列联表的独立性</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="密度估计和回归.html"><a href="密度估计和回归.html"><i class="fa fa-check"></i><b>9</b> 密度估计和回归</a>
<ul>
<li class="chapter" data-level="9.1" data-path="密度估计和回归.html"><a href="密度估计和回归.html#非参数密度估计"><i class="fa fa-check"></i><b>9.1</b> 非参数密度估计</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="密度估计和回归.html"><a href="密度估计和回归.html#一元密度估计"><i class="fa fa-check"></i><b>9.1.1</b> 一元密度估计</a></li>
<li class="chapter" data-level="9.1.2" data-path="密度估计和回归.html"><a href="密度估计和回归.html#多元密度估计"><i class="fa fa-check"></i><b>9.1.2</b> 多元密度估计</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="密度估计和回归.html"><a href="密度估计和回归.html#非参数回归"><i class="fa fa-check"></i><b>9.2</b> 非参数回归</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>10</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bootstrap.html"><a href="bootstrap.html#percentile-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>10.1</b> Percentile Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="10.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-tests-of-hypotheses"><i class="fa fa-check"></i><b>10.2</b> Bootstrap Tests of Hypotheses</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="bootstrap.html"><a href="bootstrap.html#nursery-school-intervention"><i class="fa fa-check"></i><b>10.2.1</b> Nursery School Intervention</a></li>
<li class="chapter" data-level="10.2.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-test-for-sample-mean"><i class="fa fa-check"></i><b>10.2.2</b> Bootstrap test for sample mean</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">非参数统计</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="相关" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">第 6 章</span> 相关<a href="相关.html#相关" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="spearman秩相关检验" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> 6.1 Spearman秩相关检验<a href="相关.html#spearman秩相关检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="相关.html#cb243-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/DM1.txt&quot;</span>);</span>
<span id="cb243-2"><a href="相关.html#cb243-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>d[,<span class="dv">2</span>];y<span class="ot">=</span>d[,<span class="dv">1</span>];</span>
<span id="cb243-3"><a href="相关.html#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb243-4"><a href="相关.html#cb243-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y)</span>
<span id="cb243-5"><a href="相关.html#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(x),<span class="fu">log</span>(y))</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="相关.html#cb244-1" aria-hidden="true" tabindex="-1"></a>rx<span class="ot">=</span><span class="fu">rank</span>(x);ry<span class="ot">=</span><span class="fu">rank</span>(y);</span>
<span id="cb244-2"><a href="相关.html#cb244-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">rsd=</span><span class="fu">rbind</span>(rx,ry,(rx<span class="sc">-</span>ry)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>##    [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]  [,9] [,10] [,11] [,12] [,13] [,14]
## rx    4    7   15    8   24   29   13  1.5 16.50     9 10.00 14.00 16.50    30
## ry    8    4   27   10   25   28    9  2.5 21.00    20  6.50 11.50 18.00    30
##      16    9  144    4    1    1   16  1.0 20.25   121 12.25  6.25  2.25     0
##    [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
## rx 20.50    23 11.00    26  1.50    27    18    25    22    19     6  5.00
## ry 17.00    24 11.50    26  5.00    23    13    22    15    14     1  6.50
##    12.25     1  0.25     0 12.25    16    25     9    49    25    25  2.25
##    [,27] [,28] [,29] [,30]
## rx    12 20.50    28  3.00
## ry    16 19.00    29  2.50
##       16  2.25     1  0.25</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="相关.html#cb246-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb246-2"><a href="相关.html#cb246-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">Rs=</span> <span class="dv">1-6</span><span class="sc">*</span><span class="fu">sum</span>((rx<span class="sc">-</span>ry)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(n<span class="sc">*</span>(n<span class="sc">^</span><span class="dv">2-1</span>)))</span></code></pre></div>
<pre><code>## [1] 0.8775306</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="相关.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y,<span class="at">meth=</span><span class="st">&quot;pearson&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  x and y
## t = 10.956, df = 28, p-value = 1.235e-11
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.7996123 0.9519271
## sample estimates:
##       cor 
## 0.9004762</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="相关.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y,<span class="at">meth=</span><span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in cor.test.default(x, y, meth = &quot;spearman&quot;): Cannot compute exact p-
## value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 550.87, p-value = 1.965e-10
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.8774488</code></pre>
<p><strong>没有打结而且样本量不太大时，精确检验</strong></p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="相关.html#cb253-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">c</span>(<span class="fl">4.2</span>,<span class="fl">4.3</span>,<span class="fl">4.4</span>,<span class="fl">4.5</span>,<span class="fl">4.7</span>,<span class="fl">4.6</span>,<span class="fl">5.3</span>);y<span class="ot">=</span><span class="fu">c</span>(<span class="fl">2.6</span>,<span class="fl">2.8</span>,<span class="fl">3.1</span>,<span class="fl">3.8</span>,<span class="fl">3.6</span>,<span class="fl">4.0</span>,<span class="fl">5.0</span>);</span>
<span id="cb253-2"><a href="相关.html#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y,<span class="at">exact=</span>T,<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  x and y
## S = 6, p-value = 0.0123
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##       rho 
## 0.8928571</code></pre>
</div>
<div id="kendall-tau-相关检验" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> 6.2 Kendall <span class="math inline">\(\tau\)</span> 相关检验<a href="相关.html#kendall-tau-相关检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="相关.html#cb255-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/CPIESI.txt&quot;</span>);</span>
<span id="cb255-2"><a href="相关.html#cb255-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(d);</span>
<span id="cb255-3"><a href="相关.html#cb255-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>d[,<span class="dv">2</span>];y<span class="ot">=</span>d[,<span class="dv">1</span>]</span>
<span id="cb255-4"><a href="相关.html#cb255-4" aria-hidden="true" tabindex="-1"></a>nc<span class="ot">=</span><span class="dv">0</span>;nd<span class="ot">=</span><span class="dv">0</span>;n0<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb255-5"><a href="相关.html#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb255-6"><a href="相关.html#cb255-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb255-7"><a href="相关.html#cb255-7" aria-hidden="true" tabindex="-1"></a>    nc<span class="ot">=</span>nc<span class="sc">+</span>((x[j]<span class="sc">-</span>x[i])<span class="sc">*</span>(y[j]<span class="sc">-</span>y[i])<span class="sc">&gt;</span><span class="dv">0</span>);</span>
<span id="cb255-8"><a href="相关.html#cb255-8" aria-hidden="true" tabindex="-1"></a>    nd<span class="ot">=</span>nd<span class="sc">+</span>((x[j]<span class="sc">-</span>x[i])<span class="sc">*</span>(y[j]<span class="sc">-</span>y[i])<span class="sc">&lt;</span><span class="dv">0</span>);</span>
<span id="cb255-9"><a href="相关.html#cb255-9" aria-hidden="true" tabindex="-1"></a>    n0<span class="ot">=</span>n0<span class="sc">+</span>((x[j]<span class="sc">-</span>x[i])<span class="sc">*</span>(y[j]<span class="sc">-</span>y[i])<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb255-10"><a href="相关.html#cb255-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb255-11"><a href="相关.html#cb255-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb255-12"><a href="相关.html#cb255-12" aria-hidden="true" tabindex="-1"></a>K<span class="ot">=</span>nc<span class="sc">-</span>nd;</span>
<span id="cb255-13"><a href="相关.html#cb255-13" aria-hidden="true" tabindex="-1"></a>(<span class="at">tau=</span>K<span class="sc">/</span><span class="fu">choose</span>(n,<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 0.4219269</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="相关.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(x,y,<span class="at">meth=</span><span class="st">&quot;kendall&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  x and y
## T = 642, p-value = 4.199e-05
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##       tau 
## 0.4219269</code></pre>
<ul>
<li>有打结情况，调整后统计量<span class="math inline">\(\tau_b\)</span></li>
<li>Kendall’s <span class="math inline">\(\tau_b\)</span>还经常用于列联表数据，度量两个有序变量的相关性</li>
<li>当列联表中行列数目差别较大时，使用Kendall’s <span class="math inline">\(\tau_c\)</span></li>
</ul>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="相关.html#cb259-1" aria-hidden="true" tabindex="-1"></a>xx<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/incsat.txt&quot;</span>);</span>
<span id="cb259-2"><a href="相关.html#cb259-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>xx[,<span class="dv">1</span>];</span>
<span id="cb259-3"><a href="相关.html#cb259-3" aria-hidden="true" tabindex="-1"></a>y<span class="ot">=</span>xx[,<span class="dv">2</span>];</span>
<span id="cb259-4"><a href="相关.html#cb259-4" aria-hidden="true" tabindex="-1"></a>w<span class="ot">=</span>xx[,<span class="dv">3</span>];</span>
<span id="cb259-5"><a href="相关.html#cb259-5" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="fu">max</span>(x);n2<span class="ot">=</span><span class="fu">max</span>(y);n<span class="ot">=</span><span class="fu">sum</span>(w);q<span class="ot">=</span><span class="fu">min</span>(n1,n2);</span>
<span id="cb259-6"><a href="相关.html#cb259-6" aria-hidden="true" tabindex="-1"></a>WW<span class="ot">=</span><span class="fu">matrix</span>(w,<span class="at">byrow=</span>T,<span class="at">nrow=</span>n1);</span>
<span id="cb259-7"><a href="相关.html#cb259-7" aria-hidden="true" tabindex="-1"></a>Dc<span class="ot">=</span>n<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span><span class="fu">sum</span>((<span class="fu">apply</span>(WW,<span class="dv">2</span>,sum))<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb259-8"><a href="相关.html#cb259-8" aria-hidden="true" tabindex="-1"></a>Dr<span class="ot">=</span>n<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span><span class="fu">sum</span>((<span class="fu">apply</span>(WW,<span class="dv">1</span>,sum))<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb259-9"><a href="相关.html#cb259-9" aria-hidden="true" tabindex="-1"></a>Vij<span class="ot">=</span>DD<span class="ot">=</span>CC<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>n1,<span class="at">ncol=</span>n2)</span>
<span id="cb259-10"><a href="相关.html#cb259-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb259-11"><a href="相关.html#cb259-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n2){</span>
<span id="cb259-12"><a href="相关.html#cb259-12" aria-hidden="true" tabindex="-1"></a>    CC[i,j]<span class="ot">=</span><span class="fu">sum</span>((x<span class="sc">&gt;</span>i)<span class="sc">*</span>(y<span class="sc">&gt;</span>j)<span class="sc">*</span>w)<span class="sc">+</span><span class="fu">sum</span>((x<span class="sc">&lt;</span>i)<span class="sc">*</span>(y<span class="sc">&lt;</span>j)<span class="sc">*</span>w)</span>
<span id="cb259-13"><a href="相关.html#cb259-13" aria-hidden="true" tabindex="-1"></a>    DD[i,j]<span class="ot">=</span><span class="fu">sum</span>((x<span class="sc">&gt;</span>i)<span class="sc">*</span>(y<span class="sc">&lt;</span>j)<span class="sc">*</span>w)<span class="sc">+</span><span class="fu">sum</span>((x<span class="sc">&lt;</span>i)<span class="sc">*</span>(y<span class="sc">&gt;</span>j)<span class="sc">*</span>w)</span>
<span id="cb259-14"><a href="相关.html#cb259-14" aria-hidden="true" tabindex="-1"></a>    Vij[i,j]<span class="ot">=</span>Dr<span class="sc">*</span><span class="fu">sum</span>(WW[i,])<span class="sc">+</span>Dc<span class="sc">*</span><span class="fu">sum</span>(WW[,j])</span>
<span id="cb259-15"><a href="相关.html#cb259-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb259-16"><a href="相关.html#cb259-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb259-17"><a href="相关.html#cb259-17" aria-hidden="true" tabindex="-1"></a>nc<span class="ot">=</span><span class="fu">sum</span>(WW<span class="sc">*</span>CC)<span class="sc">/</span><span class="dv">2</span>;</span>
<span id="cb259-18"><a href="相关.html#cb259-18" aria-hidden="true" tabindex="-1"></a>nd<span class="ot">=</span><span class="fu">sum</span>(WW<span class="sc">*</span>DD)<span class="sc">/</span><span class="dv">2</span>;</span>
<span id="cb259-19"><a href="相关.html#cb259-19" aria-hidden="true" tabindex="-1"></a>taub<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>(nc<span class="sc">-</span>nd)<span class="sc">/</span><span class="fu">sqrt</span>(Dc<span class="sc">*</span>Dr)</span>
<span id="cb259-20"><a href="相关.html#cb259-20" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span><span class="fu">sum</span>(WW<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(Dc<span class="sc">*</span>Dr)<span class="sc">*</span>(CC<span class="sc">-</span>DD)<span class="sc">+</span>taub<span class="sc">*</span>Vij)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span>n<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>taub<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(Dr<span class="sc">+</span>Dc)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb259-21"><a href="相关.html#cb259-21" aria-hidden="true" tabindex="-1"></a>sigtaub<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(Dc<span class="sc">*</span>Dr)<span class="sc">*</span><span class="fu">sqrt</span>(temp);</span>
<span id="cb259-22"><a href="相关.html#cb259-22" aria-hidden="true" tabindex="-1"></a>tauc<span class="ot">=</span>q<span class="sc">*</span>(nc<span class="sc">-</span>nd)<span class="sc">/</span>(n<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb259-23"><a href="相关.html#cb259-23" aria-hidden="true" tabindex="-1"></a>sigtauc<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>q<span class="sc">/</span>((q<span class="dv">-1</span>)<span class="sc">*</span>n<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(WW<span class="sc">*</span>(CC<span class="sc">-</span>DD)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span>(nc<span class="sc">-</span>nd)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="dv">4</span><span class="sc">/</span>n);</span>
<span id="cb259-24"><a href="相关.html#cb259-24" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">taub=</span><span class="fu">c</span>(<span class="at">taub=</span>taub,<span class="at">sigtaub=</span>sigtaub,<span class="at">CI95=</span><span class="fu">c</span>(taub<span class="fl">-1.96</span><span class="sc">*</span>sigtaub,taub<span class="fl">+1.96</span><span class="sc">*</span>sigtaub)),<span class="at">tauc=</span><span class="fu">c</span>(<span class="at">tauc=</span>tauc,<span class="at">sigtauc=</span>sigtauc,<span class="at">CI95=</span><span class="fu">c</span>(tauc<span class="fl">-1.96</span><span class="sc">*</span>sigtauc,tauc<span class="fl">+1.96</span><span class="sc">*</span>sigtauc)))</span></code></pre></div>
<pre><code>## $taub
##         taub      sigtaub        CI951        CI952 
##  0.179184127  0.095542482 -0.008079138  0.366447391 
## 
## $tauc
##         tauc      sigtauc        CI951        CI952 
##  0.171475530  0.092263333 -0.009360603  0.352311662</code></pre>
</div>
<div id="goodman-kruskals-gamma-相关检验" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> 6.3 Goodman-Kruskal’s <span class="math inline">\(\gamma\)</span> 相关检验<a href="相关.html#goodman-kruskals-gamma-相关检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>两个有序变量</li>
<li>有大量的打结</li>
</ul>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="相关.html#cb261-1" aria-hidden="true" tabindex="-1"></a>xx<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/incsat.txt&quot;</span>)</span>
<span id="cb261-2"><a href="相关.html#cb261-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>xx[,<span class="dv">1</span>];y<span class="ot">=</span>xx[,<span class="dv">2</span>];w<span class="ot">=</span>xx[,<span class="dv">3</span>];</span>
<span id="cb261-3"><a href="相关.html#cb261-3" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="fu">max</span>(x);n2<span class="ot">=</span><span class="fu">max</span>(y);</span>
<span id="cb261-4"><a href="相关.html#cb261-4" aria-hidden="true" tabindex="-1"></a>WW<span class="ot">=</span><span class="fu">matrix</span>(w,<span class="at">byrow=</span>T,<span class="at">nrow=</span>n1);</span>
<span id="cb261-5"><a href="相关.html#cb261-5" aria-hidden="true" tabindex="-1"></a>DD<span class="ot">=</span>CC<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>n1,<span class="at">ncol=</span>n2);</span>
<span id="cb261-6"><a href="相关.html#cb261-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb261-7"><a href="相关.html#cb261-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n2){</span>
<span id="cb261-8"><a href="相关.html#cb261-8" aria-hidden="true" tabindex="-1"></a>    CC[i,j]<span class="ot">=</span><span class="fu">sum</span>((x<span class="sc">&gt;</span>i)<span class="sc">*</span>(y<span class="sc">&gt;</span>j)<span class="sc">*</span>w)<span class="sc">+</span><span class="fu">sum</span>((x<span class="sc">&lt;</span>i)<span class="sc">*</span>(y<span class="sc">&lt;</span>j)<span class="sc">*</span>w)</span>
<span id="cb261-9"><a href="相关.html#cb261-9" aria-hidden="true" tabindex="-1"></a>    DD[i,j]<span class="ot">=</span><span class="fu">sum</span>((x<span class="sc">&gt;</span>i)<span class="sc">*</span>(y<span class="sc">&lt;</span>j)<span class="sc">*</span>w)<span class="sc">+</span><span class="fu">sum</span>((x<span class="sc">&lt;</span>i)<span class="sc">*</span>(y<span class="sc">&gt;</span>j)<span class="sc">*</span>w)</span>
<span id="cb261-10"><a href="相关.html#cb261-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb261-11"><a href="相关.html#cb261-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb261-12"><a href="相关.html#cb261-12" aria-hidden="true" tabindex="-1"></a>nc<span class="ot">=</span><span class="fu">sum</span>(WW<span class="sc">*</span>CC)<span class="sc">/</span><span class="dv">2</span>;</span>
<span id="cb261-13"><a href="相关.html#cb261-13" aria-hidden="true" tabindex="-1"></a>nd<span class="ot">=</span><span class="fu">sum</span>(WW<span class="sc">*</span>DD)<span class="sc">/</span><span class="dv">2</span>;</span>
<span id="cb261-14"><a href="相关.html#cb261-14" aria-hidden="true" tabindex="-1"></a>G<span class="ot">=</span>(nc<span class="sc">-</span>nd)<span class="sc">/</span>(nc<span class="sc">+</span>nd)</span>
<span id="cb261-15"><a href="相关.html#cb261-15" aria-hidden="true" tabindex="-1"></a>ASE<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(nc<span class="sc">+</span>nd)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(WW<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>nd<span class="sc">*</span>CC<span class="dv">-2</span><span class="sc">*</span>nc<span class="sc">*</span>DD)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb261-16"><a href="相关.html#cb261-16" aria-hidden="true" tabindex="-1"></a>pvalue<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(G<span class="sc">/</span>ASE));</span>
<span id="cb261-17"><a href="相关.html#cb261-17" aria-hidden="true" tabindex="-1"></a>CI95<span class="ot">=</span><span class="fu">c</span>(G<span class="fl">-1.96</span><span class="sc">*</span>ASE,G<span class="fl">+1.96</span><span class="sc">*</span>ASE)</span>
<span id="cb261-18"><a href="相关.html#cb261-18" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">G=</span>G,<span class="at">ASE=</span>ASE,<span class="at">CI95=</span>CI95,<span class="at">pvalue=</span>pvalue)</span></code></pre></div>
<pre><code>## $G
## [1] 0.279714
## 
## $ASE
## [1] 0.145529
## 
## $CI95
## [1] -0.005522756  0.564950817
## 
## $pvalue
## [1] 0.05459941</code></pre>
</div>
<div id="somersd-相关检验" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> 6.4 Somers’d 相关检验<a href="相关.html#somersd-相关检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="相关.html#cb263-1" aria-hidden="true" tabindex="-1"></a>xxx<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/incsat.txt&quot;</span>)</span>
<span id="cb263-2"><a href="相关.html#cb263-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>xx[,<span class="dv">1</span>];y<span class="ot">=</span>xx[,<span class="dv">2</span>];w<span class="ot">=</span>xx[,<span class="dv">3</span>];</span>
<span id="cb263-3"><a href="相关.html#cb263-3" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="fu">max</span>(x);n2<span class="ot">=</span><span class="fu">max</span>(y);n<span class="ot">=</span><span class="fu">sum</span>(w);</span>
<span id="cb263-4"><a href="相关.html#cb263-4" aria-hidden="true" tabindex="-1"></a>WW<span class="ot">=</span><span class="fu">matrix</span>(w,<span class="at">byrow=</span>T,<span class="at">nrow=</span>n1)</span>
<span id="cb263-5"><a href="相关.html#cb263-5" aria-hidden="true" tabindex="-1"></a>Dc<span class="ot">=</span>n<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span><span class="fu">sum</span>((<span class="fu">apply</span>(WW,<span class="dv">2</span>,sum))<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb263-6"><a href="相关.html#cb263-6" aria-hidden="true" tabindex="-1"></a>Dr<span class="ot">=</span>n<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span><span class="fu">sum</span>((<span class="fu">apply</span>(WW,<span class="dv">1</span>,sum))<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb263-7"><a href="相关.html#cb263-7" aria-hidden="true" tabindex="-1"></a>Vij<span class="ot">=</span>DD<span class="ot">=</span>CC<span class="ot">=</span>nRi<span class="ot">=</span>nCj<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>n1,<span class="at">ncol=</span>n2)</span>
<span id="cb263-8"><a href="相关.html#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb263-9"><a href="相关.html#cb263-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n2){</span>
<span id="cb263-10"><a href="相关.html#cb263-10" aria-hidden="true" tabindex="-1"></a>    CC[i,j]<span class="ot">=</span><span class="fu">sum</span>((x<span class="sc">&gt;</span>i)<span class="sc">*</span>(y<span class="sc">&gt;</span>j)<span class="sc">*</span>w)<span class="sc">+</span><span class="fu">sum</span>((x<span class="sc">&lt;</span>i)<span class="sc">*</span>(y<span class="sc">&lt;</span>j)<span class="sc">*</span>w)</span>
<span id="cb263-11"><a href="相关.html#cb263-11" aria-hidden="true" tabindex="-1"></a>    DD[i,j]<span class="ot">=</span><span class="fu">sum</span>((x<span class="sc">&gt;</span>i)<span class="sc">*</span>(y<span class="sc">&lt;</span>j)<span class="sc">*</span>w)<span class="sc">+</span><span class="fu">sum</span>((x<span class="sc">&lt;</span>i)<span class="sc">*</span>(y<span class="sc">&gt;</span>j)<span class="sc">*</span>w)</span>
<span id="cb263-12"><a href="相关.html#cb263-12" aria-hidden="true" tabindex="-1"></a>    Vij[i,j]<span class="ot">=</span>Dr<span class="sc">*</span><span class="fu">sum</span>(WW[i,])<span class="sc">+</span>Dc<span class="sc">*</span><span class="fu">sum</span>(WW[,j])</span>
<span id="cb263-13"><a href="相关.html#cb263-13" aria-hidden="true" tabindex="-1"></a>    nRi[i,j]<span class="ot">=</span>n<span class="sc">-</span><span class="fu">sum</span>(WW[i,]);</span>
<span id="cb263-14"><a href="相关.html#cb263-14" aria-hidden="true" tabindex="-1"></a>    nCj[i,j]<span class="ot">=</span>n<span class="sc">-</span><span class="fu">sum</span>(WW[,j])</span>
<span id="cb263-15"><a href="相关.html#cb263-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb263-16"><a href="相关.html#cb263-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb263-17"><a href="相关.html#cb263-17" aria-hidden="true" tabindex="-1"></a>nc<span class="ot">=</span><span class="fu">sum</span>(WW<span class="sc">*</span>CC)<span class="sc">/</span><span class="dv">2</span>;nd<span class="ot">=</span><span class="fu">sum</span>(WW<span class="sc">*</span>DD)<span class="sc">/</span><span class="dv">2</span>;</span>
<span id="cb263-18"><a href="相关.html#cb263-18" aria-hidden="true" tabindex="-1"></a>taub<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>(nc<span class="sc">-</span>nd)<span class="sc">/</span><span class="fu">sqrt</span>(Dc<span class="sc">*</span>Dr)</span>
<span id="cb263-19"><a href="相关.html#cb263-19" aria-hidden="true" tabindex="-1"></a>temp<span class="ot">=</span><span class="fu">sum</span>(WW<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(Dc<span class="sc">*</span>Dr)<span class="sc">*</span>(CC<span class="sc">-</span>DD)<span class="sc">+</span>taub<span class="sc">*</span>Vij)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span>n<span class="sc">^</span><span class="dv">3</span><span class="sc">*</span>taub<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(Dr<span class="sc">+</span>Dc)<span class="sc">^</span><span class="dv">2</span>;</span>
<span id="cb263-20"><a href="相关.html#cb263-20" aria-hidden="true" tabindex="-1"></a>sigtaub<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span>(Dc<span class="sc">*</span>Dr)<span class="sc">*</span><span class="fu">sqrt</span>(temp);</span>
<span id="cb263-21"><a href="相关.html#cb263-21" aria-hidden="true" tabindex="-1"></a>dCR<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>(nc<span class="sc">-</span>nd)<span class="sc">/</span>Dr;</span>
<span id="cb263-22"><a href="相关.html#cb263-22" aria-hidden="true" tabindex="-1"></a>dRC<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>(nc<span class="sc">-</span>nd)<span class="sc">/</span>Dc;</span>
<span id="cb263-23"><a href="相关.html#cb263-23" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="dv">4</span><span class="sc">*</span>(nc<span class="sc">-</span>nd)<span class="sc">/</span>(Dc<span class="sc">+</span>Dr);</span>
<span id="cb263-24"><a href="相关.html#cb263-24" aria-hidden="true" tabindex="-1"></a>sigdCR<span class="ot">=</span><span class="dv">2</span><span class="sc">/</span>Dr<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(WW<span class="sc">*</span>(Dr<span class="sc">*</span>(CC<span class="sc">-</span>DD)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(nc<span class="sc">-</span>nd)<span class="sc">*</span>nRi)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb263-25"><a href="相关.html#cb263-25" aria-hidden="true" tabindex="-1"></a>sigdRC<span class="ot">=</span><span class="dv">2</span><span class="sc">/</span>Dc<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(WW<span class="sc">*</span>(Dc<span class="sc">*</span>(CC<span class="sc">-</span>DD)<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(nc<span class="sc">-</span>nd)<span class="sc">*</span>nCj)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb263-26"><a href="相关.html#cb263-26" aria-hidden="true" tabindex="-1"></a>sigd<span class="ot">=</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>sigtaub<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(Dc<span class="sc">+</span>Dr)<span class="sc">*</span><span class="fu">sqrt</span>(Dc<span class="sc">*</span>Dr));</span>
<span id="cb263-27"><a href="相关.html#cb263-27" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fl">1.96</span>;</span>
<span id="cb263-28"><a href="相关.html#cb263-28" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">dCR=</span><span class="fu">c</span>(<span class="at">dCR=</span>dCR,<span class="at">sigdCR=</span>sigdCR,<span class="at">CI95=</span><span class="fu">c</span>(dCR<span class="sc">-</span>z<span class="sc">*</span>sigdCR,dCR<span class="sc">+</span>z<span class="sc">*</span>sigdCR)),</span>
<span id="cb263-29"><a href="相关.html#cb263-29" aria-hidden="true" tabindex="-1"></a><span class="at">dRC=</span><span class="fu">c</span>(<span class="at">dRC=</span>dRC,<span class="at">sigdRC=</span>sigdRC,<span class="at">CI95=</span><span class="fu">c</span>(dRC<span class="sc">-</span>z<span class="sc">*</span>sigdRC,dRC<span class="sc">+</span>z<span class="sc">*</span>sigdRC)),</span>
<span id="cb263-30"><a href="相关.html#cb263-30" aria-hidden="true" tabindex="-1"></a><span class="at">d=</span><span class="fu">c</span>(<span class="at">d=</span>d,<span class="at">sigd=</span>sigd,<span class="at">CI95=</span><span class="fu">c</span>(d<span class="sc">-</span>z<span class="sc">*</span>sigd,d<span class="sc">+</span>z<span class="sc">*</span>sigd)))</span></code></pre></div>
<pre><code>## $dCR
##          dCR       sigdCR        CI951        CI952 
##  0.176536943  0.094526643 -0.008735276  0.361809162 
## 
## $dRC
##          dRC       sigdRC        CI951        CI952 
##  0.181871005  0.096832841 -0.007921364  0.371663374 
## 
## $d
##            d         sigd        CI951        CI952 
##  0.179164282  0.095537191 -0.008088613  0.366417176</code></pre>
</div>
<div id="theil非参数回归" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> 6.5 Theil非参数回归<a href="相关.html#theil非参数回归" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>类似于最小二乘法</li>
</ul>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="相关.html#cb265-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/CPIGINI.txt&quot;</span>,<span class="at">header=</span>T);</span>
<span id="cb265-2"><a href="相关.html#cb265-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>d[,<span class="dv">1</span>];y<span class="ot">=</span>d[,<span class="dv">2</span>];</span>
<span id="cb265-3"><a href="相关.html#cb265-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(d)</span>
<span id="cb265-4"><a href="相关.html#cb265-4" aria-hidden="true" tabindex="-1"></a>s<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb265-5"><a href="相关.html#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb265-6"><a href="相关.html#cb265-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb265-7"><a href="相关.html#cb265-7" aria-hidden="true" tabindex="-1"></a>    s<span class="ot">=</span><span class="fu">c</span>(s,(y[j]<span class="sc">-</span>y[i])<span class="sc">/</span>(x[j]<span class="sc">-</span>x[i]))</span>
<span id="cb265-8"><a href="相关.html#cb265-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb265-9"><a href="相关.html#cb265-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb265-10"><a href="相关.html#cb265-10" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">median</span>(s);</span>
<span id="cb265-11"><a href="相关.html#cb265-11" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">median</span>(y<span class="sc">-</span>b<span class="sc">*</span>x);</span>
<span id="cb265-12"><a href="相关.html#cb265-12" aria-hidden="true" tabindex="-1"></a>e<span class="ot">=</span>y<span class="sc">-</span>a<span class="sc">-</span>b<span class="sc">*</span>x;</span>
<span id="cb265-13"><a href="相关.html#cb265-13" aria-hidden="true" tabindex="-1"></a>(<span class="at">coef=</span><span class="fu">c</span>(a,b))</span></code></pre></div>
<pre><code>## [1] 43.650000 -1.666667</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="相关.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -13.371  -5.493  -2.510   3.191  33.420 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  45.0656     3.2988  13.661 3.06e-16 ***
## x            -1.4888     0.5742  -2.593   0.0134 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.005 on 38 degrees of freedom
## Multiple R-squared:  0.1503, Adjusted R-squared:  0.128 
## F-statistic: 6.723 on 1 and 38 DF,  p-value: 0.01344</code></pre>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="相关.html#cb269-1" aria-hidden="true" tabindex="-1"></a>example.ci<span class="ot">=</span><span class="cf">function</span>(){</span>
<span id="cb269-2"><a href="相关.html#cb269-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/CPIGINI.txt&quot;</span>,<span class="at">header=</span>T);</span>
<span id="cb269-3"><a href="相关.html#cb269-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>d[,<span class="dv">1</span>];y<span class="ot">=</span>d[,<span class="dv">2</span>];</span>
<span id="cb269-4"><a href="相关.html#cb269-4" aria-hidden="true" tabindex="-1"></a>TT<span class="ot">=</span><span class="cf">function</span>(x,y,alpha){</span>
<span id="cb269-5"><a href="相关.html#cb269-5" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(x);s<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb269-6"><a href="相关.html#cb269-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb269-7"><a href="相关.html#cb269-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb269-8"><a href="相关.html#cb269-8" aria-hidden="true" tabindex="-1"></a>      s<span class="ot">=</span><span class="fu">c</span>(s,(y[j]<span class="sc">-</span>y[i])<span class="sc">/</span>(x[j]<span class="sc">-</span>x[i]));</span>
<span id="cb269-9"><a href="相关.html#cb269-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb269-10"><a href="相关.html#cb269-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb269-11"><a href="相关.html#cb269-11" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">median</span>(s);</span>
<span id="cb269-12"><a href="相关.html#cb269-12" aria-hidden="true" tabindex="-1"></a>a<span class="ot">=</span><span class="fu">median</span>(y<span class="sc">-</span>b<span class="sc">*</span>x); </span>
<span id="cb269-13"><a href="相关.html#cb269-13" aria-hidden="true" tabindex="-1"></a>e<span class="ot">=</span>y<span class="sc">-</span>a<span class="sc">-</span>b<span class="sc">*</span>x; </span>
<span id="cb269-14"><a href="相关.html#cb269-14" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="fu">length</span>(s);</span>
<span id="cb269-15"><a href="相关.html#cb269-15" aria-hidden="true" tabindex="-1"></a>s<span class="ot">=</span><span class="fu">sort</span>(s);</span>
<span id="cb269-16"><a href="相关.html#cb269-16" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb269-17"><a href="相关.html#cb269-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){z<span class="ot">=</span><span class="fu">c</span>(z,<span class="fu">cor.test</span>(x,y<span class="sc">-</span>s[i]<span class="sc">*</span>x,<span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value)}</span>
<span id="cb269-18"><a href="相关.html#cb269-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">floor</span>(m<span class="sc">/</span><span class="dv">2</span>)){</span>
<span id="cb269-19"><a href="相关.html#cb269-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(z[i]<span class="sc">&gt;</span>alpha<span class="sc">/</span><span class="dv">2</span>){bound<span class="ot">=</span><span class="fu">c</span>(i<span class="dv">-1</span>,m<span class="sc">-</span>i<span class="sc">+</span><span class="dv">2</span>,s[i<span class="dv">-1</span>],s[m<span class="sc">-</span>(i<span class="dv">-2</span>)],z[i<span class="dv">-1</span>]);<span class="cf">break</span>}</span>
<span id="cb269-20"><a href="相关.html#cb269-20" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb269-21"><a href="相关.html#cb269-21" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="fu">nrow</span>(d),<span class="at">coefficient=</span><span class="fu">c</span>(a,b),<span class="at">residual=</span>e,<span class="at">ci=</span>bound[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="at">confid=</span><span class="dv">1-2</span><span class="sc">*</span>bound[<span class="dv">5</span>])</span>
<span id="cb269-22"><a href="相关.html#cb269-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb269-23"><a href="相关.html#cb269-23" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="fu">TT</span>(x,y,<span class="fl">0.05</span>))</span>
<span id="cb269-24"><a href="相关.html#cb269-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb269-25"><a href="相关.html#cb269-25" aria-hidden="true" tabindex="-1"></a><span class="fu">example.ci</span>()</span></code></pre></div>
<pre><code>## [[1]]
## [[1]][[1]]
## [1] 40
## 
## [[1]]$coefficient
## [1] 43.650000 -1.666667
## 
## [[1]]$residual
##  [1]  -1.883333  -3.116667  -3.150000   2.850000   7.650000   5.883333
##  [7]  -3.683333   0.350000  14.183333  25.950000  -1.483333  -3.116667
## [13]   3.750000  -0.450000  -5.250000  35.850000   2.683333  -7.683333
## [19]   9.650000 -11.083333  -1.650000  -0.350000  -1.250000  -5.383333
## [25]   3.550000  -8.316667  -3.083333  12.783333   2.816667   9.850000
## [31]   5.883333   0.750000   1.683333  10.016667  -3.550000   2.016667
## [37]  -2.750000  -4.316667  -2.716667   9.616667
## 
## [[1]]$ci
## [1] 293.0000000 488.0000000  -2.6875000  -0.6969697
## 
## [[1]]$confid
## [1] 0.9538398</code></pre>
<div id="几种稳健回归" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> 几种稳健回归<a href="相关.html#几种稳健回归" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="相关.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb271-2"><a href="相关.html#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(d)</span>
<span id="cb271-3"><a href="相关.html#cb271-3" aria-hidden="true" tabindex="-1"></a>lms<span class="ot">=</span><span class="fu">lqs</span>(GINI<span class="sc">~</span>CPI,<span class="at">method=</span><span class="st">&quot;lms&quot;</span>);</span>
<span id="cb271-4"><a href="相关.html#cb271-4" aria-hidden="true" tabindex="-1"></a>lms<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>## (Intercept)         CPI 
##   43.123913   -1.608696</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="相关.html#cb273-1" aria-hidden="true" tabindex="-1"></a>lts<span class="ot">=</span><span class="fu">lqs</span>(GINI<span class="sc">~</span>CPI,<span class="at">method=</span><span class="st">&quot;lts&quot;</span>);</span>
<span id="cb273-2"><a href="相关.html#cb273-2" aria-hidden="true" tabindex="-1"></a>lts<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>## (Intercept)         CPI 
##   42.276984   -1.791667</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="相关.html#cb275-1" aria-hidden="true" tabindex="-1"></a>se<span class="ot">=</span><span class="fu">lqs</span>(GINI<span class="sc">~</span>CPI,<span class="at">method=</span><span class="st">&quot;S&quot;</span>)</span>
<span id="cb275-2"><a href="相关.html#cb275-2" aria-hidden="true" tabindex="-1"></a>se<span class="sc">$</span>coefficients</span></code></pre></div>
<pre><code>## (Intercept)         CPI 
##   42.716129   -1.741935</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="相关.html#cb277-1" aria-hidden="true" tabindex="-1"></a>nonpara<span class="ot">=</span><span class="cf">function</span>(){</span>
<span id="cb277-2"><a href="相关.html#cb277-2" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/reg.txt&quot;</span>,<span class="at">header=</span>T);</span>
<span id="cb277-3"><a href="相关.html#cb277-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>d[,<span class="dv">1</span>];y<span class="ot">=</span>d[,<span class="dv">2</span>];</span>
<span id="cb277-4"><a href="相关.html#cb277-4" aria-hidden="true" tabindex="-1"></a>TT<span class="ot">=</span><span class="cf">function</span>(x,y,alpha){n<span class="ot">=</span><span class="fu">length</span>(x);s<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb277-5"><a href="相关.html#cb277-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>))<span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n)s<span class="ot">=</span><span class="fu">c</span>(s,(y[j]<span class="sc">-</span>y[i])<span class="sc">/</span>(x[j]<span class="sc">-</span>x[i]));</span>
<span id="cb277-6"><a href="相关.html#cb277-6" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">median</span>(s);a<span class="ot">=</span><span class="fu">median</span>(y<span class="sc">-</span>b<span class="sc">*</span>x); e<span class="ot">=</span>y<span class="sc">-</span>a<span class="sc">-</span>b<span class="sc">*</span>x; m<span class="ot">=</span><span class="fu">length</span>(s);s<span class="ot">=</span><span class="fu">sort</span>(s);z<span class="ot">=</span><span class="cn">NULL</span>;<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m)</span>
<span id="cb277-7"><a href="相关.html#cb277-7" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">c</span>(z,<span class="fu">cor.test</span>(x,y<span class="sc">-</span>s[i]<span class="sc">*</span>x,<span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value)</span>
<span id="cb277-8"><a href="相关.html#cb277-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">floor</span>(m<span class="sc">/</span><span class="dv">2</span>)) <span class="cf">if</span> (z[i]<span class="sc">&gt;</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb277-9"><a href="相关.html#cb277-9" aria-hidden="true" tabindex="-1"></a>{bound<span class="ot">=</span><span class="fu">c</span>(i<span class="dv">-1</span>,m<span class="sc">-</span>i<span class="sc">+</span><span class="dv">2</span>,s[i<span class="dv">-1</span>],s[m<span class="sc">-</span>(i<span class="dv">-2</span>)],z[i<span class="dv">-1</span>]);<span class="cf">break</span>}</span>
<span id="cb277-10"><a href="相关.html#cb277-10" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="fu">nrow</span>(d),<span class="at">coefficient=</span><span class="fu">c</span>(a,b),<span class="at">residual=</span>e,<span class="at">ci=</span>bound[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">confid=</span><span class="dv">1-2</span><span class="sc">*</span>bound[<span class="dv">5</span>])} </span>
<span id="cb277-11"><a href="相关.html#cb277-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb277-12"><a href="相关.html#cb277-12" aria-hidden="true" tabindex="-1"></a>lms<span class="ot">&lt;-</span><span class="fu">lqs</span>(y<span class="sc">~</span>x,<span class="at">method=</span><span class="st">&quot;lms&quot;</span>)</span>
<span id="cb277-13"><a href="相关.html#cb277-13" aria-hidden="true" tabindex="-1"></a>lts<span class="ot">&lt;-</span><span class="fu">lqs</span>(y<span class="sc">~</span>x,<span class="at">method=</span><span class="st">&quot;lts&quot;</span>)</span>
<span id="cb277-14"><a href="相关.html#cb277-14" aria-hidden="true" tabindex="-1"></a>se<span class="ot">&lt;-</span><span class="fu">lqs</span>(y<span class="sc">~</span>x,<span class="at">method=</span><span class="st">&quot;S&quot;</span>)</span>
<span id="cb277-15"><a href="相关.html#cb277-15" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="st">&quot;OLS&quot;</span><span class="ot">=</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))<span class="sc">$</span>coef, <span class="st">&quot;Theil&quot;</span><span class="ot">=</span><span class="fu">TT</span>(x,y,<span class="fl">0.05</span>)<span class="sc">$</span>coef, <span class="st">&quot;LMS&quot;</span><span class="ot">=</span>lms<span class="sc">$</span>coef, <span class="st">&quot;LTS&quot;</span><span class="ot">=</span>lts<span class="sc">$</span>coef, <span class="st">&quot;SE&quot;</span><span class="ot">=</span>se<span class="sc">$</span>coefficients)}</span>
<span id="cb277-16"><a href="相关.html#cb277-16" aria-hidden="true" tabindex="-1"></a><span class="fu">nonpara</span>()</span></code></pre></div>
<pre><code>## $OLS
## (Intercept)           x 
##   4.8132066   0.2116785 
## 
## $Theil
## [1]  5.739194 -0.459464
## 
## $LMS
## (Intercept)           x 
##   6.0634483  -0.8908046 
## 
## $LTS
## (Intercept)           x 
##   6.2328025  -0.9235669 
## 
## $SE
## (Intercept)           x 
##   6.2083630  -0.9359431</code></pre>
</div>
<div id="simple-linear-regression" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Simple Linear Regression<a href="相关.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="相关.html#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The data are a sample of 235 Belgian working class households. The response variable is annual household income in Belgian francs and the explanatory variable is the annual food expenditure in Belgian francs.</span></span>
<span id="cb279-2"><a href="相关.html#cb279-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rfit)</span>
<span id="cb279-3"><a href="相关.html#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(quantreg)</span></code></pre></div>
<pre><code>## Loading required package: SparseM</code></pre>
<pre><code>## 
## Attaching package: &#39;SparseM&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:base&#39;:
## 
##     backsolve</code></pre>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="相关.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(engel)</span>
<span id="cb283-2"><a href="相关.html#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(engel)</span>
<span id="cb283-3"><a href="相关.html#cb283-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">rfit</span>(foodexp<span class="sc">~</span>income,<span class="at">data=</span>engel))</span>
<span id="cb283-4"><a href="相关.html#cb283-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(foodexp<span class="sc">~</span>income,<span class="at">data=</span>engel),<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb283-5"><a href="相关.html#cb283-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="fu">c</span>(<span class="st">&#39;R&#39;</span>,<span class="st">&#39;LS&#39;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="相关.html#cb284-1" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">rfit</span>(foodexp<span class="sc">~</span>income,<span class="at">data=</span>engel)</span>
<span id="cb284-2"><a href="相关.html#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fit))</span></code></pre></div>
<pre><code>##                Estimate  Std. Error   t.value       p.value
## (Intercept) 103.6480433 12.77461534  8.113594  2.818115e-14
## income        0.5377726  0.01150739 46.732793 2.431145e-120</code></pre>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="相关.html#cb286-1" aria-hidden="true" tabindex="-1"></a>rs<span class="ot">&lt;-</span><span class="fu">rstudent</span>(fit)</span>
<span id="cb286-2"><a href="相关.html#cb286-2" aria-hidden="true" tabindex="-1"></a>yhat<span class="ot">&lt;-</span><span class="fu">fitted.values</span>(fit)</span>
<span id="cb286-3"><a href="相关.html#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb286-4"><a href="相关.html#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(rs)</span>
<span id="cb286-5"><a href="相关.html#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(yhat,rs)</span></code></pre></div>
<p><img src="06_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="multiple-linear-regression" class="section level3 hasAnchor" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Multiple Linear Regression<a href="相关.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="相关.html#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co">#a dataset from Morrison (1983: p.64) (c.f. Hettmansperger and McKean 2011). The response variable is the level of free fatty acid (ffa) in a sample of prepubescent boys. The explanatory variables are age (in months), weight (in pounds), and skin fold thickness</span></span>
<span id="cb287-2"><a href="相关.html#cb287-2" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">rfit</span>(ffa<span class="sc">~</span>age<span class="sc">+</span>weight<span class="sc">+</span>skin,<span class="at">data=</span>ffa)</span>
<span id="cb287-3"><a href="相关.html#cb287-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## Call:
## rfit.default(formula = ffa ~ age + weight + skin, data = ffa)
## 
## Coefficients:
##               Estimate Std. Error t.value   p.value    
## (Intercept)  1.4905899  0.2676129  5.5699 2.401e-06 ***
## age         -0.0011337  0.0026178 -0.4331 0.6674769    
## weight      -0.0153484  0.0038216 -4.0163 0.0002779 ***
## skin         0.2747982  0.1333516  2.0607 0.0464133 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Multiple R-squared (Robust): 0.3773118 
## Reduction in Dispersion Test: 7.47326 p-value: 0.00049</code></pre>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="相关.html#cb289-1" aria-hidden="true" tabindex="-1"></a>fitF<span class="ot">&lt;-</span><span class="fu">rfit</span>(ffa<span class="sc">~</span>age<span class="sc">+</span>weight<span class="sc">+</span>skin,<span class="at">data=</span>ffa)</span>
<span id="cb289-2"><a href="相关.html#cb289-2" aria-hidden="true" tabindex="-1"></a>fitR<span class="ot">&lt;-</span><span class="fu">rfit</span>(ffa<span class="sc">~</span>skin,<span class="at">data=</span>ffa)</span>
<span id="cb289-3"><a href="相关.html#cb289-3" aria-hidden="true" tabindex="-1"></a><span class="fu">drop.test</span>(fitF,fitR)</span></code></pre></div>
<pre><code>## 
## Drop in Dispersion Test
## F-Statistic     p-value 
##  1.0838e+01  1.9736e-04</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="尺度参数.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="分布检验.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/06.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-template.pdf", "bookdown-template.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
