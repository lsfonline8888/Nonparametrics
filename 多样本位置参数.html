<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 4 章 多样本位置参数 | 非参数统计</title>
  <meta name="description" content="description" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="第 4 章 多样本位置参数 | 非参数统计" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="description" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 4 章 多样本位置参数 | 非参数统计" />
  
  <meta name="twitter:description" content="description" />
  

<meta name="author" content="Sifan Liu, TJUFE" />


<meta name="date" content="2022-08-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="双样本位置参数.html"/>
<link rel="next" href="尺度参数.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Title</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="概述.html"><a href="概述.html"><i class="fa fa-check"></i><b>1</b> 概述</a>
<ul>
<li class="chapter" data-level="1.1" data-path="概述.html"><a href="概述.html#习题1-1.5-数据可视化查看对总体分布的假设是否合理"><i class="fa fa-check"></i><b>1.1</b> 习题1: (1.5 数据可视化，查看对总体分布的假设是否合理)</a></li>
<li class="chapter" data-level="1.2" data-path="概述.html"><a href="概述.html#数据变换box-cox变换"><i class="fa fa-check"></i><b>1.2</b> 数据变换（Box-Cox变换）</a></li>
<li class="chapter" data-level="1.3" data-path="概述.html"><a href="概述.html#section"><i class="fa fa-check"></i><b>1.3</b> 2.(1)</a></li>
<li class="chapter" data-level="1.4" data-path="概述.html"><a href="概述.html#section-1"><i class="fa fa-check"></i><b>1.4</b> 2.(2)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="单样本位置参数.html"><a href="单样本位置参数.html"><i class="fa fa-check"></i><b>2</b> 单样本位置参数</a>
<ul>
<li class="chapter" data-level="2.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#引入的例子楼盘均价"><i class="fa fa-check"></i><b>2.1</b> 引入的例子：楼盘均价</a></li>
<li class="chapter" data-level="2.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#符号检验-sign-test"><i class="fa fa-check"></i><b>2.2</b> 2.1 符号检验 Sign Test</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#广义符号检验"><i class="fa fa-check"></i><b>2.2.1</b> 2.1.1. 广义符号检验</a></li>
<li class="chapter" data-level="2.2.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#分位点的置信区间"><i class="fa fa-check"></i><b>2.2.2</b> 2.1.2 分位点的置信区间</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="单样本位置参数.html"><a href="单样本位置参数.html#wilcoxon符号秩检验wilcoxon-sign-rank"><i class="fa fa-check"></i><b>2.3</b> 2.2 Wilcoxon符号秩检验(Wilcoxon Sign Rank)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#检验"><i class="fa fa-check"></i><b>2.3.1</b> 2.2.1 检验</a></li>
<li class="chapter" data-level="2.3.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#置信区间"><i class="fa fa-check"></i><b>2.3.2</b> 2.2.2 置信区间</a></li>
<li class="chapter" data-level="2.3.3" data-path="单样本位置参数.html"><a href="单样本位置参数.html#simulation-study"><i class="fa fa-check"></i><b>2.3.3</b> simulation study</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="单样本位置参数.html"><a href="单样本位置参数.html#正态记分检验normal-score"><i class="fa fa-check"></i><b>2.4</b> 2.3 正态记分检验*(normal score)</a></li>
<li class="chapter" data-level="2.5" data-path="单样本位置参数.html"><a href="单样本位置参数.html#cox-stuart趋势检验"><i class="fa fa-check"></i><b>2.5</b> 2.4 Cox-Stuart趋势检验*</a></li>
<li class="chapter" data-level="2.6" data-path="单样本位置参数.html"><a href="单样本位置参数.html#随机性的游程检验"><i class="fa fa-check"></i><b>2.6</b> 2.5 随机性的游程检验*</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="双样本位置参数.html"><a href="双样本位置参数.html"><i class="fa fa-check"></i><b>3</b> 双样本位置参数</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子零件疲劳强度测试"><i class="fa fa-check"></i><b>3.0.1</b> 例子：零件疲劳强度测试</a></li>
<li class="chapter" data-level="3.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#brown-mood中位数检验"><i class="fa fa-check"></i><b>3.1</b> 3.1 Brown-Mood中位数检验</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#精确检验"><i class="fa fa-check"></i><b>3.1.1</b> 精确检验</a></li>
<li class="chapter" data-level="3.1.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#大样本近似"><i class="fa fa-check"></i><b>3.1.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#wilcoxon秩和检验"><i class="fa fa-check"></i><b>3.2</b> 3.2 Wilcoxon秩和检验</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例wilcoxon-test-for-stochastic-ordering-of-alternatives"><i class="fa fa-check"></i><b>3.2.1</b> *例：Wilcoxon Test for Stochastic Ordering of Alternatives</a></li>
<li class="chapter" data-level="3.2.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例-analyses-for-a-shift-in-location"><i class="fa fa-check"></i><b>3.2.2</b> *例： Analyses for a Shift in Location</a></li>
<li class="chapter" data-level="3.2.3" data-path="双样本位置参数.html"><a href="双样本位置参数.html#假设检验"><i class="fa fa-check"></i><b>3.2.3</b> 3.2.1 假设检验</a></li>
<li class="chapter" data-level="3.2.4" data-path="双样本位置参数.html"><a href="双样本位置参数.html#置信区间-1"><i class="fa fa-check"></i><b>3.2.4</b> 3.2.2 置信区间</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="双样本位置参数.html"><a href="双样本位置参数.html#正态记分normal-score检验"><i class="fa fa-check"></i><b>3.3</b> 3.3 正态记分（normal score）检验</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子salary"><i class="fa fa-check"></i><b>3.3.1</b> 例子：salary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="双样本位置参数.html"><a href="双样本位置参数.html#成对数据的检验"><i class="fa fa-check"></i><b>3.4</b> 3.4 成对数据的检验</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子实施管理前后"><i class="fa fa-check"></i><b>3.4.1</b> 例子：实施管理前后</a></li>
<li class="chapter" data-level="3.4.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子病人血压"><i class="fa fa-check"></i><b>3.4.2</b> 例子：病人血压</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="双样本位置参数.html"><a href="双样本位置参数.html#mcnemar检验"><i class="fa fa-check"></i><b>3.5</b> 3.5 McNemar检验</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#精确检验-1"><i class="fa fa-check"></i><b>3.5.1</b> 精确检验</a></li>
<li class="chapter" data-level="3.5.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#大样本近似-1"><i class="fa fa-check"></i><b>3.5.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="双样本位置参数.html"><a href="双样本位置参数.html#cohens-kappa系数"><i class="fa fa-check"></i><b>3.6</b> 3.6 Cohen’s Kappa系数</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="多样本位置参数.html"><a href="多样本位置参数.html"><i class="fa fa-check"></i><b>4</b> 多样本位置参数</a>
<ul>
<li class="chapter" data-level="4.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#kruskal-wallis秩和检验"><i class="fa fa-check"></i><b>4.1</b> 4.1 Kruskal-Wallis秩和检验</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#例训练方式"><i class="fa fa-check"></i><b>4.1.1</b> 例：训练方式</a></li>
<li class="chapter" data-level="4.1.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-2"><i class="fa fa-check"></i><b>4.1.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#正态记分检验"><i class="fa fa-check"></i><b>4.2</b> 4.2 正态记分检验</a></li>
<li class="chapter" data-level="4.3" data-path="多样本位置参数.html"><a href="多样本位置参数.html#jonckheere-terpstra检验"><i class="fa fa-check"></i><b>4.3</b> 4.3 Jonckheere-Terpstra检验</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-2"><i class="fa fa-check"></i><b>4.3.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.3.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-3"><i class="fa fa-check"></i><b>4.3.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="多样本位置参数.html"><a href="多样本位置参数.html#完全区组设计friedman秩和检验"><i class="fa fa-check"></i><b>4.4</b> 4.5 完全区组设计：Friedman秩和检验</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-3"><i class="fa fa-check"></i><b>4.4.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.4.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-4"><i class="fa fa-check"></i><b>4.4.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="多样本位置参数.html"><a href="多样本位置参数.html#kendall协同系数检验"><i class="fa fa-check"></i><b>4.5</b> 4.6 Kendall协同系数检验</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-5"><i class="fa fa-check"></i><b>4.5.1</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="多样本位置参数.html"><a href="多样本位置参数.html#cochran检验"><i class="fa fa-check"></i><b>4.6</b> 4.7 Cochran检验</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-4"><i class="fa fa-check"></i><b>4.6.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.6.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-6"><i class="fa fa-check"></i><b>4.6.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="多样本位置参数.html"><a href="多样本位置参数.html#page检验"><i class="fa fa-check"></i><b>4.7</b> 4.8 Page检验</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-5"><i class="fa fa-check"></i><b>4.7.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.7.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-7"><i class="fa fa-check"></i><b>4.7.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="多样本位置参数.html"><a href="多样本位置参数.html#durbin检验"><i class="fa fa-check"></i><b>4.8</b> 4.9 Durbin检验</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-6"><i class="fa fa-check"></i><b>4.8.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.8.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-8"><i class="fa fa-check"></i><b>4.8.2</b> 大样本近似</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="尺度参数.html"><a href="尺度参数.html"><i class="fa fa-check"></i><b>5</b> 尺度参数</a>
<ul>
<li class="chapter" data-level="5.1" data-path="尺度参数.html"><a href="尺度参数.html#两独立样本的siegel-tukey方差检验"><i class="fa fa-check"></i><b>5.1</b> 5.1 两独立样本的Siegel-Tukey方差检验</a></li>
<li class="chapter" data-level="5.2" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度参数的mood检验"><i class="fa fa-check"></i><b>5.2</b> 5.2 两样本尺度参数的Mood检验</a></li>
<li class="chapter" data-level="5.3" data-path="尺度参数.html"><a href="尺度参数.html#ansari-bradley检验"><i class="fa fa-check"></i><b>5.3</b> 5.3 Ansari-Bradley检验</a></li>
<li class="chapter" data-level="5.4" data-path="尺度参数.html"><a href="尺度参数.html#fligner-killeen检验"><i class="fa fa-check"></i><b>5.4</b> 5.4 Fligner-Killeen检验</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度的精确检验"><i class="fa fa-check"></i><b>5.4.1</b> 两样本尺度的精确检验</a></li>
<li class="chapter" data-level="5.4.2" data-path="尺度参数.html"><a href="尺度参数.html#多样本尺度的大样本近似"><i class="fa fa-check"></i><b>5.4.2</b> 多样本尺度的大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度的平方秩检验"><i class="fa fa-check"></i><b>5.5</b> 5.5 两样本尺度的平方秩检验</a></li>
<li class="chapter" data-level="5.6" data-path="尺度参数.html"><a href="尺度参数.html#多样本尺度的平方秩检验"><i class="fa fa-check"></i><b>5.6</b> 5.6 多样本尺度的平方秩检验</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="相关.html"><a href="相关.html"><i class="fa fa-check"></i><b>6</b> 相关</a>
<ul>
<li class="chapter" data-level="6.1" data-path="相关.html"><a href="相关.html#spearman秩相关检验"><i class="fa fa-check"></i><b>6.1</b> 6.1 Spearman秩相关检验</a></li>
<li class="chapter" data-level="6.2" data-path="相关.html"><a href="相关.html#kendall-tau-相关检验"><i class="fa fa-check"></i><b>6.2</b> 6.2 Kendall <span class="math inline">\(\tau\)</span> 相关检验</a></li>
<li class="chapter" data-level="6.3" data-path="相关.html"><a href="相关.html#goodman-kruskals-gamma-相关检验"><i class="fa fa-check"></i><b>6.3</b> 6.3 Goodman-Kruskal’s <span class="math inline">\(\gamma\)</span> 相关检验</a></li>
<li class="chapter" data-level="6.4" data-path="相关.html"><a href="相关.html#somersd-相关检验"><i class="fa fa-check"></i><b>6.4</b> 6.4 Somers’d 相关检验</a></li>
<li class="chapter" data-level="6.5" data-path="相关.html"><a href="相关.html#theil非参数回归"><i class="fa fa-check"></i><b>6.5</b> 6.5 Theil非参数回归</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="相关.html"><a href="相关.html#几种稳健回归"><i class="fa fa-check"></i><b>6.5.1</b> 几种稳健回归</a></li>
<li class="chapter" data-level="6.5.2" data-path="相关.html"><a href="相关.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.5.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="6.5.3" data-path="相关.html"><a href="相关.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.5.3</b> Multiple Linear Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="分布检验.html"><a href="分布检验.html"><i class="fa fa-check"></i><b>7</b> 分布检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="分布检验.html"><a href="分布检验.html#q-q图"><i class="fa fa-check"></i><b>7.1</b> Q-Q图</a></li>
<li class="chapter" data-level="7.2" data-path="分布检验.html"><a href="分布检验.html#kolmogorov-smirnov单样本检验"><i class="fa fa-check"></i><b>7.2</b> 7.1 Kolmogorov-Smirnov单样本检验</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="分布检验.html"><a href="分布检验.html#ks检验"><i class="fa fa-check"></i><b>7.2.1</b> KS检验</a></li>
<li class="chapter" data-level="7.2.2" data-path="分布检验.html"><a href="分布检验.html#正态性检验"><i class="fa fa-check"></i><b>7.2.2</b> 正态性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="分布检验.html"><a href="分布检验.html#kolmogorov-smirnov两样本分布检验"><i class="fa fa-check"></i><b>7.3</b> 7.2 Kolmogorov-Smirnov两样本分布检验</a></li>
<li class="chapter" data-level="7.4" data-path="分布检验.html"><a href="分布检验.html#pearson-chi2-拟合优度检验"><i class="fa fa-check"></i><b>7.4</b> 7.3 Pearson <span class="math inline">\(\chi^2\)</span> 拟合优度检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="分布检验.html"><a href="分布检验.html#goodness-of-fit-tests-for-a-single-discrete-random-variable"><i class="fa fa-check"></i><b>7.4.1</b> Goodness-of-Fit Tests for a Single Discrete Random Variable</a></li>
<li class="chapter" data-level="7.4.2" data-path="分布检验.html"><a href="分布检验.html#several-discrete-random-variables"><i class="fa fa-check"></i><b>7.4.2</b> Several Discrete Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="列联表.html"><a href="列联表.html"><i class="fa fa-check"></i><b>8</b> 列联表</a>
<ul>
<li class="chapter" data-level="8.1" data-path="列联表.html"><a href="列联表.html#二维列联表的齐性和独立性的chi2检验"><i class="fa fa-check"></i><b>8.1</b> 二维列联表的齐性和独立性的<span class="math inline">\(\chi^2\)</span>检验</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="列联表.html"><a href="列联表.html#齐性"><i class="fa fa-check"></i><b>8.1.1</b> 齐性</a></li>
<li class="chapter" data-level="8.1.2" data-path="列联表.html"><a href="列联表.html#独立性"><i class="fa fa-check"></i><b>8.1.2</b> 独立性</a></li>
<li class="chapter" data-level="8.1.3" data-path="列联表.html"><a href="列联表.html#independence-of-two-discrete-random-variables-例子吸烟与肺癌"><i class="fa fa-check"></i><b>8.1.3</b> Independence of Two Discrete Random Variables （例子：吸烟与肺癌）</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="列联表.html"><a href="列联表.html#低维列联表的fisher精确检验"><i class="fa fa-check"></i><b>8.2</b> 8.2 低维列联表的Fisher精确检验</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="列联表.html"><a href="列联表.html#数据为表格形式"><i class="fa fa-check"></i><b>8.2.1</b> 数据为表格形式</a></li>
<li class="chapter" data-level="8.2.2" data-path="列联表.html"><a href="列联表.html#数据为数据框格式"><i class="fa fa-check"></i><b>8.2.2</b> 数据为数据框格式</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="列联表.html"><a href="列联表.html#两个比例的比较"><i class="fa fa-check"></i><b>8.3</b> 8.3 两个比例的比较</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="列联表.html"><a href="列联表.html#例8.3-关于中风的研究"><i class="fa fa-check"></i><b>8.3.1</b> 例8.3 关于中风的研究</a></li>
<li class="chapter" data-level="8.3.2" data-path="列联表.html"><a href="列联表.html#one-sample-problems"><i class="fa fa-check"></i><b>8.3.2</b> One-Sample Problems*</a></li>
<li class="chapter" data-level="8.3.3" data-path="列联表.html"><a href="列联表.html#two-sample-problems"><i class="fa fa-check"></i><b>8.3.3</b> Two-Sample Problems*</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="列联表.html"><a href="列联表.html#cochran-mantel-haenszel估计"><i class="fa fa-check"></i><b>8.4</b> 8.4 Cochran-Mantel-Haenszel估计</a></li>
<li class="chapter" data-level="8.5" data-path="列联表.html"><a href="列联表.html#对数线性模型与高维列联表的独立性"><i class="fa fa-check"></i><b>8.5</b> 8.5 对数线性模型与高维列联表的独立性</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="密度估计和回归.html"><a href="密度估计和回归.html"><i class="fa fa-check"></i><b>9</b> 密度估计和回归</a>
<ul>
<li class="chapter" data-level="9.1" data-path="密度估计和回归.html"><a href="密度估计和回归.html#非参数密度估计"><i class="fa fa-check"></i><b>9.1</b> 非参数密度估计</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="密度估计和回归.html"><a href="密度估计和回归.html#一元密度估计"><i class="fa fa-check"></i><b>9.1.1</b> 一元密度估计</a></li>
<li class="chapter" data-level="9.1.2" data-path="密度估计和回归.html"><a href="密度估计和回归.html#多元密度估计"><i class="fa fa-check"></i><b>9.1.2</b> 多元密度估计</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="密度估计和回归.html"><a href="密度估计和回归.html#非参数回归"><i class="fa fa-check"></i><b>9.2</b> 非参数回归</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>10</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bootstrap.html"><a href="bootstrap.html#percentile-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>10.1</b> Percentile Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="10.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-tests-of-hypotheses"><i class="fa fa-check"></i><b>10.2</b> Bootstrap Tests of Hypotheses</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="bootstrap.html"><a href="bootstrap.html#nursery-school-intervention"><i class="fa fa-check"></i><b>10.2.1</b> Nursery School Intervention</a></li>
<li class="chapter" data-level="10.2.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-test-for-sample-mean"><i class="fa fa-check"></i><b>10.2.2</b> Bootstrap test for sample mean</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">非参数统计</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="多样本位置参数" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">第 4 章</span> 多样本位置参数<a href="多样本位置参数.html#多样本位置参数" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>单因素问题，独立样本</strong></p>
<div id="kruskal-wallis秩和检验" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> 4.1 Kruskal-Wallis秩和检验<a href="多样本位置参数.html#kruskal-wallis秩和检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>类比于单因素方差分析</li>
<li>不依赖于正态假设和方差齐性假设</li>
<li>Wilcoxon秩和检验的推广</li>
</ul>
<div id="例训练方式" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> 例：训练方式<a href="多样本位置参数.html#例训练方式" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="多样本位置参数.html#cb172-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">75</span>, <span class="dv">62</span>, <span class="dv">76</span>, <span class="dv">73</span>, <span class="dv">98</span>, <span class="dv">86</span>)</span>
<span id="cb172-2"><a href="多样本位置参数.html#cb172-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">72</span>, <span class="dv">52</span>, <span class="dv">68</span>, <span class="dv">82</span>, <span class="dv">74</span>, <span class="dv">64</span>, <span class="dv">87</span>)</span>
<span id="cb172-3"><a href="多样本位置参数.html#cb172-3" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">61</span>, <span class="dv">85</span>, <span class="dv">78</span>, <span class="dv">66</span>, <span class="dv">70</span>, <span class="dv">59</span>, <span class="dv">69</span>, <span class="dv">79</span>)</span>
<span id="cb172-4"><a href="多样本位置参数.html#cb172-4" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">63</span>, <span class="dv">58</span>, <span class="dv">65</span>, <span class="dv">71</span>, <span class="dv">84</span>, <span class="dv">77</span>, <span class="dv">80</span>, <span class="dv">89</span>)</span>
<span id="cb172-5"><a href="多样本位置参数.html#cb172-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-6"><a href="多样本位置参数.html#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="do">##kruskal-wallis test</span></span>
<span id="cb172-7"><a href="多样本位置参数.html#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(<span class="fu">list</span>(A,B,C,D))</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  list(A, B, C, D)
## Kruskal-Wallis chi-squared = 0.55369, df = 3, p-value = 0.9069</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="多样本位置参数.html#cb174-1" aria-hidden="true" tabindex="-1"></a>KW.test<span class="ot">=</span><span class="cf">function</span>(<span class="at">m1=</span><span class="dv">5</span>,<span class="at">m2=</span><span class="dv">5</span>,<span class="at">m3=</span><span class="dv">4</span>,<span class="at">Hvalue=</span><span class="fl">9.4114</span>){</span>
<span id="cb174-2"><a href="多样本位置参数.html#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this program is for m1=5, m2=5, and m3 can be any integer</span></span>
<span id="cb174-3"><a href="多样本位置参数.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span>m1<span class="sc">+</span>m2<span class="sc">+</span>m3;</span>
<span id="cb174-4"><a href="多样本位置参数.html#cb174-4" aria-hidden="true" tabindex="-1"></a>  Jh5<span class="ot">=</span><span class="cf">function</span>(m){</span>
<span id="cb174-5"><a href="多样本位置参数.html#cb174-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb174-6"><a href="多样本位置参数.html#cb174-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(m<span class="dv">-4</span>)){</span>
<span id="cb174-7"><a href="多样本位置参数.html#cb174-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m<span class="dv">-3</span>)){</span>
<span id="cb174-8"><a href="多样本位置参数.html#cb174-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (k <span class="cf">in</span> (j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m<span class="dv">-2</span>)){</span>
<span id="cb174-9"><a href="多样本位置参数.html#cb174-9" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (l <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m<span class="dv">-1</span>)){</span>
<span id="cb174-10"><a href="多样本位置参数.html#cb174-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (f <span class="cf">in</span> (l<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m){a<span class="ot">&lt;-</span><span class="fu">rbind</span>(a,<span class="fu">c</span>(i,j,k,l,f))}</span>
<span id="cb174-11"><a href="多样本位置参数.html#cb174-11" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb174-12"><a href="多样本位置参数.html#cb174-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb174-13"><a href="多样本位置参数.html#cb174-13" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb174-14"><a href="多样本位置参数.html#cb174-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb174-15"><a href="多样本位置参数.html#cb174-15" aria-hidden="true" tabindex="-1"></a>    a[<span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(a),]</span>
<span id="cb174-16"><a href="多样本位置参数.html#cb174-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb174-17"><a href="多样本位置参数.html#cb174-17" aria-hidden="true" tabindex="-1"></a>  JTid1<span class="ot">&lt;-</span><span class="fu">Jh5</span>(m1<span class="sc">+</span>m2<span class="sc">+</span>m3);</span>
<span id="cb174-18"><a href="多样本位置参数.html#cb174-18" aria-hidden="true" tabindex="-1"></a>  n1<span class="ot">&lt;-</span><span class="fu">nrow</span>(JTid1);</span>
<span id="cb174-19"><a href="多样本位置参数.html#cb174-19" aria-hidden="true" tabindex="-1"></a>  JTid2<span class="ot">&lt;-</span><span class="fu">Jh5</span>(m2<span class="sc">+</span>m3);</span>
<span id="cb174-20"><a href="多样本位置参数.html#cb174-20" aria-hidden="true" tabindex="-1"></a>  n2<span class="ot">&lt;-</span><span class="fu">nrow</span>(JTid2);</span>
<span id="cb174-21"><a href="多样本位置参数.html#cb174-21" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">&lt;-</span>n1<span class="sc">*</span>n2;</span>
<span id="cb174-22"><a href="多样本位置参数.html#cb174-22" aria-hidden="true" tabindex="-1"></a>  const<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span>m;</span>
<span id="cb174-23"><a href="多样本位置参数.html#cb174-23" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb174-24"><a href="多样本位置参数.html#cb174-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb174-25"><a href="多样本位置参数.html#cb174-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n2){</span>
<span id="cb174-26"><a href="多样本位置参数.html#cb174-26" aria-hidden="true" tabindex="-1"></a>      temp1<span class="ot">&lt;-</span><span class="fu">c</span>(JTid1[i,]);</span>
<span id="cb174-27"><a href="多样本位置参数.html#cb174-27" aria-hidden="true" tabindex="-1"></a>      temp2<span class="ot">&lt;-</span>(const[<span class="sc">-</span>temp1])[<span class="fu">c</span>(JTid2[j,])];</span>
<span id="cb174-28"><a href="多样本位置参数.html#cb174-28" aria-hidden="true" tabindex="-1"></a>      temp3<span class="ot">&lt;-</span>const[<span class="sc">-</span><span class="fu">c</span>(temp1,temp2)];</span>
<span id="cb174-29"><a href="多样本位置参数.html#cb174-29" aria-hidden="true" tabindex="-1"></a>      y<span class="ot">&lt;-</span><span class="fu">c</span>(y,<span class="dv">12</span><span class="sc">/</span>(m<span class="sc">*</span>(m<span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span>((<span class="fu">sum</span>(temp1))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m1<span class="sc">+</span>(<span class="fu">sum</span>(temp2))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m2<span class="sc">+</span>(<span class="fu">sum</span>(temp3))<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>m3)<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>(m<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb174-30"><a href="多样本位置参数.html#cb174-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb174-31"><a href="多样本位置参数.html#cb174-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb174-32"><a href="多样本位置参数.html#cb174-32" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>y[<span class="dv">2</span><span class="sc">:</span>(nn<span class="sc">+</span><span class="dv">1</span>)];</span>
<span id="cb174-33"><a href="多样本位置参数.html#cb174-33" aria-hidden="true" tabindex="-1"></a>  pvalue<span class="ot">&lt;-</span>(<span class="fu">sum</span>(y<span class="sc">&gt;=</span>Hvalue))<span class="sc">/</span>nn;</span>
<span id="cb174-34"><a href="多样本位置参数.html#cb174-34" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">sort</span>(y);aaa<span class="ot">&lt;-</span>aa<span class="ot">&lt;-</span>y[<span class="dv">1</span>];tempc<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb174-35"><a href="多样本位置参数.html#cb174-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nn){</span>
<span id="cb174-36"><a href="多样本位置参数.html#cb174-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>((y[i]<span class="sc">-</span>aa)<span class="sc">&gt;</span><span class="dv">10</span><span class="sc">^</span>{<span class="sc">-</span><span class="dv">12</span>}){</span>
<span id="cb174-37"><a href="多样本位置参数.html#cb174-37" aria-hidden="true" tabindex="-1"></a>      aaa<span class="ot">&lt;-</span><span class="fu">c</span>(aaa,y[i]);aa<span class="ot">&lt;-</span>y[i];tempc<span class="ot">&lt;-</span><span class="fu">c</span>(tempc,<span class="dv">1</span><span class="sc">-</span>(i<span class="dv">-1</span>)<span class="sc">/</span>nn)</span>
<span id="cb174-38"><a href="多样本位置参数.html#cb174-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb174-39"><a href="多样本位置参数.html#cb174-39" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb174-40"><a href="多样本位置参数.html#cb174-40" aria-hidden="true" tabindex="-1"></a>  out<span class="ot">&lt;-</span><span class="fu">cbind</span>(aaa,tempc);z<span class="ot">=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="fl">0.1</span>);</span>
<span id="cb174-41"><a href="多样本位置参数.html#cb174-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb174-42"><a href="多样本位置参数.html#cb174-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(y,<span class="at">main=</span><span class="st">&quot;(1) Kruskal-Wallis检验精确分布直方图&quot;</span>)</span>
<span id="cb174-43"><a href="多样本位置参数.html#cb174-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(z,<span class="fu">dchisq</span>(z,<span class="at">df=</span><span class="dv">2</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">main=</span><span class="st">&quot;(2) 自由度为2的chisq分布密度函数&quot;</span>)</span>
<span id="cb174-44"><a href="多样本位置参数.html#cb174-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;(m1,m2,m3)&quot;</span><span class="ot">=</span><span class="fu">c</span>(m1,m2,m3),<span class="st">&quot;H&quot;</span><span class="ot">=</span>Hvalue,<span class="st">&quot;pval&quot;</span><span class="ot">=</span>pvalue),out)</span>
<span id="cb174-45"><a href="多样本位置参数.html#cb174-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb174-46"><a href="多样本位置参数.html#cb174-46" aria-hidden="true" tabindex="-1"></a><span class="fu">KW.test</span>() <span class="do">##time-consuming</span></span></code></pre></div>
<p><img src="04_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre><code>## [[1]]
## (m1,m2,m3)1 (m1,m2,m3)2 (m1,m2,m3)3           H        pval 
## 5.000000000 5.000000000 4.000000000 9.411400000 0.001347858 
## 
## [[2]]
##                 aaa        tempc
##   [1,]  0.005714286 1.000000e+00
##   [2,]  0.020000000 9.938078e-01
##   [3,]  0.042857143 9.878772e-01
##   [4,]  0.051428571 9.759843e-01
##   [5,]  0.085714286 9.698635e-01
##   [6,]  0.111428571 9.578755e-01
##   [7,]  0.131428571 9.462680e-01
##   [8,]  0.142857143 9.345179e-01
##   [9,]  0.180000000 9.286269e-01
##  [10,]  0.202857143 9.230928e-01
##  [11,]  0.222857143 9.121038e-01
##  [12,]  0.225714286 9.008135e-01
##  [13,]  0.271428571 8.897769e-01
##  [14,]  0.280000000 8.791050e-01
##  [15,]  0.325714286 8.736026e-01
##  [16,]  0.360000000 8.625501e-01
##  [17,]  0.371428571 8.517197e-01
##  [18,]  0.385714286 8.411430e-01
##  [19,]  0.462857143 8.205287e-01
##  [20,]  0.500000000 8.050917e-01
##  [21,]  0.522857143 8.002553e-01
##  [22,]  0.542857143 7.904873e-01
##  [23,]  0.545714286 7.806559e-01
##  [24,]  0.591428571 7.711098e-01
##  [25,]  0.600000000 7.520971e-01
##  [26,]  0.691428571 7.424084e-01
##  [27,]  0.705714286 7.377147e-01
##  [28,]  0.725714286 7.287237e-01
##  [29,]  0.751428571 7.195582e-01
##  [30,]  0.771428571 7.107734e-01
##  [31,]  0.782857143 6.926962e-01
##  [32,]  0.842857143 6.836576e-01
##  [33,]  0.862857143 6.751423e-01
##  [34,]  0.865714286 6.665160e-01
##  [35,]  0.965714286 6.580483e-01
##  [36,]  0.980000000 6.537907e-01
##  [37,]  1.000000000 6.497946e-01
##  [38,]  1.002857143 6.416916e-01
##  [39,]  1.011428571 6.256125e-01
##  [40,]  1.045714286 6.174778e-01
##  [41,]  1.071428571 6.095175e-01
##  [42,]  1.140000000 5.940250e-01
##  [43,]  1.182857143 5.865880e-01
##  [44,]  1.185714286 5.790083e-01
##  [45,]  1.285714286 5.716189e-01
##  [46,]  1.300000000 5.533673e-01
##  [47,]  1.322857143 5.465011e-01
##  [48,]  1.331428571 5.395557e-01
##  [49,]  1.345714286 5.322614e-01
##  [50,]  1.365714286 5.253477e-01
##  [51,]  1.411428571 5.183388e-01
##  [52,]  1.422857143 5.115202e-01
##  [53,]  1.482857143 5.045272e-01
##  [54,]  1.551428571 4.979941e-01
##  [55,]  1.560000000 4.916829e-01
##  [56,]  1.605714286 4.851498e-01
##  [57,]  1.620000000 4.788386e-01
##  [58,]  1.642857143 4.697683e-01
##  [59,]  1.651428571 4.578279e-01
##  [60,]  1.685714286 4.547833e-01
##  [61,]  1.711428571 4.487734e-01
##  [62,]  1.731428571 4.428587e-01
##  [63,]  1.742857143 4.368964e-01
##  [64,]  1.802857143 4.308707e-01
##  [65,]  1.825714286 4.252097e-01
##  [66,]  1.871428571 4.196121e-01
##  [67,]  1.962857143 4.142207e-01
##  [68,]  1.971428571 4.089561e-01
##  [69,]  1.985714286 3.979988e-01
##  [70,]  2.005714286 3.928135e-01
##  [71,]  2.031428571 3.820307e-01
##  [72,]  2.051428571 3.769088e-01
##  [73,]  2.062857143 3.715649e-01
##  [74,]  2.100000000 3.690119e-01
##  [75,]  2.142857143 3.640328e-01
##  [76,]  2.191428571 3.538684e-01
##  [77,]  2.245714286 3.491588e-01
##  [78,]  2.280000000 3.441955e-01
##  [79,]  2.305714286 3.393908e-01
##  [80,]  2.351428571 3.348715e-01
##  [81,]  2.371428571 3.304949e-01
##  [82,]  2.382857143 3.260549e-01
##  [83,]  2.420000000 3.216149e-01
##  [84,]  2.442857143 3.194900e-01
##  [85,]  2.462857143 3.066616e-01
##  [86,]  2.465714286 3.021899e-01
##  [87,]  2.511428571 2.981146e-01
##  [88,]  2.520000000 2.940234e-01
##  [89,]  2.565714286 2.918906e-01
##  [90,]  2.600000000 2.876885e-01
##  [91,]  2.625714286 2.837242e-01
##  [92,]  2.691428571 2.797441e-01
##  [93,]  2.740000000 2.756846e-01
##  [94,]  2.782857143 2.720216e-01
##  [95,]  2.785714286 2.682793e-01
##  [96,]  2.831428571 2.573696e-01
##  [97,]  2.840000000 2.537225e-01
##  [98,]  2.885714286 2.500436e-01
##  [99,]  2.931428571 2.463965e-01
## [100,]  2.945714286 2.392607e-01
## [101,]  2.965714286 2.358832e-01
## [102,]  2.991428571 2.324104e-01
## [103,]  3.022857143 2.290804e-01
## [104,]  3.082857143 2.240775e-01
## [105,]  3.102857143 2.209378e-01
## [106,]  3.160000000 2.177029e-01
## [107,]  3.240000000 2.145632e-01
## [108,]  3.242857143 2.114869e-01
## [109,]  3.265714286 2.085534e-01
## [110,]  3.285714286 2.026862e-01
## [111,]  3.311428571 1.996892e-01
## [112,]  3.342857143 1.968666e-01
## [113,]  3.380000000 1.880659e-01
## [114,]  3.402857143 1.867180e-01
## [115,]  3.471428571 1.840540e-01
## [116,]  3.540000000 1.761889e-01
## [117,]  3.571428571 1.736359e-01
## [118,]  3.585714286 1.697747e-01
## [119,]  3.651428571 1.673485e-01
## [120,]  3.742857143 1.623535e-01
## [121,]  3.745714286 1.599432e-01
## [122,]  3.791428571 1.553447e-01
## [123,]  3.800000000 1.530295e-01
## [124,]  3.845714286 1.506351e-01
## [125,]  3.882857143 1.483358e-01
## [126,]  3.891428571 1.439592e-01
## [127,]  3.905714286 1.416441e-01
## [128,]  3.925714286 1.395192e-01
## [129,]  3.951428571 1.372834e-01
## [130,]  3.971428571 1.352536e-01
## [131,]  4.042857143 1.330653e-01
## [132,]  4.062857143 1.310991e-01
## [133,]  4.165714286 1.269762e-01
## [134,]  4.200000000 1.240506e-01
## [135,]  4.202857143 1.221001e-01
## [136,]  4.245714286 1.202607e-01
## [137,]  4.271428571 1.184054e-01
## [138,]  4.291428571 1.148851e-01
## [139,]  4.302857143 1.131725e-01
## [140,]  4.362857143 1.114124e-01
## [141,]  4.382857143 1.097474e-01
## [142,]  4.385714286 1.079873e-01
## [143,]  4.485714286 1.063698e-01
## [144,]  4.500000000 1.048000e-01
## [145,]  4.520000000 1.009308e-01
## [146,]  4.522857143 9.934510e-02
## [147,]  4.531428571 9.785453e-02
## [148,]  4.591428571 9.617367e-02
## [149,]  4.611428571 9.473067e-02
## [150,]  4.660000000 9.311324e-02
## [151,]  4.705714286 9.171781e-02
## [152,]  4.805714286 8.894280e-02
## [153,]  4.842857143 8.824509e-02
## [154,]  4.851428571 8.558109e-02
## [155,]  4.865714286 8.418566e-02
## [156,]  4.885714286 8.293294e-02
## [157,]  4.911428571 7.893694e-02
## [158,]  4.942857143 7.765251e-02
## [159,]  4.980000000 7.636808e-02
## [160,]  5.022857143 7.511536e-02
## [161,]  5.071428571 7.383093e-02
## [162,]  5.125714286 7.267336e-02
## [163,]  5.162857143 7.019964e-02
## [164,]  5.171428571 6.910550e-02
## [165,]  5.185714286 6.785278e-02
## [166,]  5.205714286 6.672692e-02
## [167,]  5.231428571 6.552178e-02
## [168,]  5.262857143 6.445935e-02
## [169,]  5.322857143 6.327006e-02
## [170,]  5.400000000 6.122449e-02
## [171,]  5.445714286 5.905206e-02
## [172,]  5.460000000 5.806892e-02
## [173,]  5.482857143 5.714920e-02
## [174,]  5.491428571 5.621363e-02
## [175,]  5.525714286 5.576170e-02
## [176,]  5.571428571 5.485784e-02
## [177,]  5.582857143 5.205112e-02
## [178,]  5.620000000 5.102041e-02
## [179,]  5.642857143 5.016412e-02
## [180,]  5.665714286 4.930784e-02
## [181,]  5.711428571 4.845155e-02
## [182,]  5.780000000 4.761112e-02
## [183,]  5.802857143 4.721469e-02
## [184,]  5.811428571 4.642183e-02
## [185,]  5.871428571 4.472512e-02
## [186,]  5.902857143 4.321869e-02
## [187,]  5.962857143 4.240997e-02
## [188,]  5.982857143 4.172811e-02
## [189,]  5.985714286 4.093526e-02
## [190,]  6.031428571 4.022168e-02
## [191,]  6.085714286 3.950811e-02
## [192,]  6.100000000 3.796997e-02
## [193,]  6.122857143 3.728811e-02
## [194,]  6.145714286 3.660625e-02
## [195,]  6.165714286 3.527425e-02
## [196,]  6.211428571 3.457653e-02
## [197,]  6.222857143 3.387882e-02
## [198,]  6.282857143 3.354582e-02
## [199,]  6.302857143 3.291153e-02
## [200,]  6.351428571 3.229310e-02
## [201,]  6.405714286 3.053296e-02
## [202,]  6.440000000 2.988282e-02
## [203,]  6.451428571 2.926439e-02
## [204,]  6.485714286 2.864596e-02
## [205,]  6.531428571 2.809096e-02
## [206,]  6.542857143 2.753596e-02
## [207,]  6.602857143 2.696510e-02
## [208,]  6.622857143 2.644181e-02
## [209,]  6.625714286 2.593438e-02
## [210,]  6.671428571 2.542695e-02
## [211,]  6.760000000 2.490367e-02
## [212,]  6.762857143 2.442795e-02
## [213,]  6.771428571 2.398395e-02
## [214,]  6.785714286 2.300081e-02
## [215,]  6.805714286 2.209695e-02
## [216,]  6.831428571 2.165295e-02
## [217,]  6.900000000 2.122481e-02
## [218,]  6.942857143 2.040023e-02
## [219,]  7.000000000 1.909995e-02
## [220,]  7.045714286 1.888588e-02
## [221,]  7.080000000 1.847359e-02
## [222,]  7.105714286 1.806130e-02
## [223,]  7.171428571 1.769659e-02
## [224,]  7.182857143 1.733187e-02
## [225,]  7.220000000 1.690373e-02
## [226,]  7.242857143 1.676102e-02
## [227,]  7.265714286 1.577787e-02
## [228,]  7.311428571 1.542902e-02
## [229,]  7.320000000 1.515944e-02
## [230,]  7.425714286 1.484230e-02
## [231,]  7.445714286 1.423973e-02
## [232,]  7.471428571 1.393844e-02
## [233,]  7.491428571 1.363716e-02
## [234,]  7.502857143 1.301873e-02
## [235,]  7.562857143 1.268573e-02
## [236,]  7.585714286 1.238444e-02
## [237,]  7.631428571 1.160744e-02
## [238,]  7.640000000 1.133787e-02
## [239,]  7.685714286 1.102073e-02
## [240,]  7.720000000 1.073530e-02
## [241,]  7.765714286 1.046572e-02
## [242,]  7.791428571 1.021201e-02
## [243,]  7.822857143 9.783867e-03
## [244,]  7.860000000 9.649081e-03
## [245,]  7.902857143 9.411224e-03
## [246,]  7.905714286 9.189223e-03
## [247,]  8.005714286 8.967223e-03
## [248,]  8.042857143 8.650080e-03
## [249,]  8.051428571 8.491508e-03
## [250,]  8.065714286 8.190222e-03
## [251,]  8.085714286 7.984079e-03
## [252,]  8.131428571 7.762079e-03
## [253,]  8.142857143 7.571793e-03
## [254,]  8.222857143 6.874078e-03
## [255,]  8.225714286 6.699650e-03
## [256,]  8.271428571 6.541078e-03
## [257,]  8.280000000 6.208078e-03
## [258,]  8.340000000 5.779934e-03
## [259,]  8.362857143 5.637220e-03
## [260,]  8.371428571 5.478648e-03
## [261,]  8.385714286 5.320077e-03
## [262,]  8.431428571 5.177362e-03
## [263,]  8.462857143 5.018791e-03
## [264,]  8.522857143 4.796791e-03
## [265,]  8.542857143 4.669933e-03
## [266,]  8.545714286 4.400362e-03
## [267,]  8.682857143 4.273504e-03
## [268,]  8.691428571 4.178361e-03
## [269,]  8.725714286 3.805718e-03
## [270,]  8.751428571 3.678861e-03
## [271,]  8.771428571 3.567861e-03
## [272,]  8.965714286 3.441003e-03
## [273,]  8.980000000 3.298289e-03
## [274,]  9.000000000 3.219003e-03
## [275,]  9.011428571 2.933574e-03
## [276,]  9.025714286 2.838431e-03
## [277,]  9.071428571 2.489574e-03
## [278,]  9.102857143 2.315145e-03
## [279,]  9.162857143 1.966288e-03
## [280,]  9.231428571 1.887002e-03
## [281,]  9.285714286 1.601573e-03
## [282,]  9.322857143 1.411287e-03
## [283,]  9.411428571 1.347858e-03
## [284,]  9.502857143 1.094144e-03
## [285,]  9.505714286 1.030715e-03
## [286,]  9.605714286 9.831438e-04
## [287,]  9.642857143 9.514295e-04
## [288,]  9.651428571 7.135721e-04
## [289,]  9.685714286 6.342863e-04
## [290,]  9.925714286 5.867149e-04
## [291,]  9.985714286 4.281433e-04
## [292,] 10.051428571 3.964290e-04
## [293,] 10.062857143 3.647147e-04
## [294,] 10.100000000 3.171432e-04
## [295,] 10.260000000 2.854289e-04
## [296,] 10.511428571 1.902859e-04
## [297,] 10.520000000 1.744287e-04
## [298,] 10.565714286 1.427144e-04
## [299,] 10.645714286 1.347858e-04
## [300,] 11.022857143 7.135721e-05
## [301,] 11.082857143 5.550006e-05
## [302,] 11.571428571 2.378574e-05</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="多样本位置参数.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#[[1]]</span></span>
<span id="cb176-2"><a href="多样本位置参数.html#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="co">#(m1,m2,m3)1 (m1,m2,m3)2 (m1,m2,m3)3           H        pval </span></span>
<span id="cb176-3"><a href="多样本位置参数.html#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="co">#5.000000000 5.000000000 4.000000000 9.411400000 0.001347858 </span></span></code></pre></div>
</div>
<div id="大样本近似-2" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> 大样本近似<a href="多样本位置参数.html#大样本近似-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="多样本位置参数.html#cb177-1" aria-hidden="true" tabindex="-1"></a>wtloss <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/wtloss.txt&quot;</span>)</span>
<span id="cb177-2"><a href="多样本位置参数.html#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(wtloss[,<span class="dv">1</span>],wtloss[,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  wtloss[, 1] and wtloss[, 2]
## Kruskal-Wallis chi-squared = 9.4322, df = 2, p-value = 0.00895</code></pre>
</div>
</div>
<div id="正态记分检验" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> 4.2 正态记分检验<a href="多样本位置参数.html#正态记分检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>单样本、双样本正态记分检验的推广</li>
</ul>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="多样本位置参数.html#cb179-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span>wtloss[<span class="fu">order</span>(wtloss[,<span class="dv">1</span>]),]</span>
<span id="cb179-2"><a href="多样本位置参数.html#cb179-2" aria-hidden="true" tabindex="-1"></a>n1<span class="ot">=</span><span class="fu">sum</span>(d[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb179-3"><a href="多样本位置参数.html#cb179-3" aria-hidden="true" tabindex="-1"></a>n2<span class="ot">=</span><span class="fu">sum</span>(d[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">2</span>)</span>
<span id="cb179-4"><a href="多样本位置参数.html#cb179-4" aria-hidden="true" tabindex="-1"></a>n3<span class="ot">=</span><span class="fu">sum</span>(d[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">3</span>)</span>
<span id="cb179-5"><a href="多样本位置参数.html#cb179-5" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(d)</span>
<span id="cb179-6"><a href="多样本位置参数.html#cb179-6" aria-hidden="true" tabindex="-1"></a>r<span class="ot">=</span><span class="fu">rank</span>(d[,<span class="dv">1</span>])</span>
<span id="cb179-7"><a href="多样本位置参数.html#cb179-7" aria-hidden="true" tabindex="-1"></a>w<span class="ot">=</span><span class="fu">qnorm</span>(r<span class="sc">/</span>(n<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb179-8"><a href="多样本位置参数.html#cb179-8" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">cbind</span>(d,r,w)</span>
<span id="cb179-9"><a href="多样本位置参数.html#cb179-9" aria-hidden="true" tabindex="-1"></a>nn<span class="ot">=</span><span class="fu">sum</span>(<span class="fu">sum</span>(w[z[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n1,<span class="fu">sum</span>(w[z[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">2</span>])<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n2,<span class="fu">sum</span>(w[z[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">3</span>])<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n3)</span>
<span id="cb179-10"><a href="多样本位置参数.html#cb179-10" aria-hidden="true" tabindex="-1"></a>(<span class="at">Tstat=</span>(n<span class="dv">-1</span>)<span class="sc">*</span>nn<span class="sc">/</span><span class="fu">sum</span>(w<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 9.078947</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="多样本位置参数.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(Tstat,<span class="dv">3-1</span>,<span class="at">low=</span>F)</span></code></pre></div>
<pre><code>## [1] 0.01067903</code></pre>
</div>
<div id="jonckheere-terpstra检验" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> 4.3 Jonckheere-Terpstra检验<a href="多样本位置参数.html#jonckheere-terpstra检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>单边（有序）的备择假设</li>
<li>注意与Cox-Stuart趋势检验的区分</li>
</ul>
<div id="精确检验-2" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> 精确检验<a href="多样本位置参数.html#精确检验-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="多样本位置参数.html#cb183-1" aria-hidden="true" tabindex="-1"></a>JT.test<span class="ot">=</span><span class="cf">function</span>(<span class="at">m1=</span><span class="dv">5</span>,<span class="at">m2=</span><span class="dv">5</span>,<span class="at">m3=</span><span class="dv">4</span>,<span class="at">JTvalue=</span><span class="dv">59</span>){</span>
<span id="cb183-2"><a href="多样本位置参数.html#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this program is for m1=5, m2=5, and m3 can be any integer</span></span>
<span id="cb183-3"><a href="多样本位置参数.html#cb183-3" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span>m1<span class="sc">+</span>m2<span class="sc">+</span>m3;</span>
<span id="cb183-4"><a href="多样本位置参数.html#cb183-4" aria-hidden="true" tabindex="-1"></a>  Jh5<span class="ot">=</span><span class="cf">function</span>(m){</span>
<span id="cb183-5"><a href="多样本位置参数.html#cb183-5" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb183-6"><a href="多样本位置参数.html#cb183-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(m<span class="dv">-4</span>)){</span>
<span id="cb183-7"><a href="多样本位置参数.html#cb183-7" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m<span class="dv">-3</span>)){</span>
<span id="cb183-8"><a href="多样本位置参数.html#cb183-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (k <span class="cf">in</span> (j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m<span class="dv">-2</span>)){</span>
<span id="cb183-9"><a href="多样本位置参数.html#cb183-9" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> (l <span class="cf">in</span> (k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(m<span class="dv">-1</span>)){</span>
<span id="cb183-10"><a href="多样本位置参数.html#cb183-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (f <span class="cf">in</span> (l<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m){a<span class="ot">&lt;-</span><span class="fu">rbind</span>(a,<span class="fu">c</span>(i,j,k,l,f))}</span>
<span id="cb183-11"><a href="多样本位置参数.html#cb183-11" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb183-12"><a href="多样本位置参数.html#cb183-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb183-13"><a href="多样本位置参数.html#cb183-13" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb183-14"><a href="多样本位置参数.html#cb183-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb183-15"><a href="多样本位置参数.html#cb183-15" aria-hidden="true" tabindex="-1"></a>    a[<span class="dv">2</span><span class="sc">:</span><span class="fu">nrow</span>(a),]</span>
<span id="cb183-16"><a href="多样本位置参数.html#cb183-16" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb183-17"><a href="多样本位置参数.html#cb183-17" aria-hidden="true" tabindex="-1"></a>  JTid1<span class="ot">=</span><span class="fu">Jh5</span>(m1<span class="sc">+</span>m2<span class="sc">+</span>m3);n1<span class="ot">=</span><span class="fu">nrow</span>(JTid1)</span>
<span id="cb183-18"><a href="多样本位置参数.html#cb183-18" aria-hidden="true" tabindex="-1"></a>  JTid2<span class="ot">=</span><span class="fu">Jh5</span>(m2<span class="sc">+</span>m3);n2<span class="ot">=</span><span class="fu">nrow</span>(JTid2);</span>
<span id="cb183-19"><a href="多样本位置参数.html#cb183-19" aria-hidden="true" tabindex="-1"></a>  const<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span>m;</span>
<span id="cb183-20"><a href="多样本位置参数.html#cb183-20" aria-hidden="true" tabindex="-1"></a>  JT<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,n1<span class="sc">*</span>n2)</span>
<span id="cb183-21"><a href="多样本位置参数.html#cb183-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb183-22"><a href="多样本位置参数.html#cb183-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n2){</span>
<span id="cb183-23"><a href="多样本位置参数.html#cb183-23" aria-hidden="true" tabindex="-1"></a>      temp1<span class="ot">&lt;-</span><span class="fu">c</span>(JTid1[i,]);</span>
<span id="cb183-24"><a href="多样本位置参数.html#cb183-24" aria-hidden="true" tabindex="-1"></a>      temp2<span class="ot">=</span>(const[<span class="sc">-</span>temp1])[<span class="fu">c</span>(JTid2[j,])];</span>
<span id="cb183-25"><a href="多样本位置参数.html#cb183-25" aria-hidden="true" tabindex="-1"></a>      temp3<span class="ot">=</span>const[<span class="sc">-</span><span class="fu">c</span>(temp1,temp2)];</span>
<span id="cb183-26"><a href="多样本位置参数.html#cb183-26" aria-hidden="true" tabindex="-1"></a>      JT[j<span class="sc">+</span>(i<span class="dv">-1</span>)<span class="sc">*</span>n2]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">outer</span>(temp2,temp1,<span class="st">&quot;&gt;&quot;</span>))<span class="sc">+</span></span>
<span id="cb183-27"><a href="多样本位置参数.html#cb183-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sum</span>(<span class="fu">outer</span>(temp3,temp1,<span class="st">&quot;&gt;&quot;</span>))<span class="sc">+</span><span class="fu">sum</span>(<span class="fu">outer</span>(temp3,temp2,<span class="st">&quot;&gt;&quot;</span>))</span>
<span id="cb183-28"><a href="多样本位置参数.html#cb183-28" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb183-29"><a href="多样本位置参数.html#cb183-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb183-30"><a href="多样本位置参数.html#cb183-30" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span>JT;</span>
<span id="cb183-31"><a href="多样本位置参数.html#cb183-31" aria-hidden="true" tabindex="-1"></a>  pval<span class="ot">=</span>(<span class="fu">sum</span>(y<span class="sc">&gt;=</span>JTvalue))<span class="sc">/</span>(n1<span class="sc">*</span>n2);<span class="fu">hist</span>(y,<span class="at">breaks=</span><span class="fu">min</span>(y)<span class="sc">:</span><span class="fu">max</span>(y))</span>
<span id="cb183-32"><a href="多样本位置参数.html#cb183-32" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">hist</span>(y,<span class="at">breaks=</span><span class="fu">min</span>(y)<span class="sc">:</span><span class="fu">max</span>(y))<span class="sc">$</span>counts)</span>
<span id="cb183-33"><a href="多样本位置参数.html#cb183-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;(m1,m2,m3)&quot;</span><span class="ot">=</span><span class="fu">c</span>(m1,m2,m3),<span class="fu">c</span>(JTvalue,pval),</span>
<span id="cb183-34"><a href="多样本位置参数.html#cb183-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">min</span>(y)<span class="sc">:</span><span class="fu">max</span>(y),z,<span class="fu">rev</span>(<span class="fu">cumsum</span>(<span class="fu">rev</span>(z)))<span class="sc">/</span>(n1<span class="sc">*</span>n2)))}</span>
<span id="cb183-35"><a href="多样本位置参数.html#cb183-35" aria-hidden="true" tabindex="-1"></a><span class="fu">JT.test</span>()</span></code></pre></div>
<p><img src="04_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre><code>## $`(m1,m2,m3)`
## [1] 5 5 4
## 
## [[2]]
## [1] 5.900000e+01 5.272505e-04
## 
## [[3]]
##              z             
##  [1,]  0     0 1.000000e+00
##  [2,]  1     3 1.000000e+00
##  [3,]  2     5 9.999881e-01
##  [4,]  3    10 9.999683e-01
##  [5,]  4    20 9.999286e-01
##  [6,]  5    35 9.998494e-01
##  [7,]  6    60 9.997106e-01
##  [8,]  7    96 9.994727e-01
##  [9,]  8   151 9.990922e-01
## [10,]  9   226 9.984936e-01
## [11,] 10   331 9.975976e-01
## [12,] 11   468 9.962855e-01
## [13,] 12   650 9.944302e-01
## [14,] 13   877 9.918534e-01
## [15,] 14  1162 9.883767e-01
## [16,] 15  1505 9.837702e-01
## [17,] 16  1917 9.778039e-01
## [18,] 17  2393 9.702044e-01
## [19,] 18  2941 9.607179e-01
## [20,] 19  3551 9.490589e-01
## [21,] 20  4226 9.349817e-01
## [22,] 21  4948 9.182286e-01
## [23,] 22  5713 8.986133e-01
## [24,] 23  6499 8.759653e-01
## [25,] 24  7296 8.502014e-01
## [26,] 25  8076 8.212779e-01
## [27,] 26  8824 7.892623e-01
## [28,] 27  9514 7.542814e-01
## [29,] 28 10130 7.165652e-01
## [30,] 29 10647 6.764069e-01
## [31,] 30 11052 6.341991e-01
## [32,] 31 11329 5.903858e-01
## [33,] 32 11471 5.454744e-01
## [34,] 33 11471 5.000000e-01
## [35,] 34 11329 4.545256e-01
## [36,] 35 11052 4.096142e-01
## [37,] 36 10647 3.658009e-01
## [38,] 37 10130 3.235931e-01
## [39,] 38  9514 2.834348e-01
## [40,] 39  8824 2.457186e-01
## [41,] 40  8076 2.107377e-01
## [42,] 41  7296 1.787221e-01
## [43,] 42  6499 1.497986e-01
## [44,] 43  5713 1.240347e-01
## [45,] 44  4948 1.013867e-01
## [46,] 45  4226 8.177140e-02
## [47,] 46  3551 6.501832e-02
## [48,] 47  2941 5.094112e-02
## [49,] 48  2393 3.928215e-02
## [50,] 49  1917 2.979560e-02
## [51,] 50  1505 2.219606e-02
## [52,] 51  1162 1.622980e-02
## [53,] 52   877 1.162330e-02
## [54,] 53   650 8.146615e-03
## [55,] 54   468 5.569827e-03
## [56,] 55   331 3.714539e-03
## [57,] 56   226 2.402360e-03
## [58,] 57   151 1.506430e-03
## [59,] 58    96 9.078223e-04
## [60,] 59    60 5.272505e-04
## [61,] 60    35 2.893931e-04
## [62,] 61    20 1.506430e-04
## [63,] 62    10 7.135721e-05
## [64,] 63     5 3.171432e-05
## [65,] 64     2 1.189287e-05
## [66,] 65     1 3.964290e-06</code></pre>
</div>
<div id="大样本近似-3" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> 大样本近似<a href="多样本位置参数.html#大样本近似-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="多样本位置参数.html#cb185-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/wtloss.txt&quot;</span>)</span>
<span id="cb185-2"><a href="多样本位置参数.html#cb185-2" aria-hidden="true" tabindex="-1"></a>U<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">3</span>);k<span class="ot">=</span><span class="fu">max</span>(d[,<span class="dv">2</span>]);</span>
<span id="cb185-3"><a href="多样本位置参数.html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(k<span class="dv">-1</span>)){</span>
<span id="cb185-4"><a href="多样本位置参数.html#cb185-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>k){</span>
<span id="cb185-5"><a href="多样本位置参数.html#cb185-5" aria-hidden="true" tabindex="-1"></a>    U[i,j]<span class="ot">=</span><span class="fu">sum</span>(<span class="fu">outer</span>(d[d[,<span class="dv">2</span>]<span class="sc">==</span>i,<span class="dv">1</span>],d[d[,<span class="dv">2</span>]<span class="sc">==</span>j,<span class="dv">1</span>],<span class="st">&quot;-&quot;</span>)<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">+</span><span class="fu">sum</span>(<span class="fu">outer</span>(d[d[,<span class="dv">2</span>]<span class="sc">==</span>i,<span class="dv">1</span>],d[d[,<span class="dv">2</span>]<span class="sc">==</span>j,<span class="dv">1</span>],<span class="st">&quot;-&quot;</span>)<span class="sc">==</span><span class="dv">0</span>)<span class="sc">/</span><span class="dv">2</span>;</span>
<span id="cb185-6"><a href="多样本位置参数.html#cb185-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb185-7"><a href="多样本位置参数.html#cb185-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb185-8"><a href="多样本位置参数.html#cb185-8" aria-hidden="true" tabindex="-1"></a>J<span class="ot">=</span><span class="fu">sum</span>(U);</span>
<span id="cb185-9"><a href="多样本位置参数.html#cb185-9" aria-hidden="true" tabindex="-1"></a>ni<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb185-10"><a href="多样本位置参数.html#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) ni<span class="ot">=</span><span class="fu">c</span>(ni,<span class="fu">sum</span>(d[,<span class="dv">2</span>]<span class="sc">==</span>i));</span>
<span id="cb185-11"><a href="多样本位置参数.html#cb185-11" aria-hidden="true" tabindex="-1"></a>N<span class="ot">=</span><span class="fu">sum</span>(ni);</span>
<span id="cb185-12"><a href="多样本位置参数.html#cb185-12" aria-hidden="true" tabindex="-1"></a>Z<span class="ot">=</span>(J<span class="sc">-</span>(N<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span><span class="fu">sum</span>(ni<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span><span class="dv">4</span>)<span class="sc">/</span><span class="fu">sqrt</span>((N<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>N<span class="sc">+</span><span class="dv">3</span>)<span class="sc">-</span><span class="fu">sum</span>(ni<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>ni<span class="sc">+</span><span class="dv">3</span>)))<span class="sc">/</span><span class="dv">72</span>);</span>
<span id="cb185-13"><a href="多样本位置参数.html#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(Z,<span class="at">low=</span>F)</span></code></pre></div>
<pre><code>## [1] 0.0009566765</code></pre>
<p><strong>双因素问题</strong></p>
</div>
</div>
<div id="完全区组设计friedman秩和检验" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> 4.5 完全区组设计：Friedman秩和检验<a href="多样本位置参数.html#完全区组设计friedman秩和检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>类比于Randomized Block Design</li>
<li>Y是连续的</li>
<li>不依赖于正态假设和方差齐性假设</li>
</ul>
<div id="精确检验-3" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> 精确检验<a href="多样本位置参数.html#精确检验-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="多样本位置参数.html#cb187-1" aria-hidden="true" tabindex="-1"></a>Friedman<span class="ot">=</span><span class="cf">function</span>(<span class="at">k=</span><span class="dv">3</span>,<span class="at">b=</span><span class="dv">4</span>,<span class="at">W0=</span><span class="fl">0.8125</span>){</span>
<span id="cb187-2"><a href="多样本位置参数.html#cb187-2" aria-hidden="true" tabindex="-1"></a>  perm<span class="ot">=</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">4</span>){</span>
<span id="cb187-3"><a href="多样本位置参数.html#cb187-3" aria-hidden="true" tabindex="-1"></a>    A<span class="ot">=</span><span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>));</span>
<span id="cb187-4"><a href="多样本位置参数.html#cb187-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n<span class="sc">&gt;=</span><span class="dv">3</span>){</span>
<span id="cb187-5"><a href="多样本位置参数.html#cb187-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n){</span>
<span id="cb187-6"><a href="多样本位置参数.html#cb187-6" aria-hidden="true" tabindex="-1"></a>        temp<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">rep</span>(i,<span class="fu">nrow</span>(A)),A);</span>
<span id="cb187-7"><a href="多样本位置参数.html#cb187-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-2</span>))){</span>
<span id="cb187-8"><a href="多样本位置参数.html#cb187-8" aria-hidden="true" tabindex="-1"></a>          temp<span class="ot">=</span><span class="fu">rbind</span>(temp,<span class="fu">cbind</span>(A[,<span class="dv">1</span><span class="sc">:</span>j],<span class="fu">rep</span>(i,<span class="fu">nrow</span>(A)),A[,(j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="dv">-1</span>)]))</span>
<span id="cb187-9"><a href="多样本位置参数.html#cb187-9" aria-hidden="true" tabindex="-1"></a>        };</span>
<span id="cb187-10"><a href="多样本位置参数.html#cb187-10" aria-hidden="true" tabindex="-1"></a>        temp<span class="ot">=</span><span class="fu">rbind</span>(temp,<span class="fu">cbind</span>(A,<span class="fu">rep</span>(i,<span class="fu">nrow</span>(A))));A<span class="ot">=</span>temp</span>
<span id="cb187-11"><a href="多样本位置参数.html#cb187-11" aria-hidden="true" tabindex="-1"></a>      };</span>
<span id="cb187-12"><a href="多样本位置参数.html#cb187-12" aria-hidden="true" tabindex="-1"></a>    };</span>
<span id="cb187-13"><a href="多样本位置参数.html#cb187-13" aria-hidden="true" tabindex="-1"></a>    A</span>
<span id="cb187-14"><a href="多样本位置参数.html#cb187-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb187-15"><a href="多样本位置参数.html#cb187-15" aria-hidden="true" tabindex="-1"></a>  B<span class="ot">=</span><span class="fu">perm</span>(k); <span class="co"># all possible permutations</span></span>
<span id="cb187-16"><a href="多样本位置参数.html#cb187-16" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">=</span><span class="fu">nrow</span>(B);</span>
<span id="cb187-17"><a href="多样本位置参数.html#cb187-17" aria-hidden="true" tabindex="-1"></a>  ind<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nn,<span class="at">each=</span>nn<span class="sc">^</span>(b<span class="dv">-1</span>));</span>
<span id="cb187-18"><a href="多样本位置参数.html#cb187-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(b<span class="dv">-1</span>)){</span>
<span id="cb187-19"><a href="多样本位置参数.html#cb187-19" aria-hidden="true" tabindex="-1"></a>    ind<span class="ot">=</span><span class="fu">cbind</span>(ind,<span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nn,<span class="at">each=</span>nn<span class="sc">^</span>(b<span class="dv">-1</span><span class="sc">-</span>i)),nn<span class="sc">^</span>(i)))</span>
<span id="cb187-20"><a href="多样本位置参数.html#cb187-20" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb187-21"><a href="多样本位置参数.html#cb187-21" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">=</span><span class="fu">nrow</span>(ind);</span>
<span id="cb187-22"><a href="多样本位置参数.html#cb187-22" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,nn);</span>
<span id="cb187-23"><a href="多样本位置参数.html#cb187-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nn){</span>
<span id="cb187-24"><a href="多样本位置参数.html#cb187-24" aria-hidden="true" tabindex="-1"></a>    R<span class="ot">=</span><span class="fu">apply</span>(B[ind[i,],],<span class="dv">2</span>,sum);</span>
<span id="cb187-25"><a href="多样本位置参数.html#cb187-25" aria-hidden="true" tabindex="-1"></a>    y[i]<span class="ot">=</span><span class="dv">12</span><span class="sc">/</span>(b<span class="sc">*</span>k<span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span><span class="fu">sum</span>(R<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>b<span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb187-26"><a href="多样本位置参数.html#cb187-26" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb187-27"><a href="多样本位置参数.html#cb187-27" aria-hidden="true" tabindex="-1"></a>  y0<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(y));</span>
<span id="cb187-28"><a href="多样本位置参数.html#cb187-28" aria-hidden="true" tabindex="-1"></a>  ycnt<span class="ot">=</span>ydnt<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb187-29"><a href="多样本位置参数.html#cb187-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y0)){</span>
<span id="cb187-30"><a href="多样本位置参数.html#cb187-30" aria-hidden="true" tabindex="-1"></a>    ydnt<span class="ot">=</span><span class="fu">c</span>(ydnt,<span class="fu">length</span>(y[y<span class="sc">==</span>y0[i]]));</span>
<span id="cb187-31"><a href="多样本位置参数.html#cb187-31" aria-hidden="true" tabindex="-1"></a>    ycnt<span class="ot">=</span><span class="fu">c</span>(ycnt,<span class="fu">length</span>(y[y<span class="sc">&gt;=</span>y0[i]]))</span>
<span id="cb187-32"><a href="多样本位置参数.html#cb187-32" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb187-33"><a href="多样本位置参数.html#cb187-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(y0,ydnt<span class="sc">/</span>nn,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">ylab=</span><span class="st">&quot;density function&quot;</span>,</span>
<span id="cb187-34"><a href="多样本位置参数.html#cb187-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab=</span><span class="st">&quot;values of the Friedman statistics&quot;</span>);</span>
<span id="cb187-35"><a href="多样本位置参数.html#cb187-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y0)) <span class="fu">points</span>(<span class="fu">c</span>(y0[i],y0[i]),<span class="fu">c</span>(ydnt[i]<span class="sc">/</span>nn,<span class="dv">0</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>);</span>
<span id="cb187-36"><a href="多样本位置参数.html#cb187-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">t</span>(<span class="fu">cbind</span>(<span class="at">W=</span>y0<span class="sc">/</span>b<span class="sc">/</span>(k<span class="dv">-1</span>),<span class="at">Q=</span>y0,<span class="at">density=</span>ydnt<span class="sc">/</span>nn,<span class="at">pvalue=</span>ycnt<span class="sc">/</span>nn)),</span>
<span id="cb187-37"><a href="多样本位置参数.html#cb187-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pvalue=</span><span class="fu">length</span>(y[y<span class="sc">&gt;=</span>(b<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">*</span>W0)])<span class="sc">/</span>nn)}</span>
<span id="cb187-38"><a href="多样本位置参数.html#cb187-38" aria-hidden="true" tabindex="-1"></a><span class="fu">Friedman</span>()</span></code></pre></div>
<p><img src="04_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre><code>## [[1]]
##               [,1]      [,2]      [,3]      [,4]      [,5]       [,6]
## W       0.00000000 0.0625000 0.1875000 0.2500000 0.4375000 0.56250000
## Q       0.00000000 0.5000000 1.5000000 2.0000000 3.5000000 4.50000000
## density 0.06944444 0.2777778 0.2222222 0.1574074 0.1481481 0.05555556
## pvalue  1.00000000 0.9305556 0.6527778 0.4305556 0.2731481 0.12500000
##               [,7]       [,8]       [,9]
## W       0.75000000 0.81250000 1.00000000
## Q       6.00000000 6.50000000 8.00000000
## density 0.02777778 0.03703704 0.00462963
## pvalue  0.06944444 0.04166667 0.00462963
## 
## $Pvalue
## [1] 0.04166667</code></pre>
</div>
<div id="大样本近似-4" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> 大样本近似<a href="多样本位置参数.html#大样本近似-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="多样本位置参数.html#cb189-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/blead.txt&quot;</span>)</span>
<span id="cb189-2"><a href="多样本位置参数.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">friedman.test</span>(<span class="fu">as.matrix</span>(X))</span></code></pre></div>
<pre><code>## 
##  Friedman rank sum test
## 
## data:  as.matrix(X)
## Friedman chi-squared = 6.5, df = 2, p-value = 0.03877</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="多样本位置参数.html#cb191-1" aria-hidden="true" tabindex="-1"></a>X<span class="ot">=</span><span class="fu">t</span>(X);Y<span class="ot">=</span><span class="fu">apply</span>(X,<span class="dv">2</span>,rank);R<span class="ot">=</span><span class="fu">apply</span>(Y,<span class="dv">1</span>,sum);k<span class="ot">=</span><span class="fu">nrow</span>(X);b<span class="ot">=</span><span class="fu">ncol</span>(X);</span>
<span id="cb191-2"><a href="多样本位置参数.html#cb191-2" aria-hidden="true" tabindex="-1"></a>Q<span class="ot">=</span><span class="dv">12</span><span class="sc">/</span>(b<span class="sc">*</span>k<span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span><span class="fu">sum</span>(R<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>b<span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>) <span class="co">#Q=12/(b*k*(k+1))*sum((R-mean(R))^2)</span></span>
<span id="cb191-3"><a href="多样本位置参数.html#cb191-3" aria-hidden="true" tabindex="-1"></a>Q</span></code></pre></div>
<pre><code>## [1] 6.5</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="多样本位置参数.html#cb193-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">pvalue=</span><span class="fu">pchisq</span>(Q,k<span class="dv">-1</span>,<span class="at">low=</span>F))</span></code></pre></div>
<pre><code>## [1] 0.03877421</code></pre>
</div>
</div>
<div id="kendall协同系数检验" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> 4.6 Kendall协同系数检验<a href="多样本位置参数.html#kendall协同系数检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>评估或排序是否一致</li>
<li>区组设计，Y为有序整数（排名或分数）</li>
<li>二元变量的Kendall’s <span class="math inline">\(\tau\)</span>在多元情况的推广</li>
<li>注意与Friedman秩和检验统计量的联系</li>
</ul>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="多样本位置参数.html#cb195-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/airp35.txt&quot;</span>);</span>
<span id="cb195-2"><a href="多样本位置参数.html#cb195-2" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="fu">apply</span>(d,<span class="dv">2</span>,sum);b<span class="ot">=</span><span class="fu">nrow</span>(d);k<span class="ot">=</span><span class="fu">ncol</span>(d);</span>
<span id="cb195-3"><a href="多样本位置参数.html#cb195-3" aria-hidden="true" tabindex="-1"></a>S<span class="ot">=</span><span class="fu">sum</span>((R<span class="sc">-</span>b<span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb195-4"><a href="多样本位置参数.html#cb195-4" aria-hidden="true" tabindex="-1"></a>(<span class="at">W=</span><span class="dv">12</span><span class="sc">*</span>S<span class="sc">/</span>b<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="sc">^</span><span class="dv">3</span><span class="sc">-</span>k));</span></code></pre></div>
<pre><code>## [1] 0.7333333</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="多样本位置参数.html#cb197-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">Q=</span>W<span class="sc">*</span>b<span class="sc">*</span>(k<span class="dv">-1</span>))</span></code></pre></div>
<pre><code>## [1] 8.8</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="多样本位置参数.html#cb199-1" aria-hidden="true" tabindex="-1"></a>Kendall<span class="ot">=</span><span class="cf">function</span>(<span class="at">k=</span><span class="dv">5</span>,<span class="at">b=</span><span class="dv">3</span>,<span class="at">W0=</span><span class="fl">0.733</span>){</span>
<span id="cb199-2"><a href="多样本位置参数.html#cb199-2" aria-hidden="true" tabindex="-1"></a>  perm<span class="ot">=</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">4</span>){</span>
<span id="cb199-3"><a href="多样本位置参数.html#cb199-3" aria-hidden="true" tabindex="-1"></a>    A<span class="ot">=</span><span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>));</span>
<span id="cb199-4"><a href="多样本位置参数.html#cb199-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n<span class="sc">&gt;=</span><span class="dv">3</span>){</span>
<span id="cb199-5"><a href="多样本位置参数.html#cb199-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n){</span>
<span id="cb199-6"><a href="多样本位置参数.html#cb199-6" aria-hidden="true" tabindex="-1"></a>        temp<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">rep</span>(i,<span class="fu">nrow</span>(A)),A);</span>
<span id="cb199-7"><a href="多样本位置参数.html#cb199-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-2</span>))){</span>
<span id="cb199-8"><a href="多样本位置参数.html#cb199-8" aria-hidden="true" tabindex="-1"></a>          temp<span class="ot">=</span><span class="fu">rbind</span>(temp,<span class="fu">cbind</span>(A[,<span class="dv">1</span><span class="sc">:</span>j],<span class="fu">rep</span>(i,<span class="fu">nrow</span>(A)),A[,(j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="dv">-1</span>)]))</span>
<span id="cb199-9"><a href="多样本位置参数.html#cb199-9" aria-hidden="true" tabindex="-1"></a>        };</span>
<span id="cb199-10"><a href="多样本位置参数.html#cb199-10" aria-hidden="true" tabindex="-1"></a>        temp<span class="ot">=</span><span class="fu">rbind</span>(temp,<span class="fu">cbind</span>(A,<span class="fu">rep</span>(i,<span class="fu">nrow</span>(A))));A<span class="ot">=</span>temp</span>
<span id="cb199-11"><a href="多样本位置参数.html#cb199-11" aria-hidden="true" tabindex="-1"></a>      };</span>
<span id="cb199-12"><a href="多样本位置参数.html#cb199-12" aria-hidden="true" tabindex="-1"></a>    };A</span>
<span id="cb199-13"><a href="多样本位置参数.html#cb199-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb199-14"><a href="多样本位置参数.html#cb199-14" aria-hidden="true" tabindex="-1"></a>  B<span class="ot">=</span><span class="fu">perm</span>(k); <span class="co"># all possible permutations</span></span>
<span id="cb199-15"><a href="多样本位置参数.html#cb199-15" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">=</span><span class="fu">nrow</span>(B);ind<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nn,<span class="at">each=</span>nn<span class="sc">^</span>(b<span class="dv">-1</span>));</span>
<span id="cb199-16"><a href="多样本位置参数.html#cb199-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(b<span class="dv">-1</span>)){</span>
<span id="cb199-17"><a href="多样本位置参数.html#cb199-17" aria-hidden="true" tabindex="-1"></a>    ind<span class="ot">=</span><span class="fu">cbind</span>(ind,<span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nn,<span class="at">each=</span>nn<span class="sc">^</span>(b<span class="dv">-1</span><span class="sc">-</span>i)),nn<span class="sc">^</span>(i)))</span>
<span id="cb199-18"><a href="多样本位置参数.html#cb199-18" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb199-19"><a href="多样本位置参数.html#cb199-19" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">=</span><span class="fu">nrow</span>(ind);y<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,nn);</span>
<span id="cb199-20"><a href="多样本位置参数.html#cb199-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nn){</span>
<span id="cb199-21"><a href="多样本位置参数.html#cb199-21" aria-hidden="true" tabindex="-1"></a>    R<span class="ot">=</span><span class="fu">apply</span>(B[ind[i,],],<span class="dv">2</span>,sum);</span>
<span id="cb199-22"><a href="多样本位置参数.html#cb199-22" aria-hidden="true" tabindex="-1"></a>    y[i]<span class="ot">=</span><span class="dv">12</span><span class="sc">/</span>(b<span class="sc">*</span>k<span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>))<span class="sc">*</span><span class="fu">sum</span>(R<span class="sc">^</span><span class="dv">2</span>)<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>b<span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb199-23"><a href="多样本位置参数.html#cb199-23" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb199-24"><a href="多样本位置参数.html#cb199-24" aria-hidden="true" tabindex="-1"></a>  y0<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(y));</span>
<span id="cb199-25"><a href="多样本位置参数.html#cb199-25" aria-hidden="true" tabindex="-1"></a>  ycnt<span class="ot">=</span>ydnt<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb199-26"><a href="多样本位置参数.html#cb199-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y0)){</span>
<span id="cb199-27"><a href="多样本位置参数.html#cb199-27" aria-hidden="true" tabindex="-1"></a>    ydnt<span class="ot">=</span><span class="fu">c</span>(ydnt,<span class="fu">length</span>(y[y<span class="sc">==</span>y0[i]]));</span>
<span id="cb199-28"><a href="多样本位置参数.html#cb199-28" aria-hidden="true" tabindex="-1"></a>    ycnt<span class="ot">=</span><span class="fu">c</span>(ycnt,<span class="fu">length</span>(y[y<span class="sc">&gt;=</span>y0[i]]))</span>
<span id="cb199-29"><a href="多样本位置参数.html#cb199-29" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb199-30"><a href="多样本位置参数.html#cb199-30" aria-hidden="true" tabindex="-1"></a>  w0<span class="ot">=</span>y0<span class="sc">/</span>b<span class="sc">/</span>(k<span class="dv">-1</span>);</span>
<span id="cb199-31"><a href="多样本位置参数.html#cb199-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(w0,ydnt<span class="sc">/</span>nn,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">ylab=</span><span class="st">&quot;density function&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Kendall 协同系数&quot;</span>);</span>
<span id="cb199-32"><a href="多样本位置参数.html#cb199-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y0)) <span class="fu">points</span>(<span class="fu">c</span>(w0[i],w0[i]),<span class="fu">c</span>(ydnt[i]<span class="sc">/</span>nn,<span class="dv">0</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb199-33"><a href="多样本位置参数.html#cb199-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">t</span>(<span class="fu">cbind</span>(<span class="at">W=</span>w0,<span class="at">Q=</span>y0,<span class="at">density=</span>ydnt<span class="sc">/</span>nn,<span class="at">pvalue=</span>ycnt<span class="sc">/</span>nn)),</span>
<span id="cb199-34"><a href="多样本位置参数.html#cb199-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">Pvalue=</span><span class="fu">length</span>(y[y<span class="sc">&gt;=</span>(b<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">*</span>W0)])<span class="sc">/</span>nn)</span>
<span id="cb199-35"><a href="多样本位置参数.html#cb199-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-36"><a href="多样本位置参数.html#cb199-36" aria-hidden="true" tabindex="-1"></a><span class="fu">Kendall</span>()</span></code></pre></div>
<p><img src="04_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre><code>## [[1]]
##                 [,1]       [,2]       [,3]       [,4]       [,5]       [,6]
## W       0.0000000000 0.02222222 0.04444444 0.06666667 0.08888889 0.11111111
## Q       0.0000000000 0.26666667 0.53333333 0.80000000 1.06666667 1.33333333
## density 0.0004166667 0.01125000 0.01666667 0.03083333 0.02708333 0.06895833
## pvalue  1.0000000000 0.99958333 0.98833333 0.97166667 0.94083333 0.91375000
##               [,7]       [,8]       [,9]      [,10]      [,11]      [,12]
## W       0.13333333 0.15555556 0.17777778 0.20000000 0.22222222 0.24444444
## Q       1.60000000 1.86666667 2.13333333 2.40000000 2.66666667 2.93333333
## density 0.01361111 0.06333333 0.04791667 0.03743056 0.03333333 0.05458333
## pvalue  0.84479167 0.83118056 0.76784722 0.71993056 0.68250000 0.64916667
##              [,13]      [,14]     [,15]      [,16]      [,17]     [,18]
## W       0.26666667 0.28888889 0.3111111 0.33333333 0.35555556 0.3777778
## Q       3.20000000 3.46666667 3.7333333 4.00000000 4.26666667 4.5333333
## density 0.03583333 0.06604167 0.0175000 0.04291667 0.02666667 0.0587500
## pvalue  0.59458333 0.55875000 0.4927083 0.47520833 0.43229167 0.4056250
##              [,19]      [,20]     [,21]      [,22]      [,23]      [,24]
## W       0.40000000 0.42222222 0.4444444 0.46666667 0.48888889 0.51111111
## Q       4.80000000 5.06666667 5.3333333 5.60000000 5.86666667 6.13333333
## density 0.02083333 0.03541667 0.0375000 0.01708333 0.02333333 0.04041667
## pvalue  0.34687500 0.32604167 0.2906250 0.25312500 0.23604167 0.21270833
##               [,25]      [,26]     [,27]     [,28]      [,29]      [,30]
## W       0.533333333 0.55555556 0.5777778 0.6000000 0.62222222 0.64444444
## Q       6.400000000 6.66666667 6.9333333 7.2000000 7.46666667 7.73333333
## density 0.009722222 0.03541667 0.0100000 0.0212500 0.01583333 0.01666667
## pvalue  0.172291667 0.16256944 0.1271528 0.1171528 0.09590278 0.08006944
##              [,31]      [,32]       [,33]       [,34]      [,35]      [,36]
## W       0.66666667 0.68888889 0.711111111 0.733333333 0.75555556 0.77777778
## Q       8.00000000 8.26666667 8.533333333 8.800000000 9.06666667 9.33333333
## density 0.00750000 0.01041667 0.007916667 0.009166667 0.00250000 0.00875000
## pvalue  0.06340278 0.05590278 0.045486111 0.037569444 0.02840278 0.02590278
##               [,37]       [,38]        [,39]        [,40]        [,41]
## W       0.800000000 0.822222222  0.844444444  0.866666667  0.888888889
## Q       9.600000000 9.866666667 10.133333333 10.400000000 10.666666667
## density 0.002083333 0.007291667  0.002500000  0.001250000  0.001250000
## pvalue  0.017152778 0.015069444  0.007777778  0.005277778  0.004027778
##                [,42]        [,43]        [,44]
## W        0.911111111 9.555556e-01 1.000000e+00
## Q       10.933333333 1.146667e+01 1.200000e+01
## density  0.001875000 8.333333e-04 6.944444e-05
## pvalue   0.002777778 9.027778e-04 6.944444e-05
## 
## $Pvalue
## [1] 0.03756944</code></pre>
<div id="大样本近似-5" class="section level3 hasAnchor" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> 大样本近似<a href="多样本位置参数.html#大样本近似-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="多样本位置参数.html#cb201-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/airp.txt&quot;</span>);R<span class="ot">=</span><span class="fu">apply</span>(d,<span class="dv">2</span>,sum);</span>
<span id="cb201-2"><a href="多样本位置参数.html#cb201-2" aria-hidden="true" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">nrow</span>(d);k<span class="ot">=</span><span class="fu">ncol</span>(d);S<span class="ot">=</span><span class="fu">sum</span>((R<span class="sc">-</span>b<span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb201-3"><a href="多样本位置参数.html#cb201-3" aria-hidden="true" tabindex="-1"></a>W<span class="ot">=</span><span class="dv">12</span><span class="sc">*</span>S<span class="sc">/</span>b<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(k<span class="sc">^</span><span class="dv">3</span><span class="sc">-</span>k);<span class="fu">pchisq</span>(b<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">*</span>W,k<span class="dv">-1</span>,<span class="at">low=</span>F)</span></code></pre></div>
<pre><code>## [1] 0.0003320349</code></pre>
</div>
</div>
<div id="cochran检验" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> 4.7 Cochran检验<a href="多样本位置参数.html#cochran检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>二元响应的数据</li>
<li>解决打结的问题</li>
<li>双样本问题McNemar <span class="math inline">\(\chi^2\)</span>检验的推广</li>
</ul>
<div id="精确检验-4" class="section level3 hasAnchor" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> 精确检验<a href="多样本位置参数.html#精确检验-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="多样本位置参数.html#cb203-1" aria-hidden="true" tabindex="-1"></a>Cochran<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb203-2"><a href="多样本位置参数.html#cb203-2" aria-hidden="true" tabindex="-1"></a>  Xpchs<span class="ot">=</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">7</span>,<span class="at">k=</span><span class="dv">5</span>){</span>
<span id="cb203-3"><a href="多样本位置参数.html#cb203-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#output(n_1,..,n_k)-all possible combination with n_1+...+n_k=n</span></span>
<span id="cb203-4"><a href="多样本位置参数.html#cb203-4" aria-hidden="true" tabindex="-1"></a>    temp<span class="ot">=</span><span class="fu">cbind</span>(n<span class="sc">:</span><span class="dv">0</span>,<span class="dv">0</span><span class="sc">:</span>n);</span>
<span id="cb203-5"><a href="多样本位置参数.html#cb203-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (k<span class="sc">&gt;=</span><span class="dv">3</span>){</span>
<span id="cb203-6"><a href="多样本位置参数.html#cb203-6" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>k){</span>
<span id="cb203-7"><a href="多样本位置参数.html#cb203-7" aria-hidden="true" tabindex="-1"></a>        a1<span class="ot">=</span>temp[,<span class="dv">1</span><span class="sc">:</span>(j<span class="dv">-2</span>)];a2<span class="ot">=</span>temp[,j<span class="dv">-1</span>];temp0<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb203-8"><a href="多样本位置参数.html#cb203-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a2)){</span>
<span id="cb203-9"><a href="多样本位置参数.html#cb203-9" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (j<span class="sc">==</span><span class="dv">3</span>) temp0<span class="ot">=</span><span class="fu">rbind</span>(temp0,<span class="fu">cbind</span>(<span class="fu">rep</span>(a1[i],a2[i]<span class="sc">+</span><span class="dv">1</span>),a2[i]<span class="sc">:</span><span class="dv">0</span>,<span class="dv">0</span><span class="sc">:</span>a2[i]))</span>
<span id="cb203-10"><a href="多样本位置参数.html#cb203-10" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (j<span class="sc">&gt;</span><span class="dv">3</span>)  temp0<span class="ot">=</span><span class="fu">rbind</span>(temp0,<span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(a1[i,],a2[i]<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb203-11"><a href="多样本位置参数.html#cb203-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol=</span>j<span class="dv">-2</span>,<span class="at">byrow=</span>T),a2[i]<span class="sc">:</span><span class="dv">0</span>,<span class="dv">0</span><span class="sc">:</span>a2[i]))</span>
<span id="cb203-12"><a href="多样本位置参数.html#cb203-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb203-13"><a href="多样本位置参数.html#cb203-13" aria-hidden="true" tabindex="-1"></a>        temp<span class="ot">=</span>temp0</span>
<span id="cb203-14"><a href="多样本位置参数.html#cb203-14" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb203-15"><a href="多样本位置参数.html#cb203-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb203-16"><a href="多样本位置参数.html#cb203-16" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb203-17"><a href="多样本位置参数.html#cb203-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb203-18"><a href="多样本位置参数.html#cb203-18" aria-hidden="true" tabindex="-1"></a>  Xpchs2<span class="ot">=</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">4</span>,<span class="at">k=</span><span class="dv">2</span>){</span>
<span id="cb203-19"><a href="多样本位置参数.html#cb203-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#output: all 0 and 1 columns, with n-k 0s and k- 1s columns</span></span>
<span id="cb203-20"><a href="多样本位置参数.html#cb203-20" aria-hidden="true" tabindex="-1"></a>    Xchoose<span class="ot">=</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">4</span>,<span class="at">k=</span><span class="dv">2</span>){</span>
<span id="cb203-21"><a href="多样本位置参数.html#cb203-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (k<span class="sc">==</span><span class="dv">0</span>) aa<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb203-22"><a href="多样本位置参数.html#cb203-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (k<span class="sc">&gt;=</span><span class="dv">1</span>){</span>
<span id="cb203-23"><a href="多样本位置参数.html#cb203-23" aria-hidden="true" tabindex="-1"></a>        aa<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">ncol=</span><span class="dv">1</span>);m<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb203-24"><a href="多样本位置参数.html#cb203-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(k<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb203-25"><a href="多样本位置参数.html#cb203-25" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>k){</span>
<span id="cb203-26"><a href="多样本位置参数.html#cb203-26" aria-hidden="true" tabindex="-1"></a>            m<span class="ot">=</span>m<span class="sc">+</span><span class="dv">1</span>;m1<span class="ot">=</span><span class="fu">nrow</span>(aa);</span>
<span id="cb203-27"><a href="多样本位置参数.html#cb203-27" aria-hidden="true" tabindex="-1"></a>            aa<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(aa,<span class="at">each=</span>n),<span class="at">ncol=</span>m),<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n,m1))</span>
<span id="cb203-28"><a href="多样本位置参数.html#cb203-28" aria-hidden="true" tabindex="-1"></a>            aa<span class="ot">=</span>aa[(aa[,m<span class="sc">+</span><span class="dv">1</span>]<span class="sc">&gt;</span>aa[,m]),]</span>
<span id="cb203-29"><a href="多样本位置参数.html#cb203-29" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb203-30"><a href="多样本位置参数.html#cb203-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb203-31"><a href="多样本位置参数.html#cb203-31" aria-hidden="true" tabindex="-1"></a>      };</span>
<span id="cb203-32"><a href="多样本位置参数.html#cb203-32" aria-hidden="true" tabindex="-1"></a>      aa</span>
<span id="cb203-33"><a href="多样本位置参数.html#cb203-33" aria-hidden="true" tabindex="-1"></a>    };</span>
<span id="cb203-34"><a href="多样本位置参数.html#cb203-34" aria-hidden="true" tabindex="-1"></a>    e01<span class="ot">=</span><span class="fu">Xchoose</span>(n,k)</span>
<span id="cb203-35"><a href="多样本位置参数.html#cb203-35" aria-hidden="true" tabindex="-1"></a>    temp<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">nrow</span>(e01),<span class="at">ncol=</span>n);</span>
<span id="cb203-36"><a href="多样本位置参数.html#cb203-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(temp)){</span>
<span id="cb203-37"><a href="多样本位置参数.html#cb203-37" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (k<span class="sc">==</span><span class="dv">1</span>) temp[j,e01[j]]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb203-38"><a href="多样本位置参数.html#cb203-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (k<span class="sc">&gt;</span><span class="dv">1</span>) temp[j,e01[j,]]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb203-39"><a href="多样本位置参数.html#cb203-39" aria-hidden="true" tabindex="-1"></a>      };</span>
<span id="cb203-40"><a href="多样本位置参数.html#cb203-40" aria-hidden="true" tabindex="-1"></a>      temp</span>
<span id="cb203-41"><a href="多样本位置参数.html#cb203-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb203-42"><a href="多样本位置参数.html#cb203-42" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">nrow</span>(x);k<span class="ot">=</span><span class="fu">ncol</span>(x);</span>
<span id="cb203-43"><a href="多样本位置参数.html#cb203-43" aria-hidden="true" tabindex="-1"></a>  L<span class="ot">=</span><span class="fu">apply</span>(x,<span class="dv">1</span>,sum);R<span class="ot">=</span><span class="fu">apply</span>(x,<span class="dv">2</span>,sum);N<span class="ot">=</span><span class="fu">sum</span>(R);</span>
<span id="cb203-44"><a href="多样本位置参数.html#cb203-44" aria-hidden="true" tabindex="-1"></a>  Q0<span class="ot">=</span>(k<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((R<span class="sc">-</span><span class="fu">mean</span>(R))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(k<span class="sc">*</span>N<span class="sc">-</span><span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">2</span>));</span>
<span id="cb203-45"><a href="多样本位置参数.html#cb203-45" aria-hidden="true" tabindex="-1"></a>  Ni<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb203-46"><a href="多样本位置参数.html#cb203-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k<span class="dv">-1</span>) Ni<span class="ot">=</span><span class="fu">c</span>(Ni,<span class="fu">sum</span>(L<span class="sc">==</span>i));</span>
<span id="cb203-47"><a href="多样本位置参数.html#cb203-47" aria-hidden="true" tabindex="-1"></a>  Ni<span class="ot">=</span>Ni[<span class="sc">-</span><span class="dv">1</span>];</span>
<span id="cb203-48"><a href="多样本位置参数.html#cb203-48" aria-hidden="true" tabindex="-1"></a>  eye0<span class="ot">=</span><span class="fu">Xpchs2</span>(k,<span class="dv">1</span>);temp0<span class="ot">=</span><span class="fu">Xpchs</span>(Ni[<span class="dv">1</span>],<span class="fu">nrow</span>(eye0));Ri0<span class="ot">=</span>temp0<span class="sc">%*%</span>eye0;</span>
<span id="cb203-49"><a href="多样本位置参数.html#cb203-49" aria-hidden="true" tabindex="-1"></a>  prob0<span class="ot">=</span><span class="fu">factorial</span>(Ni[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">apply</span>(<span class="fu">factorial</span>(temp0),<span class="dv">1</span>,prod)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">nrow</span>(eye0))<span class="sc">^</span>(Ni[<span class="dv">1</span>]);</span>
<span id="cb203-50"><a href="多样本位置参数.html#cb203-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(Ni)<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb203-51"><a href="多样本位置参数.html#cb203-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(Ni)){</span>
<span id="cb203-52"><a href="多样本位置参数.html#cb203-52" aria-hidden="true" tabindex="-1"></a>      eye1<span class="ot">=</span><span class="fu">Xpchs2</span>(k,i);</span>
<span id="cb203-53"><a href="多样本位置参数.html#cb203-53" aria-hidden="true" tabindex="-1"></a>      temp1<span class="ot">=</span><span class="fu">Xpchs</span>(Ni[i],<span class="fu">nrow</span>(eye1));</span>
<span id="cb203-54"><a href="多样本位置参数.html#cb203-54" aria-hidden="true" tabindex="-1"></a>      Ri1<span class="ot">=</span>temp1<span class="sc">%*%</span>eye1;</span>
<span id="cb203-55"><a href="多样本位置参数.html#cb203-55" aria-hidden="true" tabindex="-1"></a>      prob1<span class="ot">=</span><span class="fu">factorial</span>(Ni[i])<span class="sc">/</span><span class="fu">apply</span>(<span class="fu">factorial</span>(temp1),<span class="dv">1</span>,prod)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">nrow</span>(eye1))<span class="sc">^</span>(Ni[i])</span>
<span id="cb203-56"><a href="多样本位置参数.html#cb203-56" aria-hidden="true" tabindex="-1"></a>      Ri0<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">t</span>(Ri0),<span class="fu">nrow</span>(Ri1)),<span class="at">byrow=</span>T,<span class="at">ncol=</span>k)<span class="sc">+</span></span>
<span id="cb203-57"><a href="多样本位置参数.html#cb203-57" aria-hidden="true" tabindex="-1"></a>          <span class="fu">matrix</span>(<span class="fu">rep</span>(Ri1,<span class="at">each=</span><span class="fu">nrow</span>(Ri0)),<span class="at">ncol=</span>k)</span>
<span id="cb203-58"><a href="多样本位置参数.html#cb203-58" aria-hidden="true" tabindex="-1"></a>      prob0<span class="ot">=</span><span class="fu">rep</span>(prob0,<span class="fu">length</span>(prob1))<span class="sc">*</span><span class="fu">rep</span>(prob1,<span class="at">each=</span><span class="fu">length</span>(prob0))</span>
<span id="cb203-59"><a href="多样本位置参数.html#cb203-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb203-60"><a href="多样本位置参数.html#cb203-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb203-61"><a href="多样本位置参数.html#cb203-61" aria-hidden="true" tabindex="-1"></a>  xa<span class="ot">=</span>k<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">apply</span>((Ri0<span class="sc">-</span><span class="fu">apply</span>(Ri0,<span class="dv">1</span>,mean))<span class="sc">^</span><span class="dv">2</span>,<span class="dv">1</span>,sum)<span class="sc">/</span>(k<span class="sc">*</span>N<span class="sc">-</span><span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb203-62"><a href="多样本位置参数.html#cb203-62" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">=</span><span class="fu">length</span>(xa);xa0<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(xa));xacnt<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb203-63"><a href="多样本位置参数.html#cb203-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xa0)) xacnt<span class="ot">=</span><span class="fu">c</span>(xacnt,<span class="fu">length</span>(xa[xa<span class="sc">==</span>xa0[i]]));</span>
<span id="cb203-64"><a href="多样本位置参数.html#cb203-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(xa0,xacnt<span class="sc">/</span>nn,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">ylab=</span><span class="st">&quot;density function&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;value of Cochran statistics&quot;</span>);</span>
<span id="cb203-65"><a href="多样本位置参数.html#cb203-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xa0)){</span>
<span id="cb203-66"><a href="多样本位置参数.html#cb203-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(<span class="fu">c</span>(xa0[i],xa0[i]),<span class="fu">c</span>(xacnt[i]<span class="sc">/</span>nn,<span class="dv">0</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb203-67"><a href="多样本位置参数.html#cb203-67" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb203-68"><a href="多样本位置参数.html#cb203-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">unique</span>(xa),<span class="fu">cbind</span>(<span class="fu">rbind</span>(<span class="fu">t</span>(x),L),<span class="fu">c</span>(R,N)),<span class="at">Q=</span>Q0,</span>
<span id="cb203-69"><a href="多样本位置参数.html#cb203-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">Exactp=</span><span class="fu">sum</span>(prob0[(xa<span class="sc">&gt;=</span>Q0)]),<span class="at">pvalue=</span><span class="fu">pchisq</span>(Q0,k<span class="dv">-1</span>,<span class="at">low=</span>F))</span>
<span id="cb203-70"><a href="多样本位置参数.html#cb203-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb203-71"><a href="多样本位置参数.html#cb203-71" aria-hidden="true" tabindex="-1"></a>candid<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/candid.txt&quot;</span>);</span>
<span id="cb203-72"><a href="多样本位置参数.html#cb203-72" aria-hidden="true" tabindex="-1"></a><span class="fu">Cochran</span>(candid[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,])</span></code></pre></div>
<p><img src="04_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre><code>## [[1]]
##  [1] 20.8235294 20.1176471 17.2941176 14.4705882 15.1764706 11.6470588
##  [7]  9.5294118 18.7058824 15.8823529 12.3529412 10.2352941  7.4117647
## [13]  6.0000000  3.8823529 18.0000000  6.7058824  8.8235294  4.5882353
## [19]  3.1764706  1.7647059  1.0588235  0.3529412 13.0588235
## 
## [[2]]
##    1 2 3 4 5 6 7 8 9 10   
## V1 0 1 1 0 0 1 1 1 1  1  7
## V2 1 1 0 0 0 1 1 1 1  1  7
## V3 0 1 1 1 1 0 0 0 0  1  5
## V4 0 0 0 0 1 1 0 0 1  0  3
## L  1 3 2 1 2 3 2 2 3  3 22
## 
## $Q
## [1] 3.882353
## 
## $Exactp
## [1] 0.3203803
## 
## $pvalue
## [1] 0.2744513</code></pre>
</div>
<div id="大样本近似-6" class="section level3 hasAnchor" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> 大样本近似<a href="多样本位置参数.html#大样本近似-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="多样本位置参数.html#cb205-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/candid.txt&quot;</span>);n<span class="ot">=</span><span class="fu">apply</span>(x,<span class="dv">2</span>,sum);N<span class="ot">=</span><span class="fu">sum</span>(n)</span>
<span id="cb205-2"><a href="多样本位置参数.html#cb205-2" aria-hidden="true" tabindex="-1"></a>L<span class="ot">=</span><span class="fu">apply</span>(x,<span class="dv">1</span>,sum);k<span class="ot">=</span><span class="fu">dim</span>(x)[<span class="dv">2</span>]</span>
<span id="cb205-3"><a href="多样本位置参数.html#cb205-3" aria-hidden="true" tabindex="-1"></a>(<span class="at">Q=</span>(k<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((n<span class="sc">-</span><span class="fu">mean</span>(n))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(k<span class="sc">*</span>N<span class="sc">-</span><span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">2</span>)))</span></code></pre></div>
<pre><code>## [1] 9.352941</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="多样本位置参数.html#cb207-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">pvalue=</span><span class="fu">pchisq</span>(Q,k<span class="dv">-1</span>,<span class="at">low=</span>F))</span></code></pre></div>
<pre><code>## [1] 0.0249484</code></pre>
</div>
</div>
<div id="page检验" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> 4.8 Page检验<a href="多样本位置参数.html#page检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>备择假设为有序</li>
<li>类比于Jonckheere检验</li>
<li>完全区组设计</li>
</ul>
<div id="精确检验-5" class="section level3 hasAnchor" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> 精确检验<a href="多样本位置参数.html#精确检验-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="多样本位置参数.html#cb209-1" aria-hidden="true" tabindex="-1"></a>Page<span class="ot">=</span><span class="cf">function</span>(<span class="at">k=</span><span class="dv">3</span>,<span class="at">b=</span><span class="dv">4</span>,<span class="at">L0=</span><span class="dv">55</span>){</span>
<span id="cb209-2"><a href="多样本位置参数.html#cb209-2" aria-hidden="true" tabindex="-1"></a>  perm<span class="ot">=</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">4</span>){</span>
<span id="cb209-3"><a href="多样本位置参数.html#cb209-3" aria-hidden="true" tabindex="-1"></a>    A<span class="ot">=</span><span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>));</span>
<span id="cb209-4"><a href="多样本位置参数.html#cb209-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (n<span class="sc">&gt;=</span><span class="dv">3</span>){</span>
<span id="cb209-5"><a href="多样本位置参数.html#cb209-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n){</span>
<span id="cb209-6"><a href="多样本位置参数.html#cb209-6" aria-hidden="true" tabindex="-1"></a>        temp<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">rep</span>(i,<span class="fu">nrow</span>(A)),A);</span>
<span id="cb209-7"><a href="多样本位置参数.html#cb209-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (j <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>(i<span class="dv">-2</span>))){</span>
<span id="cb209-8"><a href="多样本位置参数.html#cb209-8" aria-hidden="true" tabindex="-1"></a>          temp<span class="ot">=</span><span class="fu">rbind</span>(temp,<span class="fu">cbind</span>(A[,<span class="dv">1</span><span class="sc">:</span>j],<span class="fu">rep</span>(i,<span class="fu">nrow</span>(A)),A[,(j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(i<span class="dv">-1</span>)]))</span>
<span id="cb209-9"><a href="多样本位置参数.html#cb209-9" aria-hidden="true" tabindex="-1"></a>        };</span>
<span id="cb209-10"><a href="多样本位置参数.html#cb209-10" aria-hidden="true" tabindex="-1"></a>        temp<span class="ot">=</span><span class="fu">rbind</span>(temp,<span class="fu">cbind</span>(A,<span class="fu">rep</span>(i,<span class="fu">nrow</span>(A))));A<span class="ot">=</span>temp</span>
<span id="cb209-11"><a href="多样本位置参数.html#cb209-11" aria-hidden="true" tabindex="-1"></a>      };</span>
<span id="cb209-12"><a href="多样本位置参数.html#cb209-12" aria-hidden="true" tabindex="-1"></a>    };</span>
<span id="cb209-13"><a href="多样本位置参数.html#cb209-13" aria-hidden="true" tabindex="-1"></a>    A</span>
<span id="cb209-14"><a href="多样本位置参数.html#cb209-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb209-15"><a href="多样本位置参数.html#cb209-15" aria-hidden="true" tabindex="-1"></a>  B<span class="ot">=</span><span class="fu">perm</span>(k); <span class="co"># all possible permutations</span></span>
<span id="cb209-16"><a href="多样本位置参数.html#cb209-16" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">=</span><span class="fu">nrow</span>(B);ind<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nn,<span class="at">each=</span>nn<span class="sc">^</span>(b<span class="dv">-1</span>));</span>
<span id="cb209-17"><a href="多样本位置参数.html#cb209-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(b<span class="dv">-1</span>)){</span>
<span id="cb209-18"><a href="多样本位置参数.html#cb209-18" aria-hidden="true" tabindex="-1"></a>    ind<span class="ot">=</span><span class="fu">cbind</span>(ind,<span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>nn,<span class="at">each=</span>nn<span class="sc">^</span>(b<span class="dv">-1</span><span class="sc">-</span>i)),nn<span class="sc">^</span>(i)))</span>
<span id="cb209-19"><a href="多样本位置参数.html#cb209-19" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb209-20"><a href="多样本位置参数.html#cb209-20" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">=</span><span class="fu">nrow</span>(ind);y<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,nn);</span>
<span id="cb209-21"><a href="多样本位置参数.html#cb209-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nn){</span>
<span id="cb209-22"><a href="多样本位置参数.html#cb209-22" aria-hidden="true" tabindex="-1"></a>    R<span class="ot">=</span><span class="fu">apply</span>(B[ind[i,],],<span class="dv">2</span>,sum);</span>
<span id="cb209-23"><a href="多样本位置参数.html#cb209-23" aria-hidden="true" tabindex="-1"></a>    y[i]<span class="ot">=</span><span class="fu">sum</span>((<span class="dv">1</span><span class="sc">:</span>k)<span class="sc">*</span>R)</span>
<span id="cb209-24"><a href="多样本位置参数.html#cb209-24" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb209-25"><a href="多样本位置参数.html#cb209-25" aria-hidden="true" tabindex="-1"></a>  y0<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(y));</span>
<span id="cb209-26"><a href="多样本位置参数.html#cb209-26" aria-hidden="true" tabindex="-1"></a>  ycnt<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb209-27"><a href="多样本位置参数.html#cb209-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y0)) ycnt<span class="ot">=</span><span class="fu">c</span>(ycnt, <span class="fu">length</span>(y[y<span class="sc">==</span>y0[i]]));</span>
<span id="cb209-28"><a href="多样本位置参数.html#cb209-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(y0,ycnt<span class="sc">/</span>nn,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">ylab=</span><span class="st">&quot;density function&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Page检验统计量&quot;</span>);</span>
<span id="cb209-29"><a href="多样本位置参数.html#cb209-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y0)) <span class="fu">points</span>(<span class="fu">c</span>(y0[i],y0[i]),<span class="fu">c</span>(ycnt[i]<span class="sc">/</span>nn,<span class="dv">0</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb209-30"><a href="多样本位置参数.html#cb209-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">cbind</span>(<span class="at">L=</span>y0,<span class="at">pvalue=</span>ycnt<span class="sc">/</span>nn),<span class="at">Pvalue=</span><span class="fu">length</span>(y[y<span class="sc">&gt;=</span>L0])<span class="sc">/</span>nn)</span>
<span id="cb209-31"><a href="多样本位置参数.html#cb209-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb209-32"><a href="多样本位置参数.html#cb209-32" aria-hidden="true" tabindex="-1"></a><span class="fu">Page</span>()</span></code></pre></div>
<p><img src="04_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre><code>## [[1]]
##        L       pvalue
##  [1,] 40 0.0007716049
##  [2,] 41 0.0061728395
##  [3,] 42 0.0185185185
##  [4,] 43 0.0308641975
##  [5,] 44 0.0524691358
##  [6,] 45 0.0925925926
##  [7,] 46 0.1049382716
##  [8,] 47 0.1172839506
##  [9,] 48 0.1527777778
## [10,] 49 0.1172839506
## [11,] 50 0.1049382716
## [12,] 51 0.0925925926
## [13,] 52 0.0524691358
## [14,] 53 0.0308641975
## [15,] 54 0.0185185185
## [16,] 55 0.0061728395
## [17,] 56 0.0007716049
## 
## $Pvalue
## [1] 0.006944444</code></pre>
</div>
<div id="大样本近似-7" class="section level3 hasAnchor" number="4.7.2">
<h3><span class="header-section-number">4.7.2</span> 大样本近似<a href="多样本位置参数.html#大样本近似-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="多样本位置参数.html#cb211-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/blead1.txt&quot;</span>);rd<span class="ot">=</span><span class="fu">apply</span>(d,<span class="dv">1</span>,rank)</span>
<span id="cb211-2"><a href="多样本位置参数.html#cb211-2" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span><span class="fu">apply</span>(rd,<span class="dv">1</span>,sum);(<span class="at">L=</span><span class="fu">sum</span>(R<span class="sc">*</span><span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(R)));k<span class="ot">=</span><span class="fu">dim</span>(d)[<span class="dv">2</span>];b<span class="ot">=</span><span class="fu">dim</span>(d)[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [1] 55</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="多样本位置参数.html#cb213-1" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span>b<span class="sc">*</span>k<span class="sc">*</span>(k<span class="sc">+</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">4</span>;s<span class="ot">=</span><span class="fu">sqrt</span>(b<span class="sc">*</span>(k<span class="sc">^</span><span class="dv">3</span><span class="sc">-</span>k)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">144</span><span class="sc">/</span>(k<span class="dv">-1</span>));Z<span class="ot">=</span>(L<span class="sc">-</span>m)<span class="sc">/</span>s</span>
<span id="cb213-2"><a href="多样本位置参数.html#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(Z,<span class="at">low=</span>F)</span></code></pre></div>
<pre><code>## [1] 0.006664164</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="多样本位置参数.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co">#library(concord)</span></span>
<span id="cb215-2"><a href="多样本位置参数.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co">#page.trend.test(d)</span></span></code></pre></div>
</div>
</div>
<div id="durbin检验" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> 4.9 Durbin检验<a href="多样本位置参数.html#durbin检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>不完全区组设计</li>
<li>与Friedman检验相似</li>
</ul>
<div id="精确检验-6" class="section level3 hasAnchor" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> 精确检验<a href="多样本位置参数.html#精确检验-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="多样本位置参数.html#cb216-1" aria-hidden="true" tabindex="-1"></a>Durbin<span class="ot">=</span><span class="cf">function</span>(<span class="at">k=</span><span class="dv">4</span>,<span class="at">t=</span><span class="dv">3</span>,<span class="at">b=</span><span class="dv">4</span>,<span class="at">r=</span><span class="dv">3</span>,<span class="at">D0=</span><span class="fl">6.75</span>){</span>
<span id="cb216-2"><a href="多样本位置参数.html#cb216-2" aria-hidden="true" tabindex="-1"></a>  B<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb216-3"><a href="多样本位置参数.html#cb216-3" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">=</span><span class="dv">6</span><span class="sc">^</span>b;</span>
<span id="cb216-4"><a href="多样本位置参数.html#cb216-4" aria-hidden="true" tabindex="-1"></a>  Numfunc<span class="ot">=</span><span class="cf">function</span>(r,b,nnum){</span>
<span id="cb216-5"><a href="多样本位置参数.html#cb216-5" aria-hidden="true" tabindex="-1"></a>    ind<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,b);temp<span class="ot">=</span>nnum;</span>
<span id="cb216-6"><a href="多样本位置参数.html#cb216-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>b){</span>
<span id="cb216-7"><a href="多样本位置参数.html#cb216-7" aria-hidden="true" tabindex="-1"></a>      ind[i]<span class="ot">=</span><span class="fu">floor</span>(temp<span class="sc">/</span>(<span class="dv">6</span><span class="sc">^</span>(b<span class="sc">-</span>i)))</span>
<span id="cb216-8"><a href="多样本位置参数.html#cb216-8" aria-hidden="true" tabindex="-1"></a>      temp<span class="ot">=</span>temp<span class="sc">-</span>ind[i]<span class="sc">*</span><span class="dv">6</span><span class="sc">^</span>(b<span class="sc">-</span>i)</span>
<span id="cb216-9"><a href="多样本位置参数.html#cb216-9" aria-hidden="true" tabindex="-1"></a>    };</span>
<span id="cb216-10"><a href="多样本位置参数.html#cb216-10" aria-hidden="true" tabindex="-1"></a>    ind</span>
<span id="cb216-11"><a href="多样本位置参数.html#cb216-11" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb216-12"><a href="多样本位置参数.html#cb216-12" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span><span class="dv">0</span>;<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(nn<span class="dv">-1</span>)){</span>
<span id="cb216-13"><a href="多样本位置参数.html#cb216-13" aria-hidden="true" tabindex="-1"></a>    A<span class="ot">=</span>B[,<span class="fu">Numfunc</span>(r,b,i)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb216-14"><a href="多样本位置参数.html#cb216-14" aria-hidden="true" tabindex="-1"></a>    R<span class="ot">=</span><span class="fu">c</span>(<span class="fu">sum</span>(A[<span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),<span class="fu">sum</span>(A[<span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])<span class="sc">+</span>A[<span class="dv">1</span>,<span class="dv">4</span>],A[<span class="dv">3</span>,<span class="dv">1</span>]<span class="sc">+</span><span class="fu">sum</span>(A[<span class="dv">2</span>,<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>]),<span class="fu">sum</span>(A[<span class="dv">3</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))</span>
<span id="cb216-15"><a href="多样本位置参数.html#cb216-15" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">=</span><span class="fu">c</span>(y,<span class="dv">12</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(r<span class="sc">*</span>k<span class="sc">*</span>(t<span class="sc">^</span><span class="dv">2-1</span>))<span class="sc">*</span><span class="fu">sum</span>((R<span class="sc">-</span>r<span class="sc">*</span>(t<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb216-16"><a href="多样本位置参数.html#cb216-16" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb216-17"><a href="多样本位置参数.html#cb216-17" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">=</span>y[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(y)];</span>
<span id="cb216-18"><a href="多样本位置参数.html#cb216-18" aria-hidden="true" tabindex="-1"></a>  pvalue<span class="ot">=</span><span class="fu">sum</span>(y<span class="sc">&gt;=</span>D0)<span class="sc">/</span>nn;y0<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(y));</span>
<span id="cb216-19"><a href="多样本位置参数.html#cb216-19" aria-hidden="true" tabindex="-1"></a>  ycnt<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb216-20"><a href="多样本位置参数.html#cb216-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y0)) ycnt<span class="ot">=</span><span class="fu">c</span>(ycnt, <span class="fu">length</span>(y[y<span class="sc">==</span>y0[i]]));</span>
<span id="cb216-21"><a href="多样本位置参数.html#cb216-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(y0,ycnt<span class="sc">/</span>nn,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">ylab=</span><span class="st">&quot;density function&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Durbin检验统计量&quot;</span>);</span>
<span id="cb216-22"><a href="多样本位置参数.html#cb216-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(y0)) <span class="fu">points</span>(<span class="fu">c</span>(y0[i],y0[i]),<span class="fu">c</span>(ycnt[i]<span class="sc">/</span>nn,<span class="dv">0</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb216-23"><a href="多样本位置参数.html#cb216-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">cbind</span>(<span class="st">&quot;k&quot;</span><span class="ot">=</span>k,<span class="st">&quot;b&quot;</span><span class="ot">=</span>b,<span class="st">&quot;r&quot;</span><span class="ot">=</span>r,<span class="st">&quot;t&quot;</span><span class="ot">=</span>t,<span class="st">&quot;pvalue&quot;</span><span class="ot">=</span>pvalue),<span class="fu">cbind</span>(y0,ycnt))</span>
<span id="cb216-24"><a href="多样本位置参数.html#cb216-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb216-25"><a href="多样本位置参数.html#cb216-25" aria-hidden="true" tabindex="-1"></a><span class="fu">Durbin</span>()</span></code></pre></div>
<p><img src="04_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre><code>## [[1]]
##      k b r t     pvalue
## [1,] 4 4 3 3 0.07407407
## 
## [[2]]
##         y0 ycnt
##  [1,] 0.00   24
##  [2,] 0.75  264
##  [3,] 1.50  120
##  [4,] 2.25  288
##  [5,] 3.00   96
##  [6,] 3.75  144
##  [7,] 4.50   48
##  [8,] 5.25  192
##  [9,] 6.00   24
## [10,] 6.75   72
## [11,] 7.50   24</code></pre>
</div>
<div id="大样本近似-8" class="section level3 hasAnchor" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> 大样本近似<a href="多样本位置参数.html#大样本近似-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="多样本位置参数.html#cb218-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/mater.txt&quot;</span>);</span>
<span id="cb218-2"><a href="多样本位置参数.html#cb218-2" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">max</span>(d[,<span class="dv">2</span>]);b<span class="ot">=</span><span class="fu">max</span>(d[,<span class="dv">3</span>]);t<span class="ot">=</span><span class="fu">length</span>(d[d[,<span class="dv">3</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>]);</span>
<span id="cb218-3"><a href="多样本位置参数.html#cb218-3" aria-hidden="true" tabindex="-1"></a>r<span class="ot">=</span><span class="fu">length</span>(d[d[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span>]);</span>
<span id="cb218-4"><a href="多样本位置参数.html#cb218-4" aria-hidden="true" tabindex="-1"></a>R<span class="ot">=</span>d;<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>b) R[d[,<span class="dv">3</span>]<span class="sc">==</span>i,<span class="dv">1</span>]<span class="ot">=</span><span class="fu">rank</span>(d[d[,<span class="dv">3</span>]<span class="sc">==</span>i,<span class="dv">1</span>]);</span>
<span id="cb218-5"><a href="多样本位置参数.html#cb218-5" aria-hidden="true" tabindex="-1"></a>RV<span class="ot">=</span><span class="cn">NULL</span>;<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) RV<span class="ot">=</span><span class="fu">c</span>(RV,<span class="fu">sum</span>(R[R[,<span class="dv">2</span>]<span class="sc">==</span>i,<span class="dv">1</span>]));</span>
<span id="cb218-6"><a href="多样本位置参数.html#cb218-6" aria-hidden="true" tabindex="-1"></a>D<span class="ot">=</span><span class="dv">12</span><span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">/</span>(r<span class="sc">*</span>k<span class="sc">*</span>(t<span class="sc">^</span><span class="dv">2-1</span>))<span class="sc">*</span><span class="fu">sum</span>((RV<span class="sc">-</span>r<span class="sc">*</span>(t<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span>);</span>
<span id="cb218-7"><a href="多样本位置参数.html#cb218-7" aria-hidden="true" tabindex="-1"></a>pvalue.chi<span class="ot">=</span><span class="fu">pchisq</span>(D,k<span class="dv">-1</span>,<span class="at">low=</span>F)</span>
<span id="cb218-8"><a href="多样本位置参数.html#cb218-8" aria-hidden="true" tabindex="-1"></a>A<span class="ot">=</span><span class="fu">sum</span>(R[,<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>);C<span class="ot">=</span>b<span class="sc">*</span>t<span class="sc">*</span>(t<span class="sc">+</span><span class="dv">1</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">4</span>;</span>
<span id="cb218-9"><a href="多样本位置参数.html#cb218-9" aria-hidden="true" tabindex="-1"></a>(<span class="at">D=</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((RV<span class="sc">-</span>r<span class="sc">*</span>(t<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(A<span class="sc">-</span>C));</span></code></pre></div>
<pre><code>## [1] 6.75</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="多样本位置参数.html#cb220-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">pvalue.chi=</span><span class="fu">pchisq</span>(D,k<span class="dv">-1</span>,<span class="at">low=</span>F))</span></code></pre></div>
<pre><code>## [1] 0.08030773</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="双样本位置参数.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="尺度参数.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-template.pdf", "bookdown-template.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
