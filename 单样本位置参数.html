<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 2 章 单样本位置参数 | 非参数统计</title>
  <meta name="description" content="description" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="第 2 章 单样本位置参数 | 非参数统计" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="description" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 2 章 单样本位置参数 | 非参数统计" />
  
  <meta name="twitter:description" content="description" />
  

<meta name="author" content="Sifan Liu, TJUFE" />


<meta name="date" content="2022-08-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="概述.html"/>
<link rel="next" href="双样本位置参数.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Title</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="概述.html"><a href="概述.html"><i class="fa fa-check"></i><b>1</b> 概述</a>
<ul>
<li class="chapter" data-level="1.1" data-path="概述.html"><a href="概述.html#习题1-1.5-数据可视化查看对总体分布的假设是否合理"><i class="fa fa-check"></i><b>1.1</b> 习题1: (1.5 数据可视化，查看对总体分布的假设是否合理)</a></li>
<li class="chapter" data-level="1.2" data-path="概述.html"><a href="概述.html#数据变换box-cox变换"><i class="fa fa-check"></i><b>1.2</b> 数据变换（Box-Cox变换）</a></li>
<li class="chapter" data-level="1.3" data-path="概述.html"><a href="概述.html#section"><i class="fa fa-check"></i><b>1.3</b> 2.(1)</a></li>
<li class="chapter" data-level="1.4" data-path="概述.html"><a href="概述.html#section-1"><i class="fa fa-check"></i><b>1.4</b> 2.(2)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="单样本位置参数.html"><a href="单样本位置参数.html"><i class="fa fa-check"></i><b>2</b> 单样本位置参数</a>
<ul>
<li class="chapter" data-level="2.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#引入的例子楼盘均价"><i class="fa fa-check"></i><b>2.1</b> 引入的例子：楼盘均价</a></li>
<li class="chapter" data-level="2.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#符号检验-sign-test"><i class="fa fa-check"></i><b>2.2</b> 2.1 符号检验 Sign Test</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#广义符号检验"><i class="fa fa-check"></i><b>2.2.1</b> 2.1.1. 广义符号检验</a></li>
<li class="chapter" data-level="2.2.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#分位点的置信区间"><i class="fa fa-check"></i><b>2.2.2</b> 2.1.2 分位点的置信区间</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="单样本位置参数.html"><a href="单样本位置参数.html#wilcoxon符号秩检验wilcoxon-sign-rank"><i class="fa fa-check"></i><b>2.3</b> 2.2 Wilcoxon符号秩检验(Wilcoxon Sign Rank)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#检验"><i class="fa fa-check"></i><b>2.3.1</b> 2.2.1 检验</a></li>
<li class="chapter" data-level="2.3.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#置信区间"><i class="fa fa-check"></i><b>2.3.2</b> 2.2.2 置信区间</a></li>
<li class="chapter" data-level="2.3.3" data-path="单样本位置参数.html"><a href="单样本位置参数.html#simulation-study"><i class="fa fa-check"></i><b>2.3.3</b> simulation study</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="单样本位置参数.html"><a href="单样本位置参数.html#正态记分检验normal-score"><i class="fa fa-check"></i><b>2.4</b> 2.3 正态记分检验*(normal score)</a></li>
<li class="chapter" data-level="2.5" data-path="单样本位置参数.html"><a href="单样本位置参数.html#cox-stuart趋势检验"><i class="fa fa-check"></i><b>2.5</b> 2.4 Cox-Stuart趋势检验*</a></li>
<li class="chapter" data-level="2.6" data-path="单样本位置参数.html"><a href="单样本位置参数.html#随机性的游程检验"><i class="fa fa-check"></i><b>2.6</b> 2.5 随机性的游程检验*</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="双样本位置参数.html"><a href="双样本位置参数.html"><i class="fa fa-check"></i><b>3</b> 双样本位置参数</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子零件疲劳强度测试"><i class="fa fa-check"></i><b>3.0.1</b> 例子：零件疲劳强度测试</a></li>
<li class="chapter" data-level="3.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#brown-mood中位数检验"><i class="fa fa-check"></i><b>3.1</b> 3.1 Brown-Mood中位数检验</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#精确检验"><i class="fa fa-check"></i><b>3.1.1</b> 精确检验</a></li>
<li class="chapter" data-level="3.1.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#大样本近似"><i class="fa fa-check"></i><b>3.1.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#wilcoxon秩和检验"><i class="fa fa-check"></i><b>3.2</b> 3.2 Wilcoxon秩和检验</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例wilcoxon-test-for-stochastic-ordering-of-alternatives"><i class="fa fa-check"></i><b>3.2.1</b> *例：Wilcoxon Test for Stochastic Ordering of Alternatives</a></li>
<li class="chapter" data-level="3.2.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例-analyses-for-a-shift-in-location"><i class="fa fa-check"></i><b>3.2.2</b> *例： Analyses for a Shift in Location</a></li>
<li class="chapter" data-level="3.2.3" data-path="双样本位置参数.html"><a href="双样本位置参数.html#假设检验"><i class="fa fa-check"></i><b>3.2.3</b> 3.2.1 假设检验</a></li>
<li class="chapter" data-level="3.2.4" data-path="双样本位置参数.html"><a href="双样本位置参数.html#置信区间-1"><i class="fa fa-check"></i><b>3.2.4</b> 3.2.2 置信区间</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="双样本位置参数.html"><a href="双样本位置参数.html#正态记分normal-score检验"><i class="fa fa-check"></i><b>3.3</b> 3.3 正态记分（normal score）检验</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子salary"><i class="fa fa-check"></i><b>3.3.1</b> 例子：salary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="双样本位置参数.html"><a href="双样本位置参数.html#成对数据的检验"><i class="fa fa-check"></i><b>3.4</b> 3.4 成对数据的检验</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子实施管理前后"><i class="fa fa-check"></i><b>3.4.1</b> 例子：实施管理前后</a></li>
<li class="chapter" data-level="3.4.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子病人血压"><i class="fa fa-check"></i><b>3.4.2</b> 例子：病人血压</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="双样本位置参数.html"><a href="双样本位置参数.html#mcnemar检验"><i class="fa fa-check"></i><b>3.5</b> 3.5 McNemar检验</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#精确检验-1"><i class="fa fa-check"></i><b>3.5.1</b> 精确检验</a></li>
<li class="chapter" data-level="3.5.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#大样本近似-1"><i class="fa fa-check"></i><b>3.5.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="双样本位置参数.html"><a href="双样本位置参数.html#cohens-kappa系数"><i class="fa fa-check"></i><b>3.6</b> 3.6 Cohen’s Kappa系数</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="多样本位置参数.html"><a href="多样本位置参数.html"><i class="fa fa-check"></i><b>4</b> 多样本位置参数</a>
<ul>
<li class="chapter" data-level="4.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#kruskal-wallis秩和检验"><i class="fa fa-check"></i><b>4.1</b> 4.1 Kruskal-Wallis秩和检验</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#例训练方式"><i class="fa fa-check"></i><b>4.1.1</b> 例：训练方式</a></li>
<li class="chapter" data-level="4.1.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-2"><i class="fa fa-check"></i><b>4.1.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#正态记分检验"><i class="fa fa-check"></i><b>4.2</b> 4.2 正态记分检验</a></li>
<li class="chapter" data-level="4.3" data-path="多样本位置参数.html"><a href="多样本位置参数.html#jonckheere-terpstra检验"><i class="fa fa-check"></i><b>4.3</b> 4.3 Jonckheere-Terpstra检验</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-2"><i class="fa fa-check"></i><b>4.3.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.3.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-3"><i class="fa fa-check"></i><b>4.3.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="多样本位置参数.html"><a href="多样本位置参数.html#完全区组设计friedman秩和检验"><i class="fa fa-check"></i><b>4.4</b> 4.5 完全区组设计：Friedman秩和检验</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-3"><i class="fa fa-check"></i><b>4.4.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.4.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-4"><i class="fa fa-check"></i><b>4.4.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="多样本位置参数.html"><a href="多样本位置参数.html#kendall协同系数检验"><i class="fa fa-check"></i><b>4.5</b> 4.6 Kendall协同系数检验</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-5"><i class="fa fa-check"></i><b>4.5.1</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="多样本位置参数.html"><a href="多样本位置参数.html#cochran检验"><i class="fa fa-check"></i><b>4.6</b> 4.7 Cochran检验</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-4"><i class="fa fa-check"></i><b>4.6.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.6.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-6"><i class="fa fa-check"></i><b>4.6.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="多样本位置参数.html"><a href="多样本位置参数.html#page检验"><i class="fa fa-check"></i><b>4.7</b> 4.8 Page检验</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-5"><i class="fa fa-check"></i><b>4.7.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.7.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-7"><i class="fa fa-check"></i><b>4.7.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="多样本位置参数.html"><a href="多样本位置参数.html#durbin检验"><i class="fa fa-check"></i><b>4.8</b> 4.9 Durbin检验</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-6"><i class="fa fa-check"></i><b>4.8.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.8.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-8"><i class="fa fa-check"></i><b>4.8.2</b> 大样本近似</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="尺度参数.html"><a href="尺度参数.html"><i class="fa fa-check"></i><b>5</b> 尺度参数</a>
<ul>
<li class="chapter" data-level="5.1" data-path="尺度参数.html"><a href="尺度参数.html#两独立样本的siegel-tukey方差检验"><i class="fa fa-check"></i><b>5.1</b> 5.1 两独立样本的Siegel-Tukey方差检验</a></li>
<li class="chapter" data-level="5.2" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度参数的mood检验"><i class="fa fa-check"></i><b>5.2</b> 5.2 两样本尺度参数的Mood检验</a></li>
<li class="chapter" data-level="5.3" data-path="尺度参数.html"><a href="尺度参数.html#ansari-bradley检验"><i class="fa fa-check"></i><b>5.3</b> 5.3 Ansari-Bradley检验</a></li>
<li class="chapter" data-level="5.4" data-path="尺度参数.html"><a href="尺度参数.html#fligner-killeen检验"><i class="fa fa-check"></i><b>5.4</b> 5.4 Fligner-Killeen检验</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度的精确检验"><i class="fa fa-check"></i><b>5.4.1</b> 两样本尺度的精确检验</a></li>
<li class="chapter" data-level="5.4.2" data-path="尺度参数.html"><a href="尺度参数.html#多样本尺度的大样本近似"><i class="fa fa-check"></i><b>5.4.2</b> 多样本尺度的大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度的平方秩检验"><i class="fa fa-check"></i><b>5.5</b> 5.5 两样本尺度的平方秩检验</a></li>
<li class="chapter" data-level="5.6" data-path="尺度参数.html"><a href="尺度参数.html#多样本尺度的平方秩检验"><i class="fa fa-check"></i><b>5.6</b> 5.6 多样本尺度的平方秩检验</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="相关.html"><a href="相关.html"><i class="fa fa-check"></i><b>6</b> 相关</a>
<ul>
<li class="chapter" data-level="6.1" data-path="相关.html"><a href="相关.html#spearman秩相关检验"><i class="fa fa-check"></i><b>6.1</b> 6.1 Spearman秩相关检验</a></li>
<li class="chapter" data-level="6.2" data-path="相关.html"><a href="相关.html#kendall-tau-相关检验"><i class="fa fa-check"></i><b>6.2</b> 6.2 Kendall <span class="math inline">\(\tau\)</span> 相关检验</a></li>
<li class="chapter" data-level="6.3" data-path="相关.html"><a href="相关.html#goodman-kruskals-gamma-相关检验"><i class="fa fa-check"></i><b>6.3</b> 6.3 Goodman-Kruskal’s <span class="math inline">\(\gamma\)</span> 相关检验</a></li>
<li class="chapter" data-level="6.4" data-path="相关.html"><a href="相关.html#somersd-相关检验"><i class="fa fa-check"></i><b>6.4</b> 6.4 Somers’d 相关检验</a></li>
<li class="chapter" data-level="6.5" data-path="相关.html"><a href="相关.html#theil非参数回归"><i class="fa fa-check"></i><b>6.5</b> 6.5 Theil非参数回归</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="相关.html"><a href="相关.html#几种稳健回归"><i class="fa fa-check"></i><b>6.5.1</b> 几种稳健回归</a></li>
<li class="chapter" data-level="6.5.2" data-path="相关.html"><a href="相关.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.5.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="6.5.3" data-path="相关.html"><a href="相关.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.5.3</b> Multiple Linear Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="分布检验.html"><a href="分布检验.html"><i class="fa fa-check"></i><b>7</b> 分布检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="分布检验.html"><a href="分布检验.html#q-q图"><i class="fa fa-check"></i><b>7.1</b> Q-Q图</a></li>
<li class="chapter" data-level="7.2" data-path="分布检验.html"><a href="分布检验.html#kolmogorov-smirnov单样本检验"><i class="fa fa-check"></i><b>7.2</b> 7.1 Kolmogorov-Smirnov单样本检验</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="分布检验.html"><a href="分布检验.html#ks检验"><i class="fa fa-check"></i><b>7.2.1</b> KS检验</a></li>
<li class="chapter" data-level="7.2.2" data-path="分布检验.html"><a href="分布检验.html#正态性检验"><i class="fa fa-check"></i><b>7.2.2</b> 正态性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="分布检验.html"><a href="分布检验.html#kolmogorov-smirnov两样本分布检验"><i class="fa fa-check"></i><b>7.3</b> 7.2 Kolmogorov-Smirnov两样本分布检验</a></li>
<li class="chapter" data-level="7.4" data-path="分布检验.html"><a href="分布检验.html#pearson-chi2-拟合优度检验"><i class="fa fa-check"></i><b>7.4</b> 7.3 Pearson <span class="math inline">\(\chi^2\)</span> 拟合优度检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="分布检验.html"><a href="分布检验.html#goodness-of-fit-tests-for-a-single-discrete-random-variable"><i class="fa fa-check"></i><b>7.4.1</b> Goodness-of-Fit Tests for a Single Discrete Random Variable</a></li>
<li class="chapter" data-level="7.4.2" data-path="分布检验.html"><a href="分布检验.html#several-discrete-random-variables"><i class="fa fa-check"></i><b>7.4.2</b> Several Discrete Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="列联表.html"><a href="列联表.html"><i class="fa fa-check"></i><b>8</b> 列联表</a>
<ul>
<li class="chapter" data-level="8.1" data-path="列联表.html"><a href="列联表.html#二维列联表的齐性和独立性的chi2检验"><i class="fa fa-check"></i><b>8.1</b> 二维列联表的齐性和独立性的<span class="math inline">\(\chi^2\)</span>检验</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="列联表.html"><a href="列联表.html#齐性"><i class="fa fa-check"></i><b>8.1.1</b> 齐性</a></li>
<li class="chapter" data-level="8.1.2" data-path="列联表.html"><a href="列联表.html#独立性"><i class="fa fa-check"></i><b>8.1.2</b> 独立性</a></li>
<li class="chapter" data-level="8.1.3" data-path="列联表.html"><a href="列联表.html#independence-of-two-discrete-random-variables-例子吸烟与肺癌"><i class="fa fa-check"></i><b>8.1.3</b> Independence of Two Discrete Random Variables （例子：吸烟与肺癌）</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="列联表.html"><a href="列联表.html#低维列联表的fisher精确检验"><i class="fa fa-check"></i><b>8.2</b> 8.2 低维列联表的Fisher精确检验</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="列联表.html"><a href="列联表.html#数据为表格形式"><i class="fa fa-check"></i><b>8.2.1</b> 数据为表格形式</a></li>
<li class="chapter" data-level="8.2.2" data-path="列联表.html"><a href="列联表.html#数据为数据框格式"><i class="fa fa-check"></i><b>8.2.2</b> 数据为数据框格式</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="列联表.html"><a href="列联表.html#两个比例的比较"><i class="fa fa-check"></i><b>8.3</b> 8.3 两个比例的比较</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="列联表.html"><a href="列联表.html#例8.3-关于中风的研究"><i class="fa fa-check"></i><b>8.3.1</b> 例8.3 关于中风的研究</a></li>
<li class="chapter" data-level="8.3.2" data-path="列联表.html"><a href="列联表.html#one-sample-problems"><i class="fa fa-check"></i><b>8.3.2</b> One-Sample Problems*</a></li>
<li class="chapter" data-level="8.3.3" data-path="列联表.html"><a href="列联表.html#two-sample-problems"><i class="fa fa-check"></i><b>8.3.3</b> Two-Sample Problems*</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="列联表.html"><a href="列联表.html#cochran-mantel-haenszel估计"><i class="fa fa-check"></i><b>8.4</b> 8.4 Cochran-Mantel-Haenszel估计</a></li>
<li class="chapter" data-level="8.5" data-path="列联表.html"><a href="列联表.html#对数线性模型与高维列联表的独立性"><i class="fa fa-check"></i><b>8.5</b> 8.5 对数线性模型与高维列联表的独立性</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="密度估计和回归.html"><a href="密度估计和回归.html"><i class="fa fa-check"></i><b>9</b> 密度估计和回归</a>
<ul>
<li class="chapter" data-level="9.1" data-path="密度估计和回归.html"><a href="密度估计和回归.html#非参数密度估计"><i class="fa fa-check"></i><b>9.1</b> 非参数密度估计</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="密度估计和回归.html"><a href="密度估计和回归.html#一元密度估计"><i class="fa fa-check"></i><b>9.1.1</b> 一元密度估计</a></li>
<li class="chapter" data-level="9.1.2" data-path="密度估计和回归.html"><a href="密度估计和回归.html#多元密度估计"><i class="fa fa-check"></i><b>9.1.2</b> 多元密度估计</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="密度估计和回归.html"><a href="密度估计和回归.html#非参数回归"><i class="fa fa-check"></i><b>9.2</b> 非参数回归</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>10</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bootstrap.html"><a href="bootstrap.html#percentile-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>10.1</b> Percentile Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="10.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-tests-of-hypotheses"><i class="fa fa-check"></i><b>10.2</b> Bootstrap Tests of Hypotheses</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="bootstrap.html"><a href="bootstrap.html#nursery-school-intervention"><i class="fa fa-check"></i><b>10.2.1</b> Nursery School Intervention</a></li>
<li class="chapter" data-level="10.2.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-test-for-sample-mean"><i class="fa fa-check"></i><b>10.2.2</b> Bootstrap test for sample mean</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">非参数统计</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="单样本位置参数" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">第 2 章</span> 单样本位置参数<a href="单样本位置参数.html#单样本位置参数" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="引入的例子楼盘均价" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> 引入的例子：楼盘均价<a href="单样本位置参数.html#引入的例子楼盘均价" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="单样本位置参数.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">##数据</span></span>
<span id="cb13-2"><a href="单样本位置参数.html#cb13-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">32</span>, <span class="dv">31</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">36</span>, <span class="dv">40</span>, <span class="dv">32</span>, <span class="dv">41</span>, <span class="dv">26</span>, <span class="dv">35</span>, <span class="dv">35</span>, <span class="dv">32</span>, <span class="dv">87</span>, <span class="dv">33</span>, <span class="dv">35</span>)</span>
<span id="cb13-3"><a href="单样本位置参数.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">##单样本t检验</span></span>
<span id="cb13-4"><a href="单样本位置参数.html#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x1,<span class="at">mu=</span><span class="dv">37</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  x1
## t = -0.14123, df = 15, p-value = 0.8896
## alternative hypothesis: true mean is not equal to 37
## 95 percent confidence interval:
##  28.95415 44.04585
## sample estimates:
## mean of x 
##      36.5</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="单样本位置参数.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">##直方图</span></span>
<span id="cb15-2"><a href="单样本位置参数.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x1)</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="单样本位置参数.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="do">##向量计算</span></span>
<span id="cb16-2"><a href="单样本位置参数.html#cb16-2" aria-hidden="true" tabindex="-1"></a>x1<span class="dv">-37</span></span></code></pre></div>
<pre><code>##  [1]  -1  -5  -6 -12  -9  -1   3  -5   4 -11  -2  -2  -5  50  -4  -2</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="单样本位置参数.html#cb18-1" aria-hidden="true" tabindex="-1"></a>(x1<span class="sc">&lt;</span><span class="dv">37</span>)</span></code></pre></div>
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE  TRUE  TRUE
## [13]  TRUE FALSE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="单样本位置参数.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">##sign test</span></span>
<span id="cb20-2"><a href="单样本位置参数.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BSDA)</span></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;BSDA&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:datasets&#39;:
## 
##     Orange</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="单样本位置参数.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SIGN.test</span>(x1,<span class="at">md=</span><span class="dv">37</span>,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  One-sample Sign-Test
## 
## data:  x1
## s = 3, p-value = 0.02127
## alternative hypothesis: true median is not equal to 37
## 95 percent confidence interval:
##  31.51725 36.00000
## sample estimates:
## median of x 
##          34 
## 
## Achieved and Interpolated Confidence Intervals: 
## 
##                   Conf.Level  L.E.pt U.E.pt
## Lower Achieved CI     0.9232 32.0000     36
## Interpolated CI       0.9500 31.5173     36
## Upper Achieved CI     0.9787 31.0000     36</code></pre>
<ul>
<li>检验统计量<span class="math inline">\(S=\min\{S^+,S^-\}\)</span>,<span class="math inline">\(S^+=\#\{X&gt;median\}\)</span>,<span class="math inline">\(S^-=\#\{X&lt;median\}\)</span>;</li>
<li><span class="math inline">\(n=s^++s^-\)</span>;</li>
<li>p值=<span class="math inline">\(2P(S\leq s)\)</span>，<span class="math inline">\(S \sim B(n,0.5)\)</span></li>
</ul>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="单样本位置参数.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">12</span>,<span class="dv">16</span>,<span class="fl">0.5</span>)) <span class="co">#2P(S&gt;=n-s)=2P(S&gt;=13)=2[1-P(S&lt;=12)]</span></span></code></pre></div>
<pre><code>## [1] 0.02127075</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="单样本位置参数.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span><span class="fu">pbinom</span>(<span class="dv">3</span>,<span class="dv">16</span>,<span class="fl">0.5</span>) <span class="co">#2P(S&lt;=s)=2P(S&lt;=3)</span></span></code></pre></div>
<pre><code>## [1] 0.02127075</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="单样本位置参数.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">##wilcoxon signed rank test</span></span>
<span id="cb30-2"><a href="单样本位置参数.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x1,<span class="at">mu=</span><span class="dv">37</span>,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(x1, mu = 37, alternative = &quot;two.sided&quot;): cannot
## compute exact p-value with ties</code></pre>
<pre><code>## 
##  Wilcoxon signed rank test with continuity correction
## 
## data:  x1
## V = 29.5, p-value = 0.04904
## alternative hypothesis: true location is not equal to 37</code></pre>
</div>
<div id="符号检验-sign-test" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> 2.1 符号检验 Sign Test<a href="单样本位置参数.html#符号检验-sign-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="广义符号检验" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> 2.1.1. 广义符号检验<a href="单样本位置参数.html#广义符号检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="sign.test只能处理中位数的问题" class="section level4 hasAnchor" number="2.2.1.1">
<h4><span class="header-section-number">2.2.1.1</span> SIGN.test只能处理中位数的问题<a href="单样本位置参数.html#sign.test只能处理中位数的问题" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="单样本位置参数.html#cb33-1" aria-hidden="true" tabindex="-1"></a>expens <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file=</span><span class="st">&quot;data/ExpensCities.TXT&quot;</span>)</span>
<span id="cb33-2"><a href="单样本位置参数.html#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">SIGN.test</span>(expens<span class="sc">$</span>V1,<span class="at">md=</span><span class="dv">64</span>,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  One-sample Sign-Test
## 
## data:  expens$V1
## s = 43, p-value = 0.09592
## alternative hypothesis: true median is not equal to 64
## 95 percent confidence interval:
##  63.28094 77.04644
## sample estimates:
## median of x 
##        67.7 
## 
## Achieved and Interpolated Confidence Intervals: 
## 
##                   Conf.Level  L.E.pt  U.E.pt
## Lower Achieved CI     0.9432 63.5000 76.8000
## Interpolated CI       0.9500 63.2809 77.0464
## Upper Achieved CI     0.9681 62.7000 77.7000</code></pre>
</div>
<div id="自定义函数广义符号检验" class="section level4 hasAnchor" number="2.2.1.2">
<h4><span class="header-section-number">2.2.1.2</span> 自定义函数：广义符号检验<a href="单样本位置参数.html#自定义函数广义符号检验" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="单样本位置参数.html#cb35-1" aria-hidden="true" tabindex="-1"></a>sign.test<span class="ot">=</span><span class="cf">function</span>(x,p,q0){</span>
<span id="cb35-2"><a href="单样本位置参数.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  s1<span class="ot">=</span><span class="fu">sum</span>(x<span class="sc">&lt;</span>q0);s2<span class="ot">=</span><span class="fu">sum</span>(x<span class="sc">&gt;</span>q0);n<span class="ot">=</span>s1<span class="sc">+</span>s2</span>
<span id="cb35-3"><a href="单样本位置参数.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  p1<span class="ot">=</span><span class="fu">pbinom</span>(s1,n,p);p2<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(s1<span class="dv">-1</span>,n,p)</span>
<span id="cb35-4"><a href="单样本位置参数.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p1<span class="sc">&gt;</span>p2){</span>
<span id="cb35-5"><a href="单样本位置参数.html#cb35-5" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span><span class="st">&quot;One tail test: H1: Q&lt;q0&quot;</span></span>
<span id="cb35-6"><a href="单样本位置参数.html#cb35-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-7"><a href="单样本位置参数.html#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb35-8"><a href="单样本位置参数.html#cb35-8" aria-hidden="true" tabindex="-1"></a>    m1<span class="ot">=</span><span class="st">&quot;One tail test: H1: Q&gt;q0&quot;</span></span>
<span id="cb35-9"><a href="单样本位置参数.html#cb35-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-10"><a href="单样本位置参数.html#cb35-10" aria-hidden="true" tabindex="-1"></a>  p.value<span class="ot">=</span><span class="fu">min</span>(p1,p2);m2<span class="ot">=</span><span class="st">&quot;Two tails test&quot;</span>;p.value2<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>p.value</span>
<span id="cb35-11"><a href="单样本位置参数.html#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (q0<span class="sc">==</span><span class="fu">median</span>(x)){</span>
<span id="cb35-12"><a href="单样本位置参数.html#cb35-12" aria-hidden="true" tabindex="-1"></a>    p.value<span class="ot">=</span><span class="fl">0.5</span>;p.value2<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb35-13"><a href="单样本位置参数.html#cb35-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-14"><a href="单样本位置参数.html#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">Sign.test1=</span>m1, <span class="at">p.values.of.one.tail.test=</span>p.value,</span>
<span id="cb35-15"><a href="单样本位置参数.html#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">p.value.of.two.tail.test=</span>p.value2)</span>
<span id="cb35-16"><a href="单样本位置参数.html#cb35-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-17"><a href="单样本位置参数.html#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="单样本位置参数.html#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="fu">sign.test</span>(expens<span class="sc">$</span>V1,<span class="fl">0.5</span>,<span class="dv">64</span>)</span></code></pre></div>
<pre><code>## $Sign.test1
## [1] &quot;One tail test: H1: Q&gt;q0&quot;
## 
## $p.values.of.one.tail.test
## [1] 0.04796182
## 
## $p.value.of.two.tail.test
## [1] 0.09592363</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="单样本位置参数.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sign.test</span>(expens<span class="sc">$</span>V1,<span class="fl">0.25</span>,<span class="dv">64</span>)</span></code></pre></div>
<pre><code>## $Sign.test1
## [1] &quot;One tail test: H1: Q&lt;q0&quot;
## 
## $p.values.of.one.tail.test
## [1] 0.005151879
## 
## $p.value.of.two.tail.test
## [1] 0.01030376</code></pre>
<ul>
<li><span class="math inline">\(H_0:Q_{0.25} \geq 64 \leftrightarrow H_1:Q_{0.25} &lt; 64\)</span>;</li>
<li>检验统计量<span class="math inline">\(S^-=\#\{X&lt;q_0\}\)</span>,<span class="math inline">\(q_0=64\)</span>,<span class="math inline">\(n=s^++s^-\)</span>;</li>
<li>如果<span class="math inline">\(Q_{0.25} = q_0\)</span>，应有<span class="math inline">\(S^- \sim B(n,0.25)\)</span>;</li>
<li>如果<span class="math inline">\(s^-\)</span>的值较大，说明较多的值比<span class="math inline">\(q_0\)</span>小，因此<span class="math inline">\(Q_{0.25} &lt; q_0\)</span>;</li>
<li>此时，p值<span class="math inline">\(=P(S\geq s^-)=1-P(S\leq s^--1)\)</span>，<span class="math inline">\(S \sim B(n,0.25)\)</span></li>
</ul>
</div>
</div>
<div id="分位点的置信区间" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> 2.1.2 分位点的置信区间<a href="单样本位置参数.html#分位点的置信区间" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="中位数的置信区间" class="section level4 hasAnchor" number="2.2.2.1">
<h4><span class="header-section-number">2.2.2.1</span> 中位数的置信区间<a href="单样本位置参数.html#中位数的置信区间" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="单样本位置参数.html#cb39-1" aria-hidden="true" tabindex="-1"></a>tax <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file=</span><span class="st">&quot;data/tax.TXT&quot;</span>)</span>
<span id="cb39-2"><a href="单样本位置参数.html#cb39-2" aria-hidden="true" tabindex="-1"></a>(tax <span class="ot">&lt;-</span> <span class="fu">sort</span>(tax<span class="sc">$</span>V1))</span></code></pre></div>
<pre><code>##  [1] 1.00 1.35 1.99 2.05 2.05 2.10 2.30 2.61 2.86 2.95 2.98 3.23 3.73 4.03 4.82
## [16] 5.24 6.10 6.64 6.81 6.86 7.11 9.00</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="单样本位置参数.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SIGN.test</span>(tax,<span class="at">alternative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">conf.level=</span><span class="fl">0.95</span>)<span class="sc">$</span>Confidence.Intervals</span></code></pre></div>
<pre><code>##                   Conf.Level L.E.pt U.E.pt
## Lower Achieved CI     0.9475 2.3000 5.2400
## Interpolated CI       0.9500 2.2861 5.2999
## Upper Achieved CI     0.9831 2.1000 6.1000</code></pre>
</div>
<div id="自定义函数一中位数的置信区间" class="section level4 hasAnchor" number="2.2.2.2">
<h4><span class="header-section-number">2.2.2.2</span> 自定义函数（一）：中位数的置信区间<a href="单样本位置参数.html#自定义函数一中位数的置信区间" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="单样本位置参数.html#cb43-1" aria-hidden="true" tabindex="-1"></a>mci<span class="ot">=</span><span class="cf">function</span>(x,<span class="at">alpha=</span><span class="fl">0.05</span>){</span>
<span id="cb43-2"><a href="单样本位置参数.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb43-3"><a href="单样本位置参数.html#cb43-3" aria-hidden="true" tabindex="-1"></a>  b<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb43-4"><a href="单样本位置参数.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  i<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb43-5"><a href="单样本位置参数.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(b<span class="sc">&lt;=</span>alpha<span class="sc">/</span><span class="dv">2</span><span class="sc">&amp;</span>i<span class="sc">&lt;=</span><span class="fu">floor</span>(n<span class="sc">/</span><span class="dv">2</span>)){</span>
<span id="cb43-6"><a href="单样本位置参数.html#cb43-6" aria-hidden="true" tabindex="-1"></a>    b<span class="ot">=</span><span class="fu">pbinom</span>(i,n,.<span class="dv">5</span>);</span>
<span id="cb43-7"><a href="单样本位置参数.html#cb43-7" aria-hidden="true" tabindex="-1"></a>    k1<span class="ot">=</span>i;k2<span class="ot">=</span>n<span class="sc">-</span>i<span class="sc">+</span><span class="dv">1</span>;</span>
<span id="cb43-8"><a href="单样本位置参数.html#cb43-8" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span><span class="fu">pbinom</span>(k1<span class="dv">-1</span>,n,.<span class="dv">5</span>);</span>
<span id="cb43-9"><a href="单样本位置参数.html#cb43-9" aria-hidden="true" tabindex="-1"></a>    i<span class="ot">=</span>i<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb43-10"><a href="单样本位置参数.html#cb43-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-11"><a href="单样本位置参数.html#cb43-11" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">=</span><span class="fu">c</span>(k1,k2,a,<span class="dv">1</span><span class="sc">-</span>a);</span>
<span id="cb43-12"><a href="单样本位置参数.html#cb43-12" aria-hidden="true" tabindex="-1"></a>  z2<span class="ot">=</span><span class="st">&quot;Entire range!&quot;</span></span>
<span id="cb43-13"><a href="单样本位置参数.html#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(k1<span class="sc">&gt;=</span><span class="dv">1</span>){</span>
<span id="cb43-14"><a href="单样本位置参数.html#cb43-14" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span><span class="fu">list</span>(<span class="at">Confidence.level=</span><span class="dv">1</span><span class="sc">-</span>a,<span class="at">CI=</span><span class="fu">c</span>(x[k1],x[k2]))</span>
<span id="cb43-15"><a href="单样本位置参数.html#cb43-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-16"><a href="单样本位置参数.html#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb43-17"><a href="单样本位置参数.html#cb43-17" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span><span class="fu">list</span>(<span class="at">Confidence.level=</span><span class="dv">1-2</span><span class="sc">*</span><span class="fu">pbinom</span>(<span class="dv">0</span>,n,.<span class="dv">5</span>),<span class="at">CI=</span>z2)</span>
<span id="cb43-18"><a href="单样本位置参数.html#cb43-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-19"><a href="单样本位置参数.html#cb43-19" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb43-20"><a href="单样本位置参数.html#cb43-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-21"><a href="单样本位置参数.html#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="fu">mci</span>(tax,<span class="at">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## $Confidence.level
## [1] 0.9830995
## 
## $CI
## [1] 2.1 6.1</code></pre>
</div>
<div id="自定义函数二中位数的置信区间" class="section level4 hasAnchor" number="2.2.2.3">
<h4><span class="header-section-number">2.2.2.3</span> 自定义函数（二）：中位数的置信区间<a href="单样本位置参数.html#自定义函数二中位数的置信区间" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="单样本位置参数.html#cb45-1" aria-hidden="true" tabindex="-1"></a>mci2<span class="ot">=</span><span class="cf">function</span>(x,<span class="at">alpha=</span><span class="dv">0</span>){</span>
<span id="cb45-2"><a href="单样本位置参数.html#cb45-2" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">length</span>(x);q<span class="ot">=</span>.<span class="dv">5</span></span>
<span id="cb45-3"><a href="单样本位置参数.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">floor</span>(n<span class="sc">*</span>q);s1<span class="ot">=</span><span class="fu">pbinom</span>(<span class="dv">0</span><span class="sc">:</span>m,n,q);s2<span class="ot">=</span><span class="fu">pbinom</span>(m<span class="sc">:</span>(n<span class="dv">-1</span>),n,q,<span class="at">low=</span>F);</span>
<span id="cb45-4"><a href="单样本位置参数.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  ss<span class="ot">=</span><span class="fu">c</span>(s1,s2);nn<span class="ot">=</span><span class="fu">length</span>(ss);a<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb45-5"><a href="单样本位置参数.html#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>m){</span>
<span id="cb45-6"><a href="单样本位置参数.html#cb45-6" aria-hidden="true" tabindex="-1"></a>    b1<span class="ot">=</span>ss[i<span class="sc">+</span><span class="dv">1</span>];b2<span class="ot">=</span>ss[nn<span class="sc">-</span>i];b<span class="ot">=</span>b1<span class="sc">+</span>b2;d<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>b;</span>
<span id="cb45-7"><a href="单样本位置参数.html#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>((b)<span class="sc">&gt;</span><span class="dv">1</span>)<span class="cf">break</span></span>
<span id="cb45-8"><a href="单样本位置参数.html#cb45-8" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">=</span><span class="fu">rbind</span>(a,<span class="fu">c</span>(b,d,x[i<span class="sc">+</span><span class="dv">1</span>],x[n<span class="sc">-</span>i]))}</span>
<span id="cb45-9"><a href="单样本位置参数.html#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(a[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">&gt;</span>alpha){</span>
<span id="cb45-10"><a href="单样本位置参数.html#cb45-10" aria-hidden="true" tabindex="-1"></a>    out<span class="ot">=</span><span class="st">&quot;alpha is too small, CI=All range&quot;</span>   </span>
<span id="cb45-11"><a href="单样本位置参数.html#cb45-11" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb45-12"><a href="单样本位置参数.html#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb45-13"><a href="单样本位置参数.html#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(a)){</span>
<span id="cb45-14"><a href="单样本位置参数.html#cb45-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(a[i,<span class="dv">1</span>]<span class="sc">&gt;</span>alpha){out<span class="ot">=</span>a[i<span class="dv">-1</span>,];<span class="cf">break</span>}</span>
<span id="cb45-15"><a href="单样本位置参数.html#cb45-15" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb45-16"><a href="单样本位置参数.html#cb45-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-17"><a href="单样本位置参数.html#cb45-17" aria-hidden="true" tabindex="-1"></a>  out</span>
<span id="cb45-18"><a href="单样本位置参数.html#cb45-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-19"><a href="单样本位置参数.html#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mci2</span>(tax,<span class="at">alpha=</span><span class="fl">0.05</span>)</span></code></pre></div>
<pre><code>## [1] 0.01690054 0.98309946 2.10000000 6.10000000</code></pre>
</div>
<div id="分位数的置信区间" class="section level4 hasAnchor" number="2.2.2.4">
<h4><span class="header-section-number">2.2.2.4</span> 分位数的置信区间<a href="单样本位置参数.html#分位数的置信区间" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="单样本位置参数.html#cb47-1" aria-hidden="true" tabindex="-1"></a>qci<span class="ot">=</span><span class="cf">function</span>(x,<span class="at">alpha=</span><span class="fl">0.05</span>,<span class="at">q=</span>.<span class="dv">25</span>){</span>
<span id="cb47-2"><a href="单样本位置参数.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">sort</span>(x);n<span class="ot">=</span><span class="fu">length</span>(x);a<span class="ot">=</span>alpha<span class="sc">/</span><span class="dv">2</span>;r<span class="ot">=</span><span class="fu">qbinom</span>(a,n,q);</span>
<span id="cb47-3"><a href="单样本位置参数.html#cb47-3" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="fu">qbinom</span>(<span class="dv">1</span><span class="sc">-</span>a,n,q);CL<span class="ot">=</span><span class="fu">pbinom</span>(s,n,q)<span class="sc">-</span><span class="fu">pbinom</span>(r<span class="dv">-1</span>,n,q)</span>
<span id="cb47-4"><a href="单样本位置参数.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (r<span class="sc">==</span><span class="dv">0</span>) lo<span class="ot">&lt;-</span><span class="cn">NA</span> <span class="cf">else</span> lo<span class="ot">&lt;-</span>x[r]</span>
<span id="cb47-5"><a href="单样本位置参数.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (s<span class="sc">==</span>n) up<span class="ot">&lt;-</span><span class="cn">NA</span> <span class="cf">else</span> up<span class="ot">&lt;-</span>x[s<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb47-6"><a href="单样本位置参数.html#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;lower limit&quot;</span><span class="ot">=</span>lo,<span class="st">&quot;upper limit&quot;</span><span class="ot">=</span>up,</span>
<span id="cb47-7"><a href="单样本位置参数.html#cb47-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;1-alpha&quot;</span><span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>alpha,<span class="st">&quot;true conf&quot;</span><span class="ot">=</span>CL)) </span>
<span id="cb47-8"><a href="单样本位置参数.html#cb47-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-9"><a href="单样本位置参数.html#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qci</span>(tax,<span class="fl">0.05</span>,<span class="fl">0.25</span>)</span></code></pre></div>
<pre><code>## [[1]]
## lower limit upper limit     1-alpha   true conf 
##   1.3500000   2.9800000   0.9500000   0.9751605</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="单样本位置参数.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qci</span>(tax,<span class="fl">0.06</span>,<span class="fl">0.25</span>)</span></code></pre></div>
<pre><code>## [[1]]
## lower limit upper limit     1-alpha   true conf 
##    1.350000    2.950000    0.940000    0.955626</code></pre>
</div>
</div>
</div>
<div id="wilcoxon符号秩检验wilcoxon-sign-rank" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> 2.2 Wilcoxon符号秩检验(Wilcoxon Sign Rank)<a href="单样本位置参数.html#wilcoxon符号秩检验wilcoxon-sign-rank" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="检验" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> 2.2.1 检验<a href="单样本位置参数.html#检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="单样本位置参数.html#cb51-1" aria-hidden="true" tabindex="-1"></a>euroalc <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file=</span><span class="st">&quot;data/EuroAlc10.TXT&quot;</span>)</span>
<span id="cb51-2"><a href="单样本位置参数.html#cb51-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(euroalc[<span class="dv">1</span>,])</span>
<span id="cb51-3"><a href="单样本位置参数.html#cb51-3" aria-hidden="true" tabindex="-1"></a>y</span></code></pre></div>
<pre><code>##  [1]  4.12  5.81  7.63  9.74 10.39 11.92 12.32 12.89 13.54 14.45</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="单样本位置参数.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(y<span class="dv">-8</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  y - 8
## V = 46, p-value = 0.06445
## alternative hypothesis: true location is not equal to 0</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="单样本位置参数.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(y<span class="dv">-8</span>,<span class="at">exact =</span> F)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank test with continuity correction
## 
## data:  y - 8
## V = 46, p-value = 0.06655
## alternative hypothesis: true location is not equal to 0</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="单样本位置参数.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(y<span class="dv">-8</span>,<span class="at">alt=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  y - 8
## V = 46, p-value = 0.03223
## alternative hypothesis: true location is greater than 0</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="单样本位置参数.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(y<span class="fl">-12.5</span>,<span class="at">alt=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  y - 12.5
## V = 11, p-value = 0.05273
## alternative hypothesis: true location is less than 0</code></pre>
</div>
<div id="置信区间" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> 2.2.2 置信区间<a href="单样本位置参数.html#置信区间" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="walsh平均" class="section level4 hasAnchor" number="2.3.2.1">
<h4><span class="header-section-number">2.3.2.1</span> Walsh平均<a href="单样本位置参数.html#walsh平均" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="单样本位置参数.html#cb61-1" aria-hidden="true" tabindex="-1"></a>walsh<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb61-2"><a href="单样本位置参数.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb61-3"><a href="单样本位置参数.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> i<span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb61-4"><a href="单样本位置参数.html#cb61-4" aria-hidden="true" tabindex="-1"></a>    walsh<span class="ot">=</span><span class="fu">c</span>(walsh,(y[i]<span class="sc">+</span>y[j])<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb61-5"><a href="单样本位置参数.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb61-6"><a href="单样本位置参数.html#cb61-6" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb61-7"><a href="单样本位置参数.html#cb61-7" aria-hidden="true" tabindex="-1"></a>walsh<span class="ot">=</span><span class="fu">sort</span>(walsh)</span>
<span id="cb61-8"><a href="单样本位置参数.html#cb61-8" aria-hidden="true" tabindex="-1"></a>walsh</span></code></pre></div>
<pre><code>##  [1]  4.120  4.965  5.810  5.875  6.720  6.930  7.255  7.630  7.775  8.020
## [11]  8.100  8.220  8.505  8.685  8.830  8.865  9.010  9.065  9.285  9.350
## [21]  9.675  9.740  9.775  9.975 10.065 10.130 10.260 10.390 10.585 10.830
## [31] 11.030 11.040 11.155 11.315 11.355 11.640 11.640 11.920 11.965 12.095
## [41] 12.120 12.320 12.405 12.420 12.605 12.730 12.890 12.930 13.185 13.215
## [51] 13.385 13.540 13.670 13.995 14.450</code></pre>
</div>
<div id="利用walsh平均构造置信区间" class="section level4 hasAnchor" number="2.3.2.2">
<h4><span class="header-section-number">2.3.2.2</span> 利用Walsh平均构造置信区间<a href="单样本位置参数.html#利用walsh平均构造置信区间" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="单样本位置参数.html#cb63-1" aria-hidden="true" tabindex="-1"></a>(k <span class="ot">&lt;-</span> <span class="fu">qsignrank</span>(<span class="fl">0.025</span>,<span class="dv">10</span>))</span></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="单样本位置参数.html#cb65-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">length</span>(walsh)</span>
<span id="cb65-2"><a href="单样本位置参数.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(walsh[k<span class="sc">+</span><span class="dv">1</span>],walsh[N<span class="sc">-</span>k])</span></code></pre></div>
<pre><code>## [1]  8.02 12.73</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="单样本位置参数.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(y,<span class="at">conf.int =</span> T)<span class="sc">$</span>conf.int</span></code></pre></div>
<pre><code>## [1]  7.775 12.890
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
</div>
</div>
<div id="simulation-study" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> simulation study<a href="单样本位置参数.html#simulation-study" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Which of the two tests, the signed-rank Wilcoxon or the t-test, is the more powerful?</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="单样本位置参数.html#cb69-1" aria-hidden="true" tabindex="-1"></a>power_comparison <span class="ot">&lt;-</span> <span class="cf">function</span>(mu){</span>
<span id="cb69-2"><a href="单样本位置参数.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="dv">30</span>; df <span class="ot">=</span> <span class="dv">2</span>; nsims <span class="ot">=</span> <span class="dv">10000</span>; collwil <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,nsims)</span>
<span id="cb69-3"><a href="单样本位置参数.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  collt <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,nsims)</span>
<span id="cb69-4"><a href="单样本位置参数.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsims){</span>
<span id="cb69-5"><a href="单样本位置参数.html#cb69-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">rt</span>(n,df) <span class="sc">+</span> mu</span>
<span id="cb69-6"><a href="单样本位置参数.html#cb69-6" aria-hidden="true" tabindex="-1"></a>    wil <span class="ot">=</span> <span class="fu">wilcox.test</span>(x)</span>
<span id="cb69-7"><a href="单样本位置参数.html#cb69-7" aria-hidden="true" tabindex="-1"></a>    collwil[i] <span class="ot">=</span> wil<span class="sc">$</span>p.value</span>
<span id="cb69-8"><a href="单样本位置参数.html#cb69-8" aria-hidden="true" tabindex="-1"></a>    ttest <span class="ot">=</span> <span class="fu">t.test</span>(x)</span>
<span id="cb69-9"><a href="单样本位置参数.html#cb69-9" aria-hidden="true" tabindex="-1"></a>    collt[i] <span class="ot">=</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb69-10"><a href="单样本位置参数.html#cb69-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-11"><a href="单样本位置参数.html#cb69-11" aria-hidden="true" tabindex="-1"></a>  powwil <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,nsims); powwil[collwil <span class="sc">&lt;=</span> .<span class="dv">05</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb69-12"><a href="单样本位置参数.html#cb69-12" aria-hidden="true" tabindex="-1"></a>  powerwil <span class="ot">=</span> <span class="fu">sum</span>(powwil)<span class="sc">/</span>nsims</span>
<span id="cb69-13"><a href="单样本位置参数.html#cb69-13" aria-hidden="true" tabindex="-1"></a>  powt <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,nsims); powt[collt<span class="sc">&lt;=</span> .<span class="dv">05</span>] <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb69-14"><a href="单样本位置参数.html#cb69-14" aria-hidden="true" tabindex="-1"></a>  powert <span class="ot">=</span> <span class="fu">sum</span>(powt)<span class="sc">/</span>nsims</span>
<span id="cb69-15"><a href="单样本位置参数.html#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(powerwil,powert)</span>
<span id="cb69-16"><a href="单样本位置参数.html#cb69-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-17"><a href="单样本位置参数.html#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="fu">power_comparison</span>(<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.0501
## 
## [[2]]
## [1] 0.0405</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="单样本位置参数.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_comparison</span>(<span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.4585
## 
## [[2]]
## [1] 0.2902</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="单样本位置参数.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power_comparison</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 0.9211
## 
## [[2]]
## [1] 0.6981</code></pre>
</div>
</div>
<div id="正态记分检验normal-score" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> 2.3 正态记分检验*(normal score)<a href="单样本位置参数.html#正态记分检验normal-score" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>线性符号秩统计量 <span class="math inline">\(S_n^+=\sum_{i=1}^n a_n^+(R_i^+) I(X_i&gt;0)\)</span>；
<ul>
<li><span class="math inline">\(a_n^+(i)=i\)</span>时，<span class="math inline">\(S_n^+\)</span>为Wilcoxon符号秩统计量<span class="math inline">\(W^+\)</span>；</li>
<li><span class="math inline">\(a_n^+(i)=1\)</span>时，<span class="math inline">\(S_n^+\)</span>为符号秩统计量<span class="math inline">\(S^+\)</span>；</li>
</ul></li>
<li>线性秩统计量 <span class="math inline">\(S_n=\sum_{i=1}^n c_n(i) a_n(R_i)\)</span>；
<ul>
<li><span class="math inline">\(N=m+n\)</span>,<span class="math inline">\(a_N(i)=i\)</span>,<span class="math inline">\(c_N(i)=I(i&gt;m)\)</span>,则<span class="math inline">\(S_n\)</span>为两样本Wilcoxon秩和统计量;</li>
<li>正态记分<span class="math inline">\(S_n=\sum_{i=1}^n \Phi^{-1}\left( \frac{R_i}{n+1} \right)\)</span>;</li>
</ul></li>
<li>线性秩统计量的一个特例 <span class="math inline">\(S_n=\sum_{i=1}^n a_n^+(R_i^+) sign(X_i)=\sum_{i=1}^n s_i\)</span>；
<ul>
<li>记分函数<span class="math inline">\(a_n^+(i)=\Phi^{-1}\left( \frac{n+1+i}{2n+2} \right)=\Phi^{-1}\left[\frac{1}{2} \left( 1 + \frac{i}{n+1} \right) \right]\)</span>,非负</li>
<li>检验<span class="math inline">\(H_0:Me=M_0\)</span>,<span class="math inline">\(X_i-M_0\)</span>的秩<span class="math inline">\(r_i\)</span>,符号正态记分<span class="math inline">\(s_i=a_n^+(r_i) sign(X_i-M_0)=\Phi^{-1}\left[\frac{1}{2} \left( 1 + \frac{r_i}{n+1} \right) \right]sign(X_i-M_0)\)</span></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="单样本位置参数.html#cb75-1" aria-hidden="true" tabindex="-1"></a>ns<span class="ot">=</span><span class="cf">function</span>(x,m0){</span>
<span id="cb75-2"><a href="单样本位置参数.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">=</span>x<span class="sc">-</span>m0;r<span class="ot">=</span><span class="fu">rank</span>(<span class="fu">abs</span>(x1));n<span class="ot">=</span><span class="fu">length</span>(x)</span>
<span id="cb75-3"><a href="单样本位置参数.html#cb75-3" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">=</span><span class="fu">qnorm</span>(.<span class="dv">5</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>r<span class="sc">/</span>(n<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">*</span><span class="fu">sign</span>(x1);</span>
<span id="cb75-4"><a href="单样本位置参数.html#cb75-4" aria-hidden="true" tabindex="-1"></a>  tt<span class="ot">=</span><span class="fu">sum</span>(s)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(s<span class="sc">^</span><span class="dv">2</span>));</span>
<span id="cb75-5"><a href="单样本位置参数.html#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">pvalue.2sided=</span><span class="dv">2</span><span class="sc">*</span><span class="fu">min</span>(<span class="fu">pnorm</span>(tt),<span class="fu">pnorm</span>(tt,<span class="at">low=</span>F)),<span class="at">Tstat=</span>tt,<span class="at">s=</span>s)</span>
<span id="cb75-6"><a href="单样本位置参数.html#cb75-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-7"><a href="单样本位置参数.html#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ns</span>(y,<span class="dv">8</span>)</span></code></pre></div>
<pre><code>## $pvalue.2sided
## [1] 0.05567649
## 
## $Tstat
## [1] 1.913559
## 
## $s
##  [1] -0.6045853 -0.3487557 -0.1141853  0.2298841  0.4727891  0.7478586
##  [7]  0.9084579  1.0968036  1.3351777  1.6906216</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="单样本位置参数.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ns</span>(y,<span class="fl">12.5</span>)</span></code></pre></div>
<pre><code>## $pvalue.2sided
## [1] 0.08114229
## 
## $Tstat
## [1] -1.744096
## 
## $s
##  [1] -1.6906216 -1.3351777 -1.0968036 -0.9084579 -0.7478586 -0.3487557
##  [7] -0.1141853  0.2298841  0.4727891  0.6045853</code></pre>
</div>
<div id="cox-stuart趋势检验" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> 2.4 Cox-Stuart趋势检验*<a href="单样本位置参数.html#cox-stuart趋势检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>判断增长或减少趋势</li>
<li>求差<span class="math inline">\(D_i=x_i-x_{i+c}\)</span>的符号来衡量增减</li>
<li>像符号检验一样用到二项分布</li>
</ul>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="单样本位置参数.html#cb79-1" aria-hidden="true" tabindex="-1"></a>TJair <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file=</span><span class="st">&quot;data/TJAir.TXT&quot;</span>)</span>
<span id="cb79-2"><a href="单样本位置参数.html#cb79-2" aria-hidden="true" tabindex="-1"></a>TJair <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(TJair))</span>
<span id="cb79-3"><a href="单样本位置参数.html#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(TJair,<span class="at">xlab=</span><span class="st">&quot;Month&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Number of Passenger&quot;</span>)</span></code></pre></div>
<p><img src="02_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="单样本位置参数.html#cb80-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> TJair[<span class="dv">1</span><span class="sc">:</span><span class="dv">54</span>]<span class="sc">-</span>TJair[<span class="dv">55</span><span class="sc">:</span><span class="dv">108</span>]</span>
<span id="cb80-2"><a href="单样本位置参数.html#cb80-2" aria-hidden="true" tabindex="-1"></a>Splus <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sign</span>(D)<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb80-3"><a href="单样本位置参数.html#cb80-3" aria-hidden="true" tabindex="-1"></a>Sminus <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">sign</span>(D)<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb80-4"><a href="单样本位置参数.html#cb80-4" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">min</span>(Splus,Sminus)</span>
<span id="cb80-5"><a href="单样本位置参数.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(K,<span class="dv">54</span>,.<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] 0.001919133</code></pre>
</div>
<div id="随机性的游程检验" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> 2.5 随机性的游程检验*<a href="单样本位置参数.html#随机性的游程检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>判断n重伯努利试验结果是否随机</li>
<li>称连在一起的0或1为游程</li>
<li>游程个数R的条件分布</li>
</ul>
<div id="自定义函数" class="section level4 hasAnchor" number="2.6.0.1">
<h4><span class="header-section-number">2.6.0.1</span> 自定义函数<a href="单样本位置参数.html#自定义函数" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="单样本位置参数.html#cb82-1" aria-hidden="true" tabindex="-1"></a>runs.test0<span class="ot">=</span><span class="cf">function</span>(y,<span class="at">cut=</span><span class="dv">0</span>){ </span>
<span id="cb82-2"><a href="单样本位置参数.html#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cut<span class="sc">!=</span><span class="dv">0</span>)x<span class="ot">=</span>(y<span class="sc">&gt;</span>cut)<span class="sc">*</span><span class="dv">1</span> <span class="cf">else</span> x<span class="ot">=</span>y</span>
<span id="cb82-3"><a href="单样本位置参数.html#cb82-3" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">=</span><span class="fu">length</span>(x);k<span class="ot">=</span><span class="dv">1</span>;</span>
<span id="cb82-4"><a href="单样本位置参数.html#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(N<span class="dv">-1</span>))<span class="cf">if</span> (x[i]<span class="sc">!=</span>x[i<span class="sc">+</span><span class="dv">1</span>])k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span>;r<span class="ot">=</span>k;</span>
<span id="cb82-5"><a href="单样本位置参数.html#cb82-5" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">=</span><span class="fu">sum</span>(<span class="dv">1</span><span class="sc">-</span>x);n<span class="ot">=</span>N<span class="sc">-</span>m;</span>
<span id="cb82-6"><a href="单样本位置参数.html#cb82-6" aria-hidden="true" tabindex="-1"></a>  P1<span class="ot">=</span><span class="cf">function</span>(m,n,k){</span>
<span id="cb82-7"><a href="单样本位置参数.html#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span><span class="sc">*</span><span class="fu">choose</span>(m<span class="dv">-1</span>,k<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">choose</span>(m<span class="sc">+</span>n,n)<span class="sc">*</span><span class="fu">choose</span>(n<span class="dv">-1</span>,k<span class="dv">-1</span>)</span>
<span id="cb82-8"><a href="单样本位置参数.html#cb82-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-9"><a href="单样本位置参数.html#cb82-9" aria-hidden="true" tabindex="-1"></a>  P2<span class="ot">=</span><span class="cf">function</span>(m,n,k){</span>
<span id="cb82-10"><a href="单样本位置参数.html#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">choose</span>(m<span class="dv">-1</span>,k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">choose</span>(n<span class="dv">-1</span>,k)<span class="sc">/</span><span class="fu">choose</span>(m<span class="sc">+</span>n,n)</span>
<span id="cb82-11"><a href="单样本位置参数.html#cb82-11" aria-hidden="true" tabindex="-1"></a>               <span class="sc">+</span><span class="fu">choose</span>(m<span class="dv">-1</span>,k)<span class="sc">*</span><span class="fu">choose</span>(n<span class="dv">-1</span>,k<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">choose</span>(m<span class="sc">+</span>n,n)</span>
<span id="cb82-12"><a href="单样本位置参数.html#cb82-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-13"><a href="单样本位置参数.html#cb82-13" aria-hidden="true" tabindex="-1"></a>  r2<span class="ot">=</span><span class="fu">floor</span>(r<span class="sc">/</span><span class="dv">2</span>);</span>
<span id="cb82-14"><a href="单样本位置参数.html#cb82-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(r2<span class="sc">==</span>r<span class="sc">/</span><span class="dv">2</span>){</span>
<span id="cb82-15"><a href="单样本位置参数.html#cb82-15" aria-hidden="true" tabindex="-1"></a>    pv<span class="ot">=</span><span class="dv">0</span>;<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>r2) pv<span class="ot">=</span>pv<span class="sc">+</span><span class="fu">P1</span>(m,n,i);</span>
<span id="cb82-16"><a href="单样本位置参数.html#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(r2<span class="dv">-1</span>)) pv<span class="ot">=</span>pv<span class="sc">+</span><span class="fu">P2</span>(m,n,i)</span>
<span id="cb82-17"><a href="单样本位置参数.html#cb82-17" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb82-18"><a href="单样本位置参数.html#cb82-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb82-19"><a href="单样本位置参数.html#cb82-19" aria-hidden="true" tabindex="-1"></a>    pv<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb82-20"><a href="单样本位置参数.html#cb82-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>r2) pv<span class="ot">=</span>pv<span class="sc">+</span><span class="fu">P1</span>(m,n,i)</span>
<span id="cb82-21"><a href="单样本位置参数.html#cb82-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>r2) pv<span class="ot">=</span>pv<span class="sc">+</span><span class="fu">P2</span>(m,n,i)</span>
<span id="cb82-22"><a href="单样本位置参数.html#cb82-22" aria-hidden="true" tabindex="-1"></a>  };</span>
<span id="cb82-23"><a href="单样本位置参数.html#cb82-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(r2<span class="sc">==</span>r<span class="sc">/</span><span class="dv">2</span>) pv1<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>pv<span class="sc">+</span><span class="fu">P1</span>(m,n,r2) <span class="cf">else</span> pv1<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>pv<span class="sc">+</span><span class="fu">P2</span>(m,n,r2);</span>
<span id="cb82-24"><a href="单样本位置参数.html#cb82-24" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">=</span>(r<span class="dv">-2</span><span class="sc">*</span>m<span class="sc">*</span>n<span class="sc">/</span>N<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>m<span class="sc">*</span>n<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>m<span class="sc">*</span>n<span class="sc">-</span>m<span class="sc">-</span>n)<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(m<span class="sc">+</span>n<span class="dv">-1</span>));</span>
<span id="cb82-25"><a href="单样本位置参数.html#cb82-25" aria-hidden="true" tabindex="-1"></a>  ap1<span class="ot">=</span><span class="fu">pnorm</span>(z);ap2<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span>ap1;tpv<span class="ot">=</span><span class="fu">min</span>(pv,pv1)<span class="sc">*</span><span class="dv">2</span>;</span>
<span id="cb82-26"><a href="单样本位置参数.html#cb82-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">N=</span>N,<span class="at">R=</span>r,<span class="at">Exact.pvalue1=</span>pv,</span>
<span id="cb82-27"><a href="单样本位置参数.html#cb82-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Exact.pvalue2=</span>pv1,<span class="at">Aprox.pvalue1=</span>ap1,<span class="at">Aprox.pvalue2=</span>ap2,</span>
<span id="cb82-28"><a href="单样本位置参数.html#cb82-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Exact.2sided.pvalue=</span>tpv,<span class="at">Approx.2sided.pvalue=</span><span class="fu">min</span>(ap1,ap2)<span class="sc">*</span><span class="dv">2</span>)</span>
<span id="cb82-29"><a href="单样本位置参数.html#cb82-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-30"><a href="单样本位置参数.html#cb82-30" aria-hidden="true" tabindex="-1"></a>run02 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file=</span><span class="st">&quot;data/run02.TXT&quot;</span>)</span>
<span id="cb82-31"><a href="单样本位置参数.html#cb82-31" aria-hidden="true" tabindex="-1"></a>(run02 <span class="ot">&lt;-</span> run02<span class="sc">$</span>V1)</span></code></pre></div>
<pre><code>##  [1] 12.27  9.92 10.81 11.79 11.87 10.90 11.22 10.80 10.33  9.30  9.81  8.85
## [13]  9.32  8.67  9.32  9.53  9.58  8.94  7.89 10.77</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="单样本位置参数.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runs.test0</span>(run02,<span class="fu">median</span>(run02))</span></code></pre></div>
<pre><code>## $m
## [1] 10
## 
## $n
## [1] 10
## 
## $N
## [1] 20
## 
## $R
## [1] 3
## 
## $Exact.pvalue1
## [1] 5.953799e-05
## 
## $Exact.pvalue2
## [1] 0.9999892
## 
## $Aprox.pvalue1
## [1] 0.0001185775
## 
## $Aprox.pvalue2
## [1] 0.9998814
## 
## $Exact.2sided.pvalue
## [1] 0.000119076
## 
## $Approx.2sided.pvalue
## [1] 0.0002371551</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="单样本位置参数.html#cb86-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sign</span>(run02<span class="sc">-</span><span class="fu">median</span>(run02)),<span class="at">labels=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="runs.test函数" class="section level4 hasAnchor" number="2.6.0.2">
<h4><span class="header-section-number">2.6.0.2</span> runs.test函数<a href="单样本位置参数.html#runs.test函数" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="单样本位置参数.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="单样本位置参数.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">runs.test</span>(y)</span></code></pre></div>
<pre><code>## 
##  Runs Test
## 
## data:  y
## Standard Normal = -3.6757, p-value = 0.0002372
## alternative hypothesis: two.sided</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="概述.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="双样本位置参数.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-template.pdf", "bookdown-template.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
