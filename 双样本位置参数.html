<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>第 3 章 双样本位置参数 | 非参数统计</title>
  <meta name="description" content="description" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="第 3 章 双样本位置参数 | 非参数统计" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="description" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="第 3 章 双样本位置参数 | 非参数统计" />
  
  <meta name="twitter:description" content="description" />
  

<meta name="author" content="Sifan Liu, TJUFE" />


<meta name="date" content="2022-08-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="单样本位置参数.html"/>
<link rel="next" href="多样本位置参数.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Title</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 概述</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#习题1-1.5-数据可视化查看对总体分布的假设是否合理"><i class="fa fa-check"></i><b>1.1</b> 习题1: (1.5 数据可视化，查看对总体分布的假设是否合理)</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#数据变换box-cox变换"><i class="fa fa-check"></i><b>1.2</b> 数据变换（Box-Cox变换）</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#section"><i class="fa fa-check"></i><b>1.3</b> 2.(1)</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#section-1"><i class="fa fa-check"></i><b>1.4</b> 2.(2)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="单样本位置参数.html"><a href="单样本位置参数.html"><i class="fa fa-check"></i><b>2</b> 单样本位置参数</a>
<ul>
<li class="chapter" data-level="2.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#引入的例子楼盘均价"><i class="fa fa-check"></i><b>2.1</b> 引入的例子：楼盘均价</a></li>
<li class="chapter" data-level="2.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#符号检验-sign-test"><i class="fa fa-check"></i><b>2.2</b> 2.1 符号检验 Sign Test</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#广义符号检验"><i class="fa fa-check"></i><b>2.2.1</b> 2.1.1. 广义符号检验</a></li>
<li class="chapter" data-level="2.2.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#分位点的置信区间"><i class="fa fa-check"></i><b>2.2.2</b> 2.1.2 分位点的置信区间</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="单样本位置参数.html"><a href="单样本位置参数.html#wilcoxon符号秩检验wilcoxon-sign-rank"><i class="fa fa-check"></i><b>2.3</b> 2.2 Wilcoxon符号秩检验(Wilcoxon Sign Rank)</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="单样本位置参数.html"><a href="单样本位置参数.html#检验"><i class="fa fa-check"></i><b>2.3.1</b> 2.2.1 检验</a></li>
<li class="chapter" data-level="2.3.2" data-path="单样本位置参数.html"><a href="单样本位置参数.html#置信区间"><i class="fa fa-check"></i><b>2.3.2</b> 2.2.2 置信区间</a></li>
<li class="chapter" data-level="2.3.3" data-path="单样本位置参数.html"><a href="单样本位置参数.html#simulation-study"><i class="fa fa-check"></i><b>2.3.3</b> simulation study</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="单样本位置参数.html"><a href="单样本位置参数.html#正态记分检验normal-score"><i class="fa fa-check"></i><b>2.4</b> 2.3 正态记分检验*(normal score)</a></li>
<li class="chapter" data-level="2.5" data-path="单样本位置参数.html"><a href="单样本位置参数.html#cox-stuart趋势检验"><i class="fa fa-check"></i><b>2.5</b> 2.4 Cox-Stuart趋势检验*</a></li>
<li class="chapter" data-level="2.6" data-path="单样本位置参数.html"><a href="单样本位置参数.html#随机性的游程检验"><i class="fa fa-check"></i><b>2.6</b> 2.5 随机性的游程检验*</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="双样本位置参数.html"><a href="双样本位置参数.html"><i class="fa fa-check"></i><b>3</b> 双样本位置参数</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子零件疲劳强度测试"><i class="fa fa-check"></i><b>3.0.1</b> 例子：零件疲劳强度测试</a></li>
<li class="chapter" data-level="3.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#brown-mood中位数检验"><i class="fa fa-check"></i><b>3.1</b> 3.1 Brown-Mood中位数检验</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#精确检验"><i class="fa fa-check"></i><b>3.1.1</b> 精确检验</a></li>
<li class="chapter" data-level="3.1.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#大样本近似"><i class="fa fa-check"></i><b>3.1.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#wilcoxon秩和检验"><i class="fa fa-check"></i><b>3.2</b> 3.2 Wilcoxon秩和检验</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例wilcoxon-test-for-stochastic-ordering-of-alternatives"><i class="fa fa-check"></i><b>3.2.1</b> *例：Wilcoxon Test for Stochastic Ordering of Alternatives</a></li>
<li class="chapter" data-level="3.2.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例-analyses-for-a-shift-in-location"><i class="fa fa-check"></i><b>3.2.2</b> *例： Analyses for a Shift in Location</a></li>
<li class="chapter" data-level="3.2.3" data-path="双样本位置参数.html"><a href="双样本位置参数.html#假设检验"><i class="fa fa-check"></i><b>3.2.3</b> 3.2.1 假设检验</a></li>
<li class="chapter" data-level="3.2.4" data-path="双样本位置参数.html"><a href="双样本位置参数.html#置信区间-1"><i class="fa fa-check"></i><b>3.2.4</b> 3.2.2 置信区间</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="双样本位置参数.html"><a href="双样本位置参数.html#正态记分normal-score检验"><i class="fa fa-check"></i><b>3.3</b> 3.3 正态记分（normal score）检验</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子salary"><i class="fa fa-check"></i><b>3.3.1</b> 例子：salary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="双样本位置参数.html"><a href="双样本位置参数.html#成对数据的检验"><i class="fa fa-check"></i><b>3.4</b> 3.4 成对数据的检验</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子实施管理前后"><i class="fa fa-check"></i><b>3.4.1</b> 例子：实施管理前后</a></li>
<li class="chapter" data-level="3.4.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#例子病人血压"><i class="fa fa-check"></i><b>3.4.2</b> 例子：病人血压</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="双样本位置参数.html"><a href="双样本位置参数.html#mcnemar检验"><i class="fa fa-check"></i><b>3.5</b> 3.5 McNemar检验</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="双样本位置参数.html"><a href="双样本位置参数.html#精确检验-1"><i class="fa fa-check"></i><b>3.5.1</b> 精确检验</a></li>
<li class="chapter" data-level="3.5.2" data-path="双样本位置参数.html"><a href="双样本位置参数.html#大样本近似-1"><i class="fa fa-check"></i><b>3.5.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="双样本位置参数.html"><a href="双样本位置参数.html#cohens-kappa系数"><i class="fa fa-check"></i><b>3.6</b> 3.6 Cohen’s Kappa系数</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="多样本位置参数.html"><a href="多样本位置参数.html"><i class="fa fa-check"></i><b>4</b> 多样本位置参数</a>
<ul>
<li class="chapter" data-level="4.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#kruskal-wallis秩和检验"><i class="fa fa-check"></i><b>4.1</b> 4.1 Kruskal-Wallis秩和检验</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#例训练方式"><i class="fa fa-check"></i><b>4.1.1</b> 例：训练方式</a></li>
<li class="chapter" data-level="4.1.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-2"><i class="fa fa-check"></i><b>4.1.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#正态记分检验"><i class="fa fa-check"></i><b>4.2</b> 4.2 正态记分检验</a></li>
<li class="chapter" data-level="4.3" data-path="多样本位置参数.html"><a href="多样本位置参数.html#jonckheere-terpstra检验"><i class="fa fa-check"></i><b>4.3</b> 4.3 Jonckheere-Terpstra检验</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-2"><i class="fa fa-check"></i><b>4.3.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.3.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-3"><i class="fa fa-check"></i><b>4.3.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="多样本位置参数.html"><a href="多样本位置参数.html#完全区组设计friedman秩和检验"><i class="fa fa-check"></i><b>4.4</b> 4.5 完全区组设计：Friedman秩和检验</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-3"><i class="fa fa-check"></i><b>4.4.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.4.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-4"><i class="fa fa-check"></i><b>4.4.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="多样本位置参数.html"><a href="多样本位置参数.html#kendall协同系数检验"><i class="fa fa-check"></i><b>4.5</b> 4.6 Kendall协同系数检验</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-5"><i class="fa fa-check"></i><b>4.5.1</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="多样本位置参数.html"><a href="多样本位置参数.html#cochran检验"><i class="fa fa-check"></i><b>4.6</b> 4.7 Cochran检验</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-4"><i class="fa fa-check"></i><b>4.6.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.6.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-6"><i class="fa fa-check"></i><b>4.6.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="多样本位置参数.html"><a href="多样本位置参数.html#page检验"><i class="fa fa-check"></i><b>4.7</b> 4.8 Page检验</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-5"><i class="fa fa-check"></i><b>4.7.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.7.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-7"><i class="fa fa-check"></i><b>4.7.2</b> 大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="多样本位置参数.html"><a href="多样本位置参数.html#durbin检验"><i class="fa fa-check"></i><b>4.8</b> 4.9 Durbin检验</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="多样本位置参数.html"><a href="多样本位置参数.html#精确检验-6"><i class="fa fa-check"></i><b>4.8.1</b> 精确检验</a></li>
<li class="chapter" data-level="4.8.2" data-path="多样本位置参数.html"><a href="多样本位置参数.html#大样本近似-8"><i class="fa fa-check"></i><b>4.8.2</b> 大样本近似</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="尺度参数.html"><a href="尺度参数.html"><i class="fa fa-check"></i><b>5</b> 尺度参数</a>
<ul>
<li class="chapter" data-level="5.1" data-path="尺度参数.html"><a href="尺度参数.html#两独立样本的siegel-tukey方差检验"><i class="fa fa-check"></i><b>5.1</b> 5.1 两独立样本的Siegel-Tukey方差检验</a></li>
<li class="chapter" data-level="5.2" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度参数的mood检验"><i class="fa fa-check"></i><b>5.2</b> 5.2 两样本尺度参数的Mood检验</a></li>
<li class="chapter" data-level="5.3" data-path="尺度参数.html"><a href="尺度参数.html#ansari-bradley检验"><i class="fa fa-check"></i><b>5.3</b> 5.3 Ansari-Bradley检验</a></li>
<li class="chapter" data-level="5.4" data-path="尺度参数.html"><a href="尺度参数.html#fligner-killeen检验"><i class="fa fa-check"></i><b>5.4</b> 5.4 Fligner-Killeen检验</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度的精确检验"><i class="fa fa-check"></i><b>5.4.1</b> 两样本尺度的精确检验</a></li>
<li class="chapter" data-level="5.4.2" data-path="尺度参数.html"><a href="尺度参数.html#多样本尺度的大样本近似"><i class="fa fa-check"></i><b>5.4.2</b> 多样本尺度的大样本近似</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="尺度参数.html"><a href="尺度参数.html#两样本尺度的平方秩检验"><i class="fa fa-check"></i><b>5.5</b> 5.5 两样本尺度的平方秩检验</a></li>
<li class="chapter" data-level="5.6" data-path="尺度参数.html"><a href="尺度参数.html#多样本尺度的平方秩检验"><i class="fa fa-check"></i><b>5.6</b> 5.6 多样本尺度的平方秩检验</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="相关.html"><a href="相关.html"><i class="fa fa-check"></i><b>6</b> 相关</a>
<ul>
<li class="chapter" data-level="6.1" data-path="相关.html"><a href="相关.html#spearman秩相关检验"><i class="fa fa-check"></i><b>6.1</b> 6.1 Spearman秩相关检验</a></li>
<li class="chapter" data-level="6.2" data-path="相关.html"><a href="相关.html#kendall-tau-相关检验"><i class="fa fa-check"></i><b>6.2</b> 6.2 Kendall <span class="math inline">\(\tau\)</span> 相关检验</a></li>
<li class="chapter" data-level="6.3" data-path="相关.html"><a href="相关.html#goodman-kruskals-gamma-相关检验"><i class="fa fa-check"></i><b>6.3</b> 6.3 Goodman-Kruskal’s <span class="math inline">\(\gamma\)</span> 相关检验</a></li>
<li class="chapter" data-level="6.4" data-path="相关.html"><a href="相关.html#somersd-相关检验"><i class="fa fa-check"></i><b>6.4</b> 6.4 Somers’d 相关检验</a></li>
<li class="chapter" data-level="6.5" data-path="相关.html"><a href="相关.html#theil非参数回归"><i class="fa fa-check"></i><b>6.5</b> 6.5 Theil非参数回归</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="相关.html"><a href="相关.html#几种稳健回归"><i class="fa fa-check"></i><b>6.5.1</b> 几种稳健回归</a></li>
<li class="chapter" data-level="6.5.2" data-path="相关.html"><a href="相关.html#simple-linear-regression"><i class="fa fa-check"></i><b>6.5.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="6.5.3" data-path="相关.html"><a href="相关.html#multiple-linear-regression"><i class="fa fa-check"></i><b>6.5.3</b> Multiple Linear Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="分布检验.html"><a href="分布检验.html"><i class="fa fa-check"></i><b>7</b> 分布检验</a>
<ul>
<li class="chapter" data-level="7.1" data-path="分布检验.html"><a href="分布检验.html#q-q图"><i class="fa fa-check"></i><b>7.1</b> Q-Q图</a></li>
<li class="chapter" data-level="7.2" data-path="分布检验.html"><a href="分布检验.html#kolmogorov-smirnov单样本检验"><i class="fa fa-check"></i><b>7.2</b> 7.1 Kolmogorov-Smirnov单样本检验</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="分布检验.html"><a href="分布检验.html#ks检验"><i class="fa fa-check"></i><b>7.2.1</b> KS检验</a></li>
<li class="chapter" data-level="7.2.2" data-path="分布检验.html"><a href="分布检验.html#正态性检验"><i class="fa fa-check"></i><b>7.2.2</b> 正态性检验</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="分布检验.html"><a href="分布检验.html#kolmogorov-smirnov两样本分布检验"><i class="fa fa-check"></i><b>7.3</b> 7.2 Kolmogorov-Smirnov两样本分布检验</a></li>
<li class="chapter" data-level="7.4" data-path="分布检验.html"><a href="分布检验.html#pearson-chi2-拟合优度检验"><i class="fa fa-check"></i><b>7.4</b> 7.3 Pearson <span class="math inline">\(\chi^2\)</span> 拟合优度检验</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="分布检验.html"><a href="分布检验.html#goodness-of-fit-tests-for-a-single-discrete-random-variable"><i class="fa fa-check"></i><b>7.4.1</b> Goodness-of-Fit Tests for a Single Discrete Random Variable</a></li>
<li class="chapter" data-level="7.4.2" data-path="分布检验.html"><a href="分布检验.html#several-discrete-random-variables"><i class="fa fa-check"></i><b>7.4.2</b> Several Discrete Random Variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="列联表.html"><a href="列联表.html"><i class="fa fa-check"></i><b>8</b> 列联表</a>
<ul>
<li class="chapter" data-level="8.1" data-path="列联表.html"><a href="列联表.html#二维列联表的齐性和独立性的chi2检验"><i class="fa fa-check"></i><b>8.1</b> 二维列联表的齐性和独立性的<span class="math inline">\(\chi^2\)</span>检验</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="列联表.html"><a href="列联表.html#齐性"><i class="fa fa-check"></i><b>8.1.1</b> 齐性</a></li>
<li class="chapter" data-level="8.1.2" data-path="列联表.html"><a href="列联表.html#独立性"><i class="fa fa-check"></i><b>8.1.2</b> 独立性</a></li>
<li class="chapter" data-level="8.1.3" data-path="列联表.html"><a href="列联表.html#independence-of-two-discrete-random-variables-例子吸烟与肺癌"><i class="fa fa-check"></i><b>8.1.3</b> Independence of Two Discrete Random Variables （例子：吸烟与肺癌）</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="列联表.html"><a href="列联表.html#低维列联表的fisher精确检验"><i class="fa fa-check"></i><b>8.2</b> 8.2 低维列联表的Fisher精确检验</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="列联表.html"><a href="列联表.html#数据为表格形式"><i class="fa fa-check"></i><b>8.2.1</b> 数据为表格形式</a></li>
<li class="chapter" data-level="8.2.2" data-path="列联表.html"><a href="列联表.html#数据为数据框格式"><i class="fa fa-check"></i><b>8.2.2</b> 数据为数据框格式</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="列联表.html"><a href="列联表.html#两个比例的比较"><i class="fa fa-check"></i><b>8.3</b> 8.3 两个比例的比较</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="列联表.html"><a href="列联表.html#例8.3-关于中风的研究"><i class="fa fa-check"></i><b>8.3.1</b> 例8.3 关于中风的研究</a></li>
<li class="chapter" data-level="8.3.2" data-path="列联表.html"><a href="列联表.html#one-sample-problems"><i class="fa fa-check"></i><b>8.3.2</b> One-Sample Problems*</a></li>
<li class="chapter" data-level="8.3.3" data-path="列联表.html"><a href="列联表.html#two-sample-problems"><i class="fa fa-check"></i><b>8.3.3</b> Two-Sample Problems*</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="列联表.html"><a href="列联表.html#cochran-mantel-haenszel估计"><i class="fa fa-check"></i><b>8.4</b> 8.4 Cochran-Mantel-Haenszel估计</a></li>
<li class="chapter" data-level="8.5" data-path="列联表.html"><a href="列联表.html#对数线性模型与高维列联表的独立性"><i class="fa fa-check"></i><b>8.5</b> 8.5 对数线性模型与高维列联表的独立性</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="密度估计和回归.html"><a href="密度估计和回归.html"><i class="fa fa-check"></i><b>9</b> 密度估计和回归</a>
<ul>
<li class="chapter" data-level="9.1" data-path="密度估计和回归.html"><a href="密度估计和回归.html#非参数密度估计"><i class="fa fa-check"></i><b>9.1</b> 非参数密度估计</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="密度估计和回归.html"><a href="密度估计和回归.html#一元密度估计"><i class="fa fa-check"></i><b>9.1.1</b> 一元密度估计</a></li>
<li class="chapter" data-level="9.1.2" data-path="密度估计和回归.html"><a href="密度估计和回归.html#多元密度估计"><i class="fa fa-check"></i><b>9.1.2</b> 多元密度估计</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="密度估计和回归.html"><a href="密度估计和回归.html#非参数回归"><i class="fa fa-check"></i><b>9.2</b> 非参数回归</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>10</b> Bootstrap</a>
<ul>
<li class="chapter" data-level="10.1" data-path="bootstrap.html"><a href="bootstrap.html#percentile-bootstrap-confidence-intervals"><i class="fa fa-check"></i><b>10.1</b> Percentile Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="10.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-tests-of-hypotheses"><i class="fa fa-check"></i><b>10.2</b> Bootstrap Tests of Hypotheses</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="bootstrap.html"><a href="bootstrap.html#nursery-school-intervention"><i class="fa fa-check"></i><b>10.2.1</b> Nursery School Intervention</a></li>
<li class="chapter" data-level="10.2.2" data-path="bootstrap.html"><a href="bootstrap.html#bootstrap-test-for-sample-mean"><i class="fa fa-check"></i><b>10.2.2</b> Bootstrap test for sample mean</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">非参数统计</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="双样本位置参数" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">第 3 章</span> 双样本位置参数<a href="双样本位置参数.html#双样本位置参数" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>第一部分 两个独立总体</strong></p>
<div id="例子零件疲劳强度测试" class="section level3 hasAnchor" number="3.0.1">
<h3><span class="header-section-number">3.0.1</span> 例子：零件疲劳强度测试<a href="双样本位置参数.html#例子零件疲劳强度测试" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="双样本位置参数.html#cb92-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">82</span>, <span class="dv">64</span>, <span class="dv">53</span>, <span class="dv">61</span>, <span class="dv">59</span>, <span class="dv">83</span>, <span class="dv">76</span>, <span class="dv">55</span>, <span class="dv">70</span>, <span class="dv">73</span>)</span>
<span id="cb92-2"><a href="双样本位置参数.html#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="双样本位置参数.html#cb92-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">60</span>, <span class="dv">65</span>, <span class="dv">91</span>, <span class="dv">86</span>, <span class="dv">84</span>, <span class="dv">77</span>, <span class="dv">93</span>, <span class="dv">75</span>)</span>
<span id="cb92-4"><a href="双样本位置参数.html#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="双样本位置参数.html#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="do">##wilcoxon rank sum test</span></span>
<span id="cb92-6"><a href="双样本位置参数.html#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x,y)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum exact test
## 
## data:  x and y
## W = 19, p-value = 0.03499
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div id="brown-mood中位数检验" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> 3.1 Brown-Mood中位数检验<a href="双样本位置参数.html#brown-mood中位数检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>检验两总体中位数是否相等；</li>
<li>计算两样本共同的中位数<span class="math inline">\(M_{XY}\)</span>，用两个样本和<span class="math inline">\(M_{XY}\)</span>比较后得到各个样本中大于和小于它的数目；</li>
<li>利用超几何分布</li>
</ul>
<div id="精确检验" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> 精确检验<a href="双样本位置参数.html#精确检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="双样本位置参数.html#cb94-1" aria-hidden="true" tabindex="-1"></a>z<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/salary.txt&quot;</span>)</span>
<span id="cb94-2"><a href="双样本位置参数.html#cb94-2" aria-hidden="true" tabindex="-1"></a>(salary1 <span class="ot">&lt;-</span> z[,<span class="dv">1</span>][z[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">1</span>]) <span class="co">#样本1</span></span></code></pre></div>
<pre><code>##  [1]  6864  7304  7477  7779  7895  8348  8461  9553  9919 10073 10270 11581
## [13] 13472 13600 13962 15019 17244</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="双样本位置参数.html#cb96-1" aria-hidden="true" tabindex="-1"></a>(salary2 <span class="ot">&lt;-</span> z[,<span class="dv">1</span>][z[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">2</span>]) <span class="co">#样本2</span></span></code></pre></div>
<pre><code>##  [1] 10276 10533 10633 10837 11209 11393 11864 12040 12642 12675 13199 13683
## [13] 14049 14061 16079</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="双样本位置参数.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) <span class="co">#箱线图</span></span>
<span id="cb98-2"><a href="双样本位置参数.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(salary1,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">7000</span>,<span class="dv">17000</span>))</span>
<span id="cb98-3"><a href="双样本位置参数.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(salary2,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">7000</span>,<span class="dv">17000</span>))</span>
<span id="cb98-4"><a href="双样本位置参数.html#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(z[,<span class="dv">1</span>],<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">7000</span>,<span class="dv">17000</span>))</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="双样本位置参数.html#cb99-1" aria-hidden="true" tabindex="-1"></a>k<span class="ot">=</span><span class="fu">unique</span>(z[,<span class="dv">2</span>]); <span class="co"># 样本编号</span></span>
<span id="cb99-2"><a href="双样本位置参数.html#cb99-2" aria-hidden="true" tabindex="-1"></a>(<span class="at">m=</span><span class="fu">median</span>(z[,<span class="dv">1</span>])); <span class="co"># 中位数</span></span></code></pre></div>
<pre><code>## [1] 11301</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="双样本位置参数.html#cb101-1" aria-hidden="true" tabindex="-1"></a>m1<span class="ot">=</span><span class="cn">NULL</span>;m2<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb101-2"><a href="双样本位置参数.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> k){</span>
<span id="cb101-3"><a href="双样本位置参数.html#cb101-3" aria-hidden="true" tabindex="-1"></a>  m1<span class="ot">=</span><span class="fu">c</span>(m1,<span class="fu">sum</span>(z[z[,<span class="dv">2</span>]<span class="sc">==</span>i,<span class="dv">1</span>]<span class="sc">&gt;</span>m)) <span class="co"># 大于中位数的个数</span></span>
<span id="cb101-4"><a href="双样本位置参数.html#cb101-4" aria-hidden="true" tabindex="-1"></a>  m2<span class="ot">=</span><span class="fu">c</span>(m2,<span class="fu">sum</span>(z[z[,<span class="dv">2</span>]<span class="sc">==</span>i,<span class="dv">1</span>]<span class="sc">&lt;</span>m)) <span class="co"># 小于等于中位数的个数</span></span>
<span id="cb101-5"><a href="双样本位置参数.html#cb101-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-6"><a href="双样本位置参数.html#cb101-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">C=</span><span class="fu">rbind</span>(m1,m2))</span></code></pre></div>
<pre><code>##    [,1] [,2]
## m1    6   10
## m2   11    5</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="双样本位置参数.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="do">##H1:Mx&lt;My</span></span>
<span id="cb103-2"><a href="双样本位置参数.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">phyper</span>(<span class="dv">6</span>,<span class="dv">17</span>,<span class="dv">15</span>,<span class="dv">16</span>) <span class="co"># 利用超几何分布计算概率 # phyper(a,m,n,a+b)</span></span></code></pre></div>
<pre><code>## [1] 0.07780674</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="双样本位置参数.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(C,<span class="at">alt=</span><span class="st">&quot;less&quot;</span>) <span class="co"># 使用fisher.test函数</span></span></code></pre></div>
<pre><code>## 
##  Fisher&#39;s Exact Test for Count Data
## 
## data:  C
## p-value = 0.07781
## alternative hypothesis: true odds ratio is less than 1
## 95 percent confidence interval:
##  0.000000 1.166386
## sample estimates:
## odds ratio 
##  0.2848586</code></pre>
</div>
<div id="大样本近似" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> 大样本近似<a href="双样本位置参数.html#大样本近似" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[Z=\frac{A \pm 0.5 -mt/N}{\sqrt{mnt(N-t)/N^3}} \sim N(0,1)\]</span></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="双样本位置参数.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>((<span class="dv">6</span><span class="fl">+.5</span><span class="dv">-17</span><span class="sc">*</span><span class="dv">16</span><span class="sc">/</span><span class="dv">32</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">17</span><span class="sc">*</span><span class="dv">15</span><span class="sc">*</span><span class="dv">16</span><span class="sc">*</span>(<span class="dv">32-16</span>)<span class="sc">/</span><span class="dv">32</span><span class="sc">^</span><span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 0.07824383</code></pre>
<p><span class="math display">\[K=\frac{(2A-m)^2(m+n)}{mn} \sim \chi^2_{(1)}\]</span></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="双样本位置参数.html#cb109-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">K=</span>(<span class="dv">2</span><span class="sc">*</span><span class="dv">6-17</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">17</span><span class="sc">+</span><span class="dv">15</span>)<span class="sc">/</span><span class="dv">17</span><span class="sc">/</span><span class="dv">15</span>)</span></code></pre></div>
<pre><code>## [1] 3.137255</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="双样本位置参数.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(K,<span class="dv">1</span>) <span class="co"># p值</span></span></code></pre></div>
<pre><code>## [1] 0.0765225</code></pre>
</div>
</div>
<div id="wilcoxon秩和检验" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> 3.2 Wilcoxon秩和检验<a href="双样本位置参数.html#wilcoxon秩和检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>利用更多的关于样本点相对大小的信息</li>
</ul>
<div id="例wilcoxon-test-for-stochastic-ordering-of-alternatives" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> *例：Wilcoxon Test for Stochastic Ordering of Alternatives<a href="双样本位置参数.html#例wilcoxon-test-for-stochastic-ordering-of-alternatives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="双样本位置参数.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(Esophageal Cancer). This example is based on the case control study of esophageal cancer in Ile-et-Vilaine, France (Breslow et al. 1980). These data are available in the datasets package. We test the hypothesis that alcohol consumption is the same in the two groups, using as our dataset a sample of cases and controls</span></span>
<span id="cb113-2"><a href="双样本位置参数.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datasets)</span>
<span id="cb113-3"><a href="双样本位置参数.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(esoph)</span>
<span id="cb113-4"><a href="双样本位置参数.html#cb113-4" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">rep</span>(esoph<span class="sc">$</span>alcgp,esoph<span class="sc">$</span>ncases)</span>
<span id="cb113-5"><a href="双样本位置参数.html#cb113-5" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">rep</span>(esoph<span class="sc">$</span>alcgp,esoph<span class="sc">$</span>ncontrols)</span>
<span id="cb113-6"><a href="双样本位置参数.html#cb113-6" aria-hidden="true" tabindex="-1"></a>z1<span class="ot">&lt;-</span><span class="fu">c</span>(x1,y1)</span>
<span id="cb113-7"><a href="双样本位置参数.html#cb113-7" aria-hidden="true" tabindex="-1"></a>w1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(x1)),<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(y1)))</span>
<span id="cb113-8"><a href="双样本位置参数.html#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(z1,w1),<span class="at">names.arg=</span><span class="fu">c</span>(<span class="st">&#39;Cases&#39;</span>,<span class="st">&#39;Controls&#39;</span>),<span class="at">legend.text=</span><span class="fu">levels</span>(esoph<span class="sc">$</span>alcgp))</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="双样本位置参数.html#cb114-1" aria-hidden="true" tabindex="-1"></a>(x1<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(x1))</span></code></pre></div>
<pre><code>##   [1] 4 1 2 2 2 2 4 4 4 4 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3
##  [38] 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2
##  [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
## [112] 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2
## [149] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 4 4 4 4
## [186] 4 4 1 1 1 1 2 2 2 2 3 3 4 4 4</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="双样本位置参数.html#cb116-1" aria-hidden="true" tabindex="-1"></a>(y1<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(y1))</span></code></pre></div>
<pre><code>##   [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
##  [38] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2
##  [75] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3
## [112] 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [149] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [186] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
## [223] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
## [260] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
## [297] 3 3 3 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [334] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [371] 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
## [408] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3
## [445] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 4 1 1 1 1 1 1 1 1 1
## [482] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [519] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2
## [556] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
## [593] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
## [630] 3 4 4 4 4 4 4 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [667] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2
## [704] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3
## [741] 3 3 4 4 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="双样本位置参数.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x1,y1)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  x1 and y1
## W = 115612, p-value &lt; 2.2e-16
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div id="例-analyses-for-a-shift-in-location" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> *例： Analyses for a Shift in Location<a href="双样本位置参数.html#例-analyses-for-a-shift-in-location" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="双样本位置参数.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">#(Generated t5-Data). The following are two samples generated from a t-distribution with 5 degrees of freedom. The true shift parameter was set at the value 8.</span></span>
<span id="cb120-2"><a href="双样本位置参数.html#cb120-2" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">rt</span>(<span class="dv">11</span>,<span class="dv">5</span>)<span class="sc">*</span><span class="dv">10</span><span class="sc">+</span><span class="dv">42</span>,<span class="dv">1</span>)</span>
<span id="cb120-3"><a href="双样本位置参数.html#cb120-3" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">rt</span>(<span class="dv">9</span>,<span class="dv">5</span>)<span class="sc">*</span><span class="dv">10</span><span class="sc">+</span><span class="dv">50</span>,<span class="dv">1</span>)</span>
<span id="cb120-4"><a href="双样本位置参数.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(x1)</span></code></pre></div>
<pre><code>##  [1] 16.0 25.2 27.9 28.0 30.4 37.0 43.7 44.6 44.6 45.4 60.8</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="双样本位置参数.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(y1)</span></code></pre></div>
<pre><code>## [1] 17.1 42.8 43.3 46.0 46.9 50.6 55.1 68.2 70.3</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="双样本位置参数.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x1,y1,<span class="at">exact=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(x1, y1, exact = TRUE): cannot compute exact p-
## value with ties</code></pre>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  x1 and y1
## W = 24, p-value = 0.05743
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="双样本位置参数.html#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x1,y1,<span class="at">exact=</span><span class="cn">FALSE</span>,<span class="at">correct=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  x1 and y1
## W = 24, p-value = 0.05262
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="双样本位置参数.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(y1,x1,<span class="at">conf.int=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(y1, x1, conf.int = TRUE): cannot compute exact p-
## value with ties</code></pre>
<pre><code>## Warning in wilcox.test.default(y1, x1, conf.int = TRUE): cannot compute exact
## confidence intervals with ties</code></pre>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  y1 and x1
## W = 75, p-value = 0.05743
## alternative hypothesis: true location shift is not equal to 0
## 95 percent confidence interval:
##  -0.400037 25.699973
## sample estimates:
## difference in location 
##               13.60003</code></pre>
</div>
<div id="假设检验" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> 3.2.1 假设检验<a href="双样本位置参数.html#假设检验" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="双样本位置参数.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(salary1,salary2,<span class="at">alt=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum exact test
## 
## data:  salary1 and salary2
## W = 69, p-value = 0.01352
## alternative hypothesis: true location shift is less than 0</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="双样本位置参数.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pwilcox</span>(<span class="dv">69</span>,<span class="dv">15</span>,<span class="dv">17</span>)</span></code></pre></div>
<pre><code>## [1] 0.01352166</code></pre>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="双样本位置参数.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(salary1,salary2)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum exact test
## 
## data:  salary1 and salary2
## W = 69, p-value = 0.02704
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="双样本位置参数.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(salary1,salary2,<span class="at">exact=</span>F)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  salary1 and salary2
## W = 69, p-value = 0.02851
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="双样本位置参数.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(salary1,salary2,<span class="at">exact=</span>F,<span class="at">cor=</span>F)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  salary1 and salary2
## W = 69, p-value = 0.02717
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="双样本位置参数.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(salary1,salary2,<span class="at">exact=</span>F,<span class="at">alt=</span><span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  salary1 and salary2
## W = 69, p-value = 0.01425
## alternative hypothesis: true location shift is less than 0</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="双样本位置参数.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(salary1,salary2,<span class="at">exact=</span>F,<span class="at">alt=</span><span class="st">&quot;less&quot;</span>,<span class="at">cor=</span>F)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test
## 
## data:  salary1 and salary2
## W = 69, p-value = 0.01358
## alternative hypothesis: true location shift is less than 0</code></pre>
</div>
<div id="置信区间-1" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> 3.2.2 置信区间<a href="双样本位置参数.html#置信区间-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="双样本位置参数.html#cb147-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">D=</span><span class="fu">sort</span>(<span class="fu">as.vector</span>(<span class="fu">outer</span>(salary1,salary2,<span class="st">&quot;-&quot;</span>))))</span></code></pre></div>
<pre><code>##   [1] -9215 -8775 -8602 -8300 -8184 -7731 -7618 -7197 -7185 -6819 -6757 -6745
##  [13] -6584 -6572 -6526 -6379 -6335 -6282 -6270 -6206 -6166 -6160 -6154 -6006
##  [25] -5904 -5895 -5811 -5809 -5788 -5778 -5722 -5713 -5701 -5600 -5588 -5420
##  [37] -5371 -5338 -5335 -5304 -5222 -5198 -5176 -5165 -5000 -4896 -4863 -4851
##  [49] -4780 -4747 -4738 -4736 -4563 -4560 -4529 -4508 -4498 -4496 -4387 -4345
##  [61] -4327 -4294 -4261 -4214 -4181 -4145 -4142 -4130 -4130 -4089 -4085 -3988
##  [73] -3976 -3973 -3969 -3916 -3905 -3791 -3779 -3769 -3764 -3732 -3692 -3669
##  [85] -3646 -3614 -3610 -3579 -3533 -3516 -3498 -3430 -3413 -3412 -3403 -3360
##  [97] -3329 -3314 -3280 -3229 -3156 -3126 -3122 -3089 -3058 -3056 -3045 -2972
## [109] -2942 -2932 -2929 -2861 -2854 -2799 -2756 -2754 -2748 -2738 -2723 -2638
## [121] -2607 -2602 -2569 -2497 -2489 -2487 -2480 -2479 -2468 -2405 -2381 -2376
## [133] -2372 -2311 -2285 -2185 -2172 -2121 -2117 -2102 -2072 -1967 -1945 -1928
## [145] -1840 -1815 -1791 -1770 -1656 -1618 -1594 -1474 -1320 -1290 -1284 -1136
## [157] -1123 -1094 -1080 -1061 -1060  -980  -939  -918  -764  -723  -714  -614
## [169]  -589  -577  -567  -560  -461  -460  -459  -449  -363  -357  -283  -263
## [181]  -211  -203   -99   -87   -83    -6   188   273   279   372   401   744
## [193]   763   797   830   925   948   958   958   970  1048  1165  1287  1305
## [205]  1320  1336  1432  1560  1608  1736  1820  1922  2079  2098  2207  2263
## [217]  2344  2377  2391  2569  2635  2753  2763  2839  2939  2967  2979  3067
## [229]  3125  3155  3183  3195  3196  3324  3329  3429  3561  3626  3686  3810
## [241]  4045  4182  4386  4486  4569  4602  4743  5204  5380  5851  6035  6407
## [253]  6611  6711  6968</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="双样本位置参数.html#cb149-1" aria-hidden="true" tabindex="-1"></a>(<span class="at">Wa=</span><span class="fu">qwilcox</span>(<span class="fl">0.025</span>,<span class="dv">17</span>,<span class="dv">15</span>))</span></code></pre></div>
<pre><code>## [1] 76</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="双样本位置参数.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(D[Wa],D[<span class="dv">17</span><span class="sc">*</span><span class="dv">15</span><span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>Wa])</span></code></pre></div>
<pre><code>## [1] -3916  -263</code></pre>
</div>
</div>
<div id="正态记分normal-score检验" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 3.3 正态记分（normal score）检验<a href="双样本位置参数.html#正态记分normal-score检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>用正态记分代替秩</li>
</ul>
<div id="例子salary" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> 例子：salary<a href="双样本位置参数.html#例子salary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="双样本位置参数.html#cb153-1" aria-hidden="true" tabindex="-1"></a>w<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">c</span>(salary1,salary2),<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">17</span>),<span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">15</span>)));w<span class="ot">=</span>w[<span class="fu">order</span>(w[,<span class="dv">1</span>]),]</span>
<span id="cb153-2"><a href="双样本位置参数.html#cb153-2" aria-hidden="true" tabindex="-1"></a>w<span class="ot">=</span><span class="fu">cbind</span>(w,<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>,<span class="fu">qnorm</span>((<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>)<span class="sc">/</span>(<span class="dv">17</span><span class="sc">+</span><span class="dv">15</span><span class="sc">+</span><span class="dv">1</span>)))</span>
<span id="cb153-3"><a href="双样本位置参数.html#cb153-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">17</span>;n<span class="ot">=</span><span class="dv">15</span>;</span>
<span id="cb153-4"><a href="双样本位置参数.html#cb153-4" aria-hidden="true" tabindex="-1"></a>Tstat <span class="ot">=</span> <span class="fu">sum</span>(w[w[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="dv">4</span>])</span>
<span id="cb153-5"><a href="双样本位置参数.html#cb153-5" aria-hidden="true" tabindex="-1"></a>w2 <span class="ot">=</span> <span class="fu">sum</span>(w[,<span class="dv">4</span>]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb153-6"><a href="双样本位置参数.html#cb153-6" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">sqrt</span>(m<span class="sc">*</span>n<span class="sc">*</span>w2<span class="sc">/</span>(m<span class="sc">+</span>n<span class="dv">-1</span>)<span class="sc">/</span>(m<span class="sc">+</span>n))</span>
<span id="cb153-7"><a href="双样本位置参数.html#cb153-7" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">=</span> Tstat<span class="sc">/</span>S</span>
<span id="cb153-8"><a href="双样本位置参数.html#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(Z)</span></code></pre></div>
<pre><code>## [1] 0.01925286</code></pre>
<p><strong>第二部分 不独立的两个总体</strong></p>
</div>
</div>
<div id="成对数据的检验" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> 3.4 成对数据的检验<a href="双样本位置参数.html#成对数据的检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>成对数据的差，使用符号检验、Wilcoxon符号秩检验</li>
</ul>
<div id="例子实施管理前后" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> 例子：实施管理前后<a href="双样本位置参数.html#例子实施管理前后" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="双样本位置参数.html#cb155-1" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.2</span>,<span class="sc">-</span><span class="fl">0.6</span>,<span class="sc">-</span><span class="fl">0.3</span>,<span class="fl">1.1</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.8</span>,<span class="fl">0.3</span>,<span class="sc">-</span><span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb155-2"><a href="双样本位置参数.html#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BSDA)</span></code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## 
## Attaching package: &#39;BSDA&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:datasets&#39;:
## 
##     Orange</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="双样本位置参数.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">SIGN.test</span>(x2,<span class="at">md=</span><span class="dv">0</span>,<span class="at">altervative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## 
##  One-sample Sign-Test
## 
## data:  x2
## s = 3, p-value = 0.3438
## alternative hypothesis: true median is not equal to 0
## 95 percent confidence interval:
##  -0.5026667  0.8404444
## sample estimates:
## median of x 
##        -0.2 
## 
## Achieved and Interpolated Confidence Intervals: 
## 
##                   Conf.Level  L.E.pt U.E.pt
## Lower Achieved CI     0.8906 -0.3000 0.3000
## Interpolated CI       0.9500 -0.5027 0.8404
## Upper Achieved CI     0.9785 -0.6000 1.1000</code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="双样本位置参数.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x2,<span class="at">md=</span><span class="dv">0</span>,<span class="at">altervative=</span><span class="st">&quot;two.sided&quot;</span>,<span class="at">conf.level=</span><span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## Warning in wilcox.test.default(x2, md = 0, altervative = &quot;two.sided&quot;, conf.level
## = 0.95): cannot compute exact p-value with ties</code></pre>
<pre><code>## 
##  Wilcoxon signed rank test with continuity correction
## 
## data:  x2
## V = 24.5, p-value = 0.7982
## alternative hypothesis: true location is not equal to 0</code></pre>
</div>
<div id="例子病人血压" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> 例子：病人血压<a href="双样本位置参数.html#例子病人血压" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="双样本位置参数.html#cb164-1" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/bp.txt&quot;</span>)</span>
<span id="cb164-2"><a href="双样本位置参数.html#cb164-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> bp<span class="sc">$</span>V1</span>
<span id="cb164-3"><a href="双样本位置参数.html#cb164-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> bp<span class="sc">$</span>V2</span>
<span id="cb164-4"><a href="双样本位置参数.html#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(x,y,<span class="at">paired =</span> T,<span class="at">alt=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  x and y
## V = 49, p-value = 0.01367
## alternative hypothesis: true location shift is greater than 0</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="双样本位置参数.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">psignrank</span>(<span class="fu">sum</span>(<span class="fu">rank</span>(x<span class="sc">-</span>y)[x<span class="sc">&lt;</span>y]),<span class="fu">length</span>(x))</span></code></pre></div>
<pre><code>## [1] 0.01367188</code></pre>
</div>
</div>
<div id="mcnemar检验" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> 3.5 McNemar检验<a href="双样本位置参数.html#mcnemar检验" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>配对的二元取值数据</li>
<li>二维列联表，卡方检验统计量</li>
<li>是Cochran’s Q检验的特例</li>
</ul>
<div id="精确检验-1" class="section level3 hasAnchor" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> 精确检验<a href="双样本位置参数.html#精确检验-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="双样本位置参数.html#cb168-1" aria-hidden="true" tabindex="-1"></a>Cochran<span class="ot">=</span><span class="cf">function</span>(x){</span>
<span id="cb168-2"><a href="双样本位置参数.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  Xpchs<span class="ot">=</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">7</span>,<span class="at">k=</span><span class="dv">5</span>){</span>
<span id="cb168-3"><a href="双样本位置参数.html#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#output(n_1,..,n_k)-all possible combination with n_1+...+n_k=n</span></span>
<span id="cb168-4"><a href="双样本位置参数.html#cb168-4" aria-hidden="true" tabindex="-1"></a>    temp<span class="ot">=</span><span class="fu">cbind</span>(n<span class="sc">:</span><span class="dv">0</span>,<span class="dv">0</span><span class="sc">:</span>n);</span>
<span id="cb168-5"><a href="双样本位置参数.html#cb168-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (k<span class="sc">&gt;=</span><span class="dv">3</span>){</span>
<span id="cb168-6"><a href="双样本位置参数.html#cb168-6" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>k){</span>
<span id="cb168-7"><a href="双样本位置参数.html#cb168-7" aria-hidden="true" tabindex="-1"></a>        a1<span class="ot">=</span>temp[,<span class="dv">1</span><span class="sc">:</span>(j<span class="dv">-2</span>)];a2<span class="ot">=</span>temp[,j<span class="dv">-1</span>];temp0<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb168-8"><a href="双样本位置参数.html#cb168-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(a2)){</span>
<span id="cb168-9"><a href="双样本位置参数.html#cb168-9" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (j<span class="sc">==</span><span class="dv">3</span>) temp0<span class="ot">=</span><span class="fu">rbind</span>(temp0,<span class="fu">cbind</span>(<span class="fu">rep</span>(a1[i],a2[i]<span class="sc">+</span><span class="dv">1</span>),a2[i]<span class="sc">:</span><span class="dv">0</span>,<span class="dv">0</span><span class="sc">:</span>a2[i]))</span>
<span id="cb168-10"><a href="双样本位置参数.html#cb168-10" aria-hidden="true" tabindex="-1"></a>          <span class="cf">if</span> (j<span class="sc">&gt;</span><span class="dv">3</span>)  temp0<span class="ot">=</span><span class="fu">rbind</span>(temp0,<span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(a1[i,],a2[i]<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb168-11"><a href="双样本位置参数.html#cb168-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol=</span>j<span class="dv">-2</span>,<span class="at">byrow=</span>T),a2[i]<span class="sc">:</span><span class="dv">0</span>,<span class="dv">0</span><span class="sc">:</span>a2[i]))</span>
<span id="cb168-12"><a href="双样本位置参数.html#cb168-12" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb168-13"><a href="双样本位置参数.html#cb168-13" aria-hidden="true" tabindex="-1"></a>        temp<span class="ot">=</span>temp0</span>
<span id="cb168-14"><a href="双样本位置参数.html#cb168-14" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb168-15"><a href="双样本位置参数.html#cb168-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb168-16"><a href="双样本位置参数.html#cb168-16" aria-hidden="true" tabindex="-1"></a>  temp</span>
<span id="cb168-17"><a href="双样本位置参数.html#cb168-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb168-18"><a href="双样本位置参数.html#cb168-18" aria-hidden="true" tabindex="-1"></a>  Xpchs2<span class="ot">=</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">4</span>,<span class="at">k=</span><span class="dv">2</span>){</span>
<span id="cb168-19"><a href="双样本位置参数.html#cb168-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#output: all 0 and 1 columns, with n-k 0s and k- 1s columns</span></span>
<span id="cb168-20"><a href="双样本位置参数.html#cb168-20" aria-hidden="true" tabindex="-1"></a>    Xchoose<span class="ot">=</span><span class="cf">function</span>(<span class="at">n=</span><span class="dv">4</span>,<span class="at">k=</span><span class="dv">2</span>){</span>
<span id="cb168-21"><a href="双样本位置参数.html#cb168-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (k<span class="sc">==</span><span class="dv">0</span>) aa<span class="ot">=</span><span class="cn">NULL</span></span>
<span id="cb168-22"><a href="双样本位置参数.html#cb168-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (k<span class="sc">&gt;=</span><span class="dv">1</span>){</span>
<span id="cb168-23"><a href="双样本位置参数.html#cb168-23" aria-hidden="true" tabindex="-1"></a>        aa<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span>n,<span class="at">ncol=</span><span class="dv">1</span>);m<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb168-24"><a href="双样本位置参数.html#cb168-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(k<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb168-25"><a href="双样本位置参数.html#cb168-25" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>k){</span>
<span id="cb168-26"><a href="双样本位置参数.html#cb168-26" aria-hidden="true" tabindex="-1"></a>            m<span class="ot">=</span>m<span class="sc">+</span><span class="dv">1</span>;m1<span class="ot">=</span><span class="fu">nrow</span>(aa);</span>
<span id="cb168-27"><a href="双样本位置参数.html#cb168-27" aria-hidden="true" tabindex="-1"></a>            aa<span class="ot">=</span><span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="fu">rep</span>(aa,<span class="at">each=</span>n),<span class="at">ncol=</span>m),<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n,m1))</span>
<span id="cb168-28"><a href="双样本位置参数.html#cb168-28" aria-hidden="true" tabindex="-1"></a>            aa<span class="ot">=</span>aa[(aa[,m<span class="sc">+</span><span class="dv">1</span>]<span class="sc">&gt;</span>aa[,m]),]</span>
<span id="cb168-29"><a href="双样本位置参数.html#cb168-29" aria-hidden="true" tabindex="-1"></a>          }</span>
<span id="cb168-30"><a href="双样本位置参数.html#cb168-30" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb168-31"><a href="双样本位置参数.html#cb168-31" aria-hidden="true" tabindex="-1"></a>      };</span>
<span id="cb168-32"><a href="双样本位置参数.html#cb168-32" aria-hidden="true" tabindex="-1"></a>      aa</span>
<span id="cb168-33"><a href="双样本位置参数.html#cb168-33" aria-hidden="true" tabindex="-1"></a>    };</span>
<span id="cb168-34"><a href="双样本位置参数.html#cb168-34" aria-hidden="true" tabindex="-1"></a>    e01<span class="ot">=</span><span class="fu">Xchoose</span>(n,k)</span>
<span id="cb168-35"><a href="双样本位置参数.html#cb168-35" aria-hidden="true" tabindex="-1"></a>    temp<span class="ot">=</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="fu">nrow</span>(e01),<span class="at">ncol=</span>n);</span>
<span id="cb168-36"><a href="双样本位置参数.html#cb168-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(temp)){</span>
<span id="cb168-37"><a href="双样本位置参数.html#cb168-37" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (k<span class="sc">==</span><span class="dv">1</span>) temp[j,e01[j]]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb168-38"><a href="双样本位置参数.html#cb168-38" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (k<span class="sc">&gt;</span><span class="dv">1</span>) temp[j,e01[j,]]<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb168-39"><a href="双样本位置参数.html#cb168-39" aria-hidden="true" tabindex="-1"></a>      };</span>
<span id="cb168-40"><a href="双样本位置参数.html#cb168-40" aria-hidden="true" tabindex="-1"></a>      temp</span>
<span id="cb168-41"><a href="双样本位置参数.html#cb168-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb168-42"><a href="双样本位置参数.html#cb168-42" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">=</span><span class="fu">nrow</span>(x);k<span class="ot">=</span><span class="fu">ncol</span>(x);</span>
<span id="cb168-43"><a href="双样本位置参数.html#cb168-43" aria-hidden="true" tabindex="-1"></a>  L<span class="ot">=</span><span class="fu">apply</span>(x,<span class="dv">1</span>,sum);R<span class="ot">=</span><span class="fu">apply</span>(x,<span class="dv">2</span>,sum);N<span class="ot">=</span><span class="fu">sum</span>(R);</span>
<span id="cb168-44"><a href="双样本位置参数.html#cb168-44" aria-hidden="true" tabindex="-1"></a>  Q0<span class="ot">=</span>(k<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sum</span>((R<span class="sc">-</span><span class="fu">mean</span>(R))<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(k<span class="sc">*</span>N<span class="sc">-</span><span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">2</span>));</span>
<span id="cb168-45"><a href="双样本位置参数.html#cb168-45" aria-hidden="true" tabindex="-1"></a>  Ni<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb168-46"><a href="双样本位置参数.html#cb168-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k<span class="dv">-1</span>) Ni<span class="ot">=</span><span class="fu">c</span>(Ni,<span class="fu">sum</span>(L<span class="sc">==</span>i));</span>
<span id="cb168-47"><a href="双样本位置参数.html#cb168-47" aria-hidden="true" tabindex="-1"></a>  Ni<span class="ot">=</span>Ni[<span class="sc">-</span><span class="dv">1</span>];</span>
<span id="cb168-48"><a href="双样本位置参数.html#cb168-48" aria-hidden="true" tabindex="-1"></a>  eye0<span class="ot">=</span><span class="fu">Xpchs2</span>(k,<span class="dv">1</span>);temp0<span class="ot">=</span><span class="fu">Xpchs</span>(Ni[<span class="dv">1</span>],<span class="fu">nrow</span>(eye0));Ri0<span class="ot">=</span>temp0<span class="sc">%*%</span>eye0;</span>
<span id="cb168-49"><a href="双样本位置参数.html#cb168-49" aria-hidden="true" tabindex="-1"></a>  prob0<span class="ot">=</span><span class="fu">factorial</span>(Ni[<span class="dv">1</span>])<span class="sc">/</span><span class="fu">apply</span>(<span class="fu">factorial</span>(temp0),<span class="dv">1</span>,prod)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">nrow</span>(eye0))<span class="sc">^</span>(Ni[<span class="dv">1</span>]);</span>
<span id="cb168-50"><a href="双样本位置参数.html#cb168-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(Ni)<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb168-51"><a href="双样本位置参数.html#cb168-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(Ni)){</span>
<span id="cb168-52"><a href="双样本位置参数.html#cb168-52" aria-hidden="true" tabindex="-1"></a>      eye1<span class="ot">=</span><span class="fu">Xpchs2</span>(k,i);</span>
<span id="cb168-53"><a href="双样本位置参数.html#cb168-53" aria-hidden="true" tabindex="-1"></a>      temp1<span class="ot">=</span><span class="fu">Xpchs</span>(Ni[i],<span class="fu">nrow</span>(eye1));</span>
<span id="cb168-54"><a href="双样本位置参数.html#cb168-54" aria-hidden="true" tabindex="-1"></a>      Ri1<span class="ot">=</span>temp1<span class="sc">%*%</span>eye1;</span>
<span id="cb168-55"><a href="双样本位置参数.html#cb168-55" aria-hidden="true" tabindex="-1"></a>      prob1<span class="ot">=</span><span class="fu">factorial</span>(Ni[i])<span class="sc">/</span><span class="fu">apply</span>(<span class="fu">factorial</span>(temp1),<span class="dv">1</span>,prod)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">nrow</span>(eye1))<span class="sc">^</span>(Ni[i])</span>
<span id="cb168-56"><a href="双样本位置参数.html#cb168-56" aria-hidden="true" tabindex="-1"></a>      Ri0<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">t</span>(Ri0),<span class="fu">nrow</span>(Ri1)),<span class="at">byrow=</span>T,<span class="at">ncol=</span>k)<span class="sc">+</span></span>
<span id="cb168-57"><a href="双样本位置参数.html#cb168-57" aria-hidden="true" tabindex="-1"></a>          <span class="fu">matrix</span>(<span class="fu">rep</span>(Ri1,<span class="at">each=</span><span class="fu">nrow</span>(Ri0)),<span class="at">ncol=</span>k)</span>
<span id="cb168-58"><a href="双样本位置参数.html#cb168-58" aria-hidden="true" tabindex="-1"></a>      prob0<span class="ot">=</span><span class="fu">rep</span>(prob0,<span class="fu">length</span>(prob1))<span class="sc">*</span><span class="fu">rep</span>(prob1,<span class="at">each=</span><span class="fu">length</span>(prob0))</span>
<span id="cb168-59"><a href="双样本位置参数.html#cb168-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb168-60"><a href="双样本位置参数.html#cb168-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb168-61"><a href="双样本位置参数.html#cb168-61" aria-hidden="true" tabindex="-1"></a>  xa<span class="ot">=</span>k<span class="sc">*</span>(k<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">apply</span>((Ri0<span class="sc">-</span><span class="fu">apply</span>(Ri0,<span class="dv">1</span>,mean))<span class="sc">^</span><span class="dv">2</span>,<span class="dv">1</span>,sum)<span class="sc">/</span>(k<span class="sc">*</span>N<span class="sc">-</span><span class="fu">sum</span>(L<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb168-62"><a href="双样本位置参数.html#cb168-62" aria-hidden="true" tabindex="-1"></a>  nn<span class="ot">=</span><span class="fu">length</span>(xa);xa0<span class="ot">=</span><span class="fu">sort</span>(<span class="fu">unique</span>(xa));xacnt<span class="ot">=</span><span class="cn">NULL</span>;</span>
<span id="cb168-63"><a href="双样本位置参数.html#cb168-63" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xa0)) xacnt<span class="ot">=</span><span class="fu">c</span>(xacnt,<span class="fu">length</span>(xa[xa<span class="sc">==</span>xa0[i]]));</span>
<span id="cb168-64"><a href="双样本位置参数.html#cb168-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(xa0,xacnt<span class="sc">/</span>nn,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">ylab=</span><span class="st">&quot;density function&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;value of Cochran statistics&quot;</span>);</span>
<span id="cb168-65"><a href="双样本位置参数.html#cb168-65" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(xa0)){</span>
<span id="cb168-66"><a href="双样本位置参数.html#cb168-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(<span class="fu">c</span>(xa0[i],xa0[i]),<span class="fu">c</span>(xacnt[i]<span class="sc">/</span>nn,<span class="dv">0</span>),<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb168-67"><a href="双样本位置参数.html#cb168-67" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb168-68"><a href="双样本位置参数.html#cb168-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">unique</span>(xa),<span class="fu">cbind</span>(<span class="fu">rbind</span>(<span class="fu">t</span>(x),L),<span class="fu">c</span>(R,N)),<span class="at">Q=</span>Q0,</span>
<span id="cb168-69"><a href="双样本位置参数.html#cb168-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">Exactp=</span><span class="fu">sum</span>(prob0[(xa<span class="sc">&gt;=</span>Q0)]),<span class="at">pvalue=</span><span class="fu">pchisq</span>(Q0,k<span class="dv">-1</span>,<span class="at">low=</span>F))</span>
<span id="cb168-70"><a href="双样本位置参数.html#cb168-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb168-71"><a href="双样本位置参数.html#cb168-71" aria-hidden="true" tabindex="-1"></a>treat<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/athletefootp.txt&quot;</span>);</span>
<span id="cb168-72"><a href="双样本位置参数.html#cb168-72" aria-hidden="true" tabindex="-1"></a><span class="fu">Cochran</span>(treat[,<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<p><img src="03_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre><code>## [[1]]
##  [1] 24.0000000 20.1666667 16.6666667 13.5000000 10.6666667  8.1666667
##  [7]  6.0000000  4.1666667  2.6666667  1.5000000  0.6666667  0.1666667
## [13]  0.0000000
## 
## [[2]]
##    [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14]
## V2    1    1    1    1    1    1    1    1    1     1     0     0     0     0
## V3    1    1    1    1    1    1    0    0    0     0     1     1     1     1
## L     2    2    2    2    2    2    1    1    1     1     1     1     1     1
##    [,15] [,16] [,17] [,18] [,19] [,20] [,21] [,22] [,23] [,24] [,25] [,26]
## V2     0     0     0     0     0     0     0     0     0     0     0     0
## V3     1     1     1     1     1     1     1     1     1     1     1     1
## L      1     1     1     1     1     1     1     1     1     1     1     1
##    [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37] [,38]
## V2     0     0     0     0     0     0     0     0     0     0     0     0
## V3     1     1     1     1     0     0     0     0     0     0     0     0
## L      1     1     1     1     0     0     0     0     0     0     0     0
##    [,39] [,40] [,41]
## V2     0     0    10
## V3     0     0    26
## L      0     0    36
## 
## $Q
## [1] 10.66667
## 
## $Exactp
## [1] 0.00154388
## 
## $pvalue
## [1] 0.001090835</code></pre>
</div>
<div id="大样本近似-1" class="section level3 hasAnchor" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> 大样本近似<a href="双样本位置参数.html#大样本近似-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="双样本位置参数.html#cb170-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/athletefootp.txt&quot;</span>);</span>
<span id="cb170-2"><a href="双样本位置参数.html#cb170-2" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span>x[,<span class="sc">-</span><span class="dv">1</span>];</span>
<span id="cb170-3"><a href="双样本位置参数.html#cb170-3" aria-hidden="true" tabindex="-1"></a>n12<span class="ot">=</span><span class="fu">sum</span>(x[((x[,<span class="dv">1</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">&amp;</span>(x[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">1</span>)),])</span>
<span id="cb170-4"><a href="双样本位置参数.html#cb170-4" aria-hidden="true" tabindex="-1"></a>n21<span class="ot">=</span><span class="fu">sum</span>(x[((x[,<span class="dv">1</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">&amp;</span>(x[,<span class="dv">2</span>]<span class="sc">==</span><span class="dv">0</span>)),])</span>
<span id="cb170-5"><a href="双样本位置参数.html#cb170-5" aria-hidden="true" tabindex="-1"></a>McNemar<span class="ot">=</span>(n12<span class="sc">-</span>n21)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(n12<span class="sc">+</span>n21);</span>
<span id="cb170-6"><a href="双样本位置参数.html#cb170-6" aria-hidden="true" tabindex="-1"></a>pvalue<span class="ot">=</span><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(McNemar,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb170-7"><a href="双样本位置参数.html#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">McNemar=</span>McNemar,<span class="at">pvaluetwosided=</span>pvalue)</span></code></pre></div>
<pre><code>## $McNemar
## [1] 10.66667
## 
## $pvaluetwosided
## [1] 0.001090835</code></pre>
</div>
</div>
<div id="cohens-kappa系数" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> 3.6 Cohen’s Kappa系数<a href="双样本位置参数.html#cohens-kappa系数" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>度量两位评估者之间评估一致性的指标</li>
</ul>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="双样本位置参数.html#cb172-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;data/music.txt&quot;</span>);</span>
<span id="cb172-2"><a href="双样本位置参数.html#cb172-2" aria-hidden="true" tabindex="-1"></a>w<span class="ot">=</span><span class="fu">matrix</span>(x[,<span class="dv">3</span>],<span class="at">byrow=</span>T,<span class="at">ncol=</span><span class="dv">2</span>);</span>
<span id="cb172-3"><a href="双样本位置参数.html#cb172-3" aria-hidden="true" tabindex="-1"></a>I<span class="ot">=</span><span class="fu">nrow</span>(w);n<span class="ot">=</span><span class="fu">sum</span>(w);w<span class="ot">=</span>w<span class="sc">/</span>n;</span>
<span id="cb172-4"><a href="双样本位置参数.html#cb172-4" aria-hidden="true" tabindex="-1"></a>pa<span class="ot">=</span><span class="fu">sum</span>(<span class="fu">diag</span>(w));</span>
<span id="cb172-5"><a href="双样本位置参数.html#cb172-5" aria-hidden="true" tabindex="-1"></a>pe<span class="ot">=</span><span class="fu">sum</span>(<span class="fu">apply</span>(w,<span class="dv">1</span>,sum)<span class="sc">*</span><span class="fu">apply</span>(w,<span class="dv">2</span>,sum))</span>
<span id="cb172-6"><a href="双样本位置参数.html#cb172-6" aria-hidden="true" tabindex="-1"></a>(<span class="at">kap=</span>(pa<span class="sc">-</span>pe)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>pe))</span></code></pre></div>
<pre><code>## [1] 0.5098039</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="双样本位置参数.html#cb174-1" aria-hidden="true" tabindex="-1"></a>A<span class="ot">=</span><span class="fu">sum</span>(<span class="fu">diag</span>(w)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="fu">apply</span>(w,<span class="dv">1</span>,sum)<span class="sc">+</span><span class="fu">apply</span>(w,<span class="dv">2</span>,sum))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>kap))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb174-2"><a href="双样本位置参数.html#cb174-2" aria-hidden="true" tabindex="-1"></a>tempB<span class="ot">=</span><span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(w,<span class="dv">1</span>,sum),I)<span class="sc">+</span><span class="fu">rep</span>(<span class="fu">apply</span>(w,<span class="dv">2</span>,sum),<span class="at">each=</span>I),<span class="at">byrow=</span>T,<span class="at">ncol=</span>I)</span>
<span id="cb174-3"><a href="双样本位置参数.html#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(tempB)<span class="ot">=</span><span class="dv">0</span>;</span>
<span id="cb174-4"><a href="双样本位置参数.html#cb174-4" aria-hidden="true" tabindex="-1"></a>B<span class="ot">=</span>(<span class="dv">1</span><span class="sc">-</span>kap)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sum</span>(w<span class="sc">*</span>tempB<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb174-5"><a href="双样本位置参数.html#cb174-5" aria-hidden="true" tabindex="-1"></a>CC<span class="ot">=</span>(kap<span class="sc">-</span>pe<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>kap))<span class="sc">^</span><span class="dv">2</span>;</span>
<span id="cb174-6"><a href="双样本位置参数.html#cb174-6" aria-hidden="true" tabindex="-1"></a>ASE<span class="ot">=</span><span class="fu">sqrt</span>((A<span class="sc">+</span>B<span class="sc">-</span>CC)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>pe)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>n)</span>
<span id="cb174-7"><a href="双样本位置参数.html#cb174-7" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">kappa=</span>kap,<span class="at">ASE=</span>ASE,<span class="at">CI=</span><span class="fu">c</span>(kap<span class="fl">-1.96</span><span class="sc">*</span>ASE,kap<span class="fl">+1.96</span><span class="sc">*</span>ASE))</span></code></pre></div>
<pre><code>## $kappa
## [1] 0.5098039
## 
## $ASE
## [1] 0.08133101
## 
## $CI
## [1] 0.3503951 0.6692127</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="单样本位置参数.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="多样本位置参数.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-template.pdf", "bookdown-template.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
